[
    {
        "user": "U4H19D1D2",
        "type": "message",
        "ts": "1694781853.808759",
        "edited": {
            "user": "U4H19D1D2",
            "ts": "1694781898.000000"
        },
        "client_msg_id": "c1d7793c-db38-4ffb-9768-c8927493158f",
        "text": "Has anyone looked at optimising the `buffer_size` when reading off the stream?\n\nFor context bflw defaults to <https:\/\/github.com\/betcode-org\/betfair\/blob\/0aadd60ab2c2dcebeedfbc8b661bd257aec46435\/betfairlightweight\/endpoints\/streaming.py#L27|1024> (no idea why I chose this) but it seems this could probably be optimised by increasing it however unsure how\/when things would start to deteriorate? We don't do anything with the data till we receive the `\\r\\n` so I would have thought just bumping it would make things faster :thinking_face:\n\nAlso looking at using `socket.makefile` in this <https:\/\/github.com\/betcode-org\/betfair\/pull\/540|PR>",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "137c5a3ef323",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-03-15\/6819395173841_137c5a3ef323f1944a1a_72.png",
            "first_name": "liam",
            "real_name": "liam",
            "display_name": "liam",
            "team": "T4G9NBD2M",
            "name": "liam",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1694781853.808759",
        "reply_count": 28,
        "reply_users_count": 5,
        "latest_reply": "1696685391.845399",
        "reply_users": [
            "U01DCR5PXDY",
            "U4H19D1D2",
            "U02RN7YDRQ9",
            "U05PD1LRGGH",
            "U02K5EBKNBF"
        ],
        "replies": [
            {
                "user": "U01DCR5PXDY",
                "ts": "1694782479.471279"
            },
            {
                "user": "U4H19D1D2",
                "ts": "1694782525.419899"
            },
            {
                "user": "U01DCR5PXDY",
                "ts": "1694782556.765539"
            },
            {
                "user": "U4H19D1D2",
                "ts": "1694782790.717419"
            },
            {
                "user": "U02RN7YDRQ9",
                "ts": "1694783020.818299"
            },
            {
                "user": "U4H19D1D2",
                "ts": "1694783413.840629"
            },
            {
                "user": "U01DCR5PXDY",
                "ts": "1694783543.937839"
            },
            {
                "user": "U4H19D1D2",
                "ts": "1694783919.165239"
            },
            {
                "user": "U01DCR5PXDY",
                "ts": "1694784582.835499"
            },
            {
                "user": "U02RN7YDRQ9",
                "ts": "1694784978.260719"
            },
            {
                "user": "U02RN7YDRQ9",
                "ts": "1694785114.760019"
            },
            {
                "user": "U4H19D1D2",
                "ts": "1694790591.944979"
            },
            {
                "user": "U02RN7YDRQ9",
                "ts": "1694797154.827999"
            },
            {
                "user": "U02RN7YDRQ9",
                "ts": "1694807707.307009"
            },
            {
                "user": "U4H19D1D2",
                "ts": "1694807874.054499"
            },
            {
                "user": "U05PD1LRGGH",
                "ts": "1694808124.926059"
            },
            {
                "user": "U05PD1LRGGH",
                "ts": "1694808154.064639"
            },
            {
                "user": "U05PD1LRGGH",
                "ts": "1694808366.754689"
            },
            {
                "user": "U02RN7YDRQ9",
                "ts": "1694810637.180029"
            },
            {
                "user": "U05PD1LRGGH",
                "ts": "1694813557.165669"
            },
            {
                "user": "U05PD1LRGGH",
                "ts": "1694813608.722299"
            },
            {
                "user": "U05PD1LRGGH",
                "ts": "1694892344.465269"
            },
            {
                "user": "U02K5EBKNBF",
                "ts": "1695146844.182009"
            },
            {
                "user": "U4H19D1D2",
                "ts": "1695149244.697369"
            },
            {
                "user": "U4H19D1D2",
                "ts": "1695150034.225879"
            },
            {
                "user": "U02K5EBKNBF",
                "ts": "1695150401.233379"
            },
            {
                "user": "U02K5EBKNBF",
                "ts": "1696683874.879409"
            },
            {
                "user": "U4H19D1D2",
                "ts": "1696685391.845399"
            }
        ],
        "is_locked": false,
        "subscribed": true,
        "last_read": "1696685391.845399",
        "attachments": [
            {
                "id": 1,
                "footer_icon": "https:\/\/slack.github.com\/static\/img\/favicon-neutral.png",
                "color": "24292f",
                "bot_id": "B021ZJYSBMW",
                "app_unfurl_url": "https:\/\/github.com\/betcode-org\/betfair\/blob\/0aadd60ab2c2dcebeedfbc8b661bd257aec46435\/betfairlightweight\/endpoints\/streaming.py#L27",
                "is_app_unfurl": true,
                "app_id": "A01BP7R4KNY",
                "fallback": "<https:\/\/github.com\/betcode-org\/betfair\/blob\/0aadd60ab2c2dcebeedfbc8b661bd257aec46435\/betfairlightweight\/endpoints\/streaming.py | streaming.py>",
                "title": "<https:\/\/github.com\/betcode-org\/betfair\/blob\/0aadd60ab2c2dcebeedfbc8b661bd257aec46435\/betfairlightweight\/endpoints\/streaming.py | streaming.py>",
                "footer": "<https:\/\/github.com\/betcode-org\/betfair|betcode-org\/betfair>",
                "mrkdwn_in": [
                    "text"
                ]
            },
            {
                "id": 2,
                "footer_icon": "https:\/\/slack.github.com\/static\/img\/favicon-neutral.png",
                "ts": 1694725932,
                "color": "36a64f",
                "bot_id": "B021ZJYSBMW",
                "app_unfurl_url": "https:\/\/github.com\/betcode-org\/betfair\/pull\/540",
                "is_app_unfurl": true,
                "app_id": "A01BP7R4KNY",
                "fallback": "#540 Fix socket performance regression on Linux and OSX",
                "title": "#540 Fix socket performance regression on Linux and OSX",
                "title_link": "https:\/\/github.com\/betcode-org\/betfair\/pull\/540",
                "footer": "<https:\/\/github.com\/betcode-org\/betfair|betcode-org\/betfair>",
                "mrkdwn_in": [
                    "text"
                ]
            }
        ],
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "NAjf",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Has anyone looked at optimising the "
                            },
                            {
                                "type": "text",
                                "text": "buffer_size",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " when reading off the stream?\n\nFor context bflw defaults to "
                            },
                            {
                                "type": "link",
                                "url": "https:\/\/github.com\/betcode-org\/betfair\/blob\/0aadd60ab2c2dcebeedfbc8b661bd257aec46435\/betfairlightweight\/endpoints\/streaming.py#L27",
                                "text": "1024"
                            },
                            {
                                "type": "text",
                                "text": " (no idea why I chose this) but it seems this could probably be optimised by increasing it however unsure how\/when things would start to deteriorate? We don't do anything with the data till we receive the "
                            },
                            {
                                "type": "text",
                                "text": "\\r\\n",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " so I would have thought just bumping it would make things faster "
                            },
                            {
                                "type": "emoji",
                                "name": "thinking_face",
                                "unicode": "1f914"
                            },
                            {
                                "type": "text",
                                "text": "\n\nAlso looking at using "
                            },
                            {
                                "type": "text",
                                "text": "socket.makefile",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " in this "
                            },
                            {
                                "type": "link",
                                "url": "https:\/\/github.com\/betcode-org\/betfair\/pull\/540",
                                "text": "PR"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U01DCR5PXDY",
        "type": "message",
        "ts": "1694782479.471279",
        "client_msg_id": "9c62291d-c498-4f86-916a-e890280bc13b",
        "text": "Using a different code base, but I've found a larger buffer size to be particularly helpful on startup when a lot of data needs to be pulled to get the most recent snapshot of all market data before streaming can begin. I use 2MB.",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "903bc20cd9db",
            "image_72": "https:\/\/avatars.slack-edge.com\/2020-10-26\/1448127317798_903bc20cd9dba9a758e0_72.png",
            "first_name": "thambie1",
            "real_name": "thambie1",
            "display_name": "thambie1",
            "team": "T4G9NBD2M",
            "name": "thambie1",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1694781853.808759",
        "parent_user_id": "U4H19D1D2",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "KJD",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Using a different code base, but I've found a larger buffer size to be particularly helpful on startup when a lot of data needs to be pulled to get the most recent snapshot of all market data before streaming can begin. I use 2MB."
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U4H19D1D2",
        "type": "message",
        "ts": "1694782525.419899",
        "client_msg_id": "a34f959f-7970-4bfa-808f-17feb27af45a",
        "text": "Interesting, do you then reduce or keep it at 2?",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "137c5a3ef323",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-03-15\/6819395173841_137c5a3ef323f1944a1a_72.png",
            "first_name": "liam",
            "real_name": "liam",
            "display_name": "liam",
            "team": "T4G9NBD2M",
            "name": "liam",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1694781853.808759",
        "parent_user_id": "U4H19D1D2",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "4MPUe",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Interesting, do you then reduce or keep it at 2?"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U01DCR5PXDY",
        "type": "message",
        "ts": "1694782556.765539",
        "client_msg_id": "233fc47c-cf21-4189-92d1-d2ab2ed5201d",
        "text": "I see no benefit to reducing it.",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "903bc20cd9db",
            "image_72": "https:\/\/avatars.slack-edge.com\/2020-10-26\/1448127317798_903bc20cd9dba9a758e0_72.png",
            "first_name": "thambie1",
            "real_name": "thambie1",
            "display_name": "thambie1",
            "team": "T4G9NBD2M",
            "name": "thambie1",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1694781853.808759",
        "parent_user_id": "U4H19D1D2",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "5J\/KX",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "I see no benefit to reducing it."
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U4H19D1D2",
        "type": "message",
        "ts": "1694782790.717419",
        "client_msg_id": "16bc52e7-cf7f-4c54-bbd6-c003baaff511",
        "text": "Nice, I am seeing ~1.4x improvement when testing locally by just increasing the buffer to similar",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "137c5a3ef323",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-03-15\/6819395173841_137c5a3ef323f1944a1a_72.png",
            "first_name": "liam",
            "real_name": "liam",
            "display_name": "liam",
            "team": "T4G9NBD2M",
            "name": "liam",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1694781853.808759",
        "parent_user_id": "U4H19D1D2",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "+kB",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Nice, I am seeing ~1.4x improvement when testing locally by just increasing the buffer to similar"
                            }
                        ]
                    }
                ]
            }
        ],
        "reactions": [
            {
                "name": "+1",
                "users": [
                    "U01DCR5PXDY"
                ],
                "count": 1
            }
        ]
    },
    {
        "user": "U02RN7YDRQ9",
        "type": "message",
        "ts": "1694783020.818299",
        "client_msg_id": "770d5cdb-554e-4c5a-af10-7ac04d94b4b9",
        "text": "So much memory on systems these days I'd explore keep increasing the size until you see no further improvement ?",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "ge46f1f8b708",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/e46f1f8b708a630e3191de7b2c42b1d1.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0023-72.png",
            "first_name": "edblock",
            "real_name": "edblock",
            "display_name": "foxwood",
            "team": "T4G9NBD2M",
            "name": "eanb",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1694781853.808759",
        "parent_user_id": "U4H19D1D2",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "ZTh",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "So much memory on systems these days I'd explore keep increasing the size until you see no further improvement ?"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U4H19D1D2",
        "type": "message",
        "ts": "1694783413.840629",
        "client_msg_id": "cafa15ef-d912-4b5b-b25d-b0165ba117b9",
        "text": "Yeah that seems to be the way to go, just needs to be optimised for 'normal' use I guess",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "137c5a3ef323",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-03-15\/6819395173841_137c5a3ef323f1944a1a_72.png",
            "first_name": "liam",
            "real_name": "liam",
            "display_name": "liam",
            "team": "T4G9NBD2M",
            "name": "liam",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1694781853.808759",
        "parent_user_id": "U4H19D1D2",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "MPW1",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Yeah that seems to be the way to go, just needs to be optimised for 'normal' use I guess"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U01DCR5PXDY",
        "type": "message",
        "ts": "1694783543.937839",
        "client_msg_id": "80930c8a-d803-40fc-b8cf-4b1738d9f396",
        "text": "Oh another benefit, it can reduce conflation issues",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "903bc20cd9db",
            "image_72": "https:\/\/avatars.slack-edge.com\/2020-10-26\/1448127317798_903bc20cd9dba9a758e0_72.png",
            "first_name": "thambie1",
            "real_name": "thambie1",
            "display_name": "thambie1",
            "team": "T4G9NBD2M",
            "name": "thambie1",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1694781853.808759",
        "parent_user_id": "U4H19D1D2",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "uE==",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Oh another benefit, it can reduce conflation issues"
                            }
                        ]
                    }
                ]
            }
        ],
        "reactions": [
            {
                "name": "+1",
                "users": [
                    "U4H19D1D2"
                ],
                "count": 1
            }
        ]
    },
    {
        "user": "U4H19D1D2",
        "type": "message",
        "ts": "1694783919.165239",
        "client_msg_id": "276b44a4-af5f-43e0-8676-aeb692b7f810",
        "text": "<@U05PD1LRGGH> has a good point here in regards to waiting for the last two chars, thoughts?\n\n```Increasing the buffer size will make it more likely that there's\nless-than-one-full-buffers worth of data to read and increase the chance\nthat the last two characters read will be CRLF.\n\nMy gut feeling is that in all likelihood during real world usage the\noriginal code will be faster on average as long as the buffer is set\nappropriately, as on a low latency connection I believe a single message\nwill be read in totality much more often than not.\n\nIt will have the chance of spikes of latency for individual messages if\nthey ever get stuck in the buffer as described, but again my suspicion is\nthat this would actually be rare.\n\nI think you should not merge this and revert the other commit.```",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "137c5a3ef323",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-03-15\/6819395173841_137c5a3ef323f1944a1a_72.png",
            "first_name": "liam",
            "real_name": "liam",
            "display_name": "liam",
            "team": "T4G9NBD2M",
            "name": "liam",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1694781853.808759",
        "parent_user_id": "U4H19D1D2",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "1Ky0",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "user",
                                "user_id": "U05PD1LRGGH"
                            },
                            {
                                "type": "text",
                                "text": " has a good point here in regards to waiting for the last two chars, thoughts?\n\n"
                            }
                        ]
                    },
                    {
                        "type": "rich_text_preformatted",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Increasing the buffer size will make it more likely that there's\nless-than-one-full-buffers worth of data to read and increase the chance\nthat the last two characters read will be CRLF.\n\nMy gut feeling is that in all likelihood during real world usage the\noriginal code will be faster on average as long as the buffer is set\nappropriately, as on a low latency connection I believe a single message\nwill be read in totality much more often than not.\n\nIt will have the chance of spikes of latency for individual messages if\nthey ever get stuck in the buffer as described, but again my suspicion is\nthat this would actually be rare.\n\nI think you should not merge this and revert the other commit."
                            }
                        ],
                        "border": 0
                    }
                ]
            }
        ]
    },
    {
        "user": "U01DCR5PXDY",
        "type": "message",
        "ts": "1694784582.835499",
        "client_msg_id": "43654e69-def8-4150-bc48-222031aa1824",
        "text": "They seem to be more knowledgeable about networking than me. I tried some experiments, found 2MB to work well for my system. Can't provide any detailed arguments beyond that",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "903bc20cd9db",
            "image_72": "https:\/\/avatars.slack-edge.com\/2020-10-26\/1448127317798_903bc20cd9dba9a758e0_72.png",
            "first_name": "thambie1",
            "real_name": "thambie1",
            "display_name": "thambie1",
            "team": "T4G9NBD2M",
            "name": "thambie1",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1694781853.808759",
        "parent_user_id": "U4H19D1D2",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "TlA6",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "They seem to be more knowledgeable about networking than me. I tried some experiments, found 2MB to work well for my system. Can't provide any detailed arguments beyond that"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U02RN7YDRQ9",
        "type": "message",
        "ts": "1694784978.260719",
        "client_msg_id": "ee0ae595-52f0-4e9b-be2f-0082eba06f5c",
        "text": "Confused - I thought you were looking at increasing the buffer size ? His first para says increasing is a good thing as I read it in that the whole line will have more chance of being read in. If you revert aren't you going back to the smaller size ? Bigger the buffer the better experience - more chance of getting everything in even if loads of (cheap) wasted memory space at the end of the data.",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "ge46f1f8b708",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/e46f1f8b708a630e3191de7b2c42b1d1.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0023-72.png",
            "first_name": "edblock",
            "real_name": "edblock",
            "display_name": "foxwood",
            "team": "T4G9NBD2M",
            "name": "eanb",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1694781853.808759",
        "parent_user_id": "U4H19D1D2",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "Mo8oi",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Confused - I thought you were looking at increasing the buffer size ? His first para says increasing is a good thing as I read it in that the whole line will have more chance of being read in. If you revert aren't you going back to the smaller size ? Bigger the buffer the better experience - more chance of getting everything in even if loads of (cheap) wasted memory space at the end of the data."
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U02RN7YDRQ9",
        "type": "message",
        "ts": "1694785114.760019",
        "client_msg_id": "6d5abfe8-981d-4c05-b8f8-2e5dddc81efb",
        "text": "Never looked at the low level feeds in flumine but presume the socket handling \/ buffering lives in it's own thread world and will manage things with multiple buffers etc as needed ?",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "ge46f1f8b708",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/e46f1f8b708a630e3191de7b2c42b1d1.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0023-72.png",
            "first_name": "edblock",
            "real_name": "edblock",
            "display_name": "foxwood",
            "team": "T4G9NBD2M",
            "name": "eanb",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1694781853.808759",
        "parent_user_id": "U4H19D1D2",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "NYT",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Never looked at the low level feeds in flumine but presume the socket handling \/ buffering lives in it's own thread world and will manage things with multiple buffers etc as needed ?"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U4H19D1D2",
        "type": "message",
        "ts": "1694790591.944979",
        "client_msg_id": "29fdf6e1-59bf-42cc-8a24-ba7e1d2ea8ca",
        "text": "bflw handles it all, my understanding is that the concern that the large buffer has the potential for lots of messages in a single `recv`\n\nBecause we check the end of the message for the line feed we could be left processing without sending the message out.",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "137c5a3ef323",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-03-15\/6819395173841_137c5a3ef323f1944a1a_72.png",
            "first_name": "liam",
            "real_name": "liam",
            "display_name": "liam",
            "team": "T4G9NBD2M",
            "name": "liam",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1694781853.808759",
        "parent_user_id": "U4H19D1D2",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "OWa",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "bflw handles it all, my understanding is that the concern that the large buffer has the potential for lots of messages in a single "
                            },
                            {
                                "type": "text",
                                "text": "recv",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": "\n\nBecause we check the end of the message for the line feed we could be left processing without sending the message out."
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U02RN7YDRQ9",
        "type": "message",
        "ts": "1694797154.827999",
        "client_msg_id": "8a586d52-c95f-4726-a37d-777052107330",
        "text": "Piqued my interest now - another thing to look at :slightly_smiling_face:",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "ge46f1f8b708",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/e46f1f8b708a630e3191de7b2c42b1d1.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0023-72.png",
            "first_name": "edblock",
            "real_name": "edblock",
            "display_name": "foxwood",
            "team": "T4G9NBD2M",
            "name": "eanb",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1694781853.808759",
        "parent_user_id": "U4H19D1D2",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "L4fsm",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Piqued my interest now - another thing to look at "
                            },
                            {
                                "type": "emoji",
                                "name": "slightly_smiling_face",
                                "unicode": "1f642"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U02RN7YDRQ9",
        "type": "message",
        "ts": "1694807707.307009",
        "client_msg_id": "ef362e05-629a-4dbb-9d90-9bbed68fbced",
        "text": "Looking at a random recorded dogs file of ~1MB with ~5k lines 96% were less than 512 but only 6 selections of course - will vary by market type \/ sport. Maybe analyse lots of files and set optimum buffer size by `event_type_id` ? If you went for 4096 you'd get a message per buffer (for dogs anyway) which would be fastest poss.\n\nLooked at the parsing in `_receive_all()` and while it's quick and easy it's surprising that `makefile()` performs so badly on what should be it's native platform ! This link might be of interest and discusses same sort of issue and also usage of `asyncio` package (and an alternative hand-crafted solution) which provides line based reading of the socket stream <https:\/\/stackoverflow.com\/questions\/29023885\/python-socket-readline-without-socket-makefile>",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "ge46f1f8b708",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/e46f1f8b708a630e3191de7b2c42b1d1.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0023-72.png",
            "first_name": "edblock",
            "real_name": "edblock",
            "display_name": "foxwood",
            "team": "T4G9NBD2M",
            "name": "eanb",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1694781853.808759",
        "parent_user_id": "U4H19D1D2",
        "attachments": [
            {
                "from_url": "https:\/\/stackoverflow.com\/questions\/29023885\/python-socket-readline-without-socket-makefile",
                "service_icon": "https:\/\/cdn.sstatic.net\/Sites\/stackoverflow\/Img\/apple-touch-icon.png?v=c78bd457575a",
                "thumb_url": "https:\/\/cdn.sstatic.net\/Sites\/stackoverflow\/Img\/apple-touch-icon@2.png?v=73d79a89bded",
                "thumb_width": 316,
                "thumb_height": 316,
                "id": 1,
                "original_url": "https:\/\/stackoverflow.com\/questions\/29023885\/python-socket-readline-without-socket-makefile",
                "fallback": "Stack Overflow: python socket readline without socket.makefile()",
                "text": "I'm trying to parse an HTTP request line (e.g. GET \/ HTTP\/1.1\\r\\n), which is easy with socket.makefile().readline() (BaseHTTPRequestHandler uses it), like:\nprint sock.makefile().readline()\n\nunfortu...",
                "title": "python socket readline without socket.makefile()",
                "title_link": "https:\/\/stackoverflow.com\/questions\/29023885\/python-socket-readline-without-socket-makefile",
                "service_name": "Stack Overflow"
            }
        ],
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "IwpDn",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Looking at a random recorded dogs file of ~1MB with ~5k lines 96% were less than 512 but only 6 selections of course - will vary by market type \/ sport. Maybe analyse lots of files and set optimum buffer size by "
                            },
                            {
                                "type": "text",
                                "text": "event_type_id",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " ? If you went for 4096 you'd get a message per buffer (for dogs anyway) which would be fastest poss.\n\nLooked at the parsing in "
                            },
                            {
                                "type": "text",
                                "text": "_receive_all()",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " and while it's quick and easy it's surprising that "
                            },
                            {
                                "type": "text",
                                "text": "makefile()",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " performs so badly on what should be it's native platform ! This link might be of interest and discusses same sort of issue and also usage of "
                            },
                            {
                                "type": "text",
                                "text": "asyncio",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " package (and an alternative hand-crafted solution) which provides line based reading of the socket stream "
                            },
                            {
                                "type": "link",
                                "url": "https:\/\/stackoverflow.com\/questions\/29023885\/python-socket-readline-without-socket-makefile"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U4H19D1D2",
        "type": "message",
        "ts": "1694807874.054499",
        "client_msg_id": "C7C2FB39-97DF-4854-8DD9-29E56CB502CB",
        "text": "Hmm but you are looking at one market \/ line, this isn’t equivalent to what would come out of the stream when you subscribe to multiple markets ",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "137c5a3ef323",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-03-15\/6819395173841_137c5a3ef323f1944a1a_72.png",
            "first_name": "liam",
            "real_name": "liam",
            "display_name": "liam",
            "team": "T4G9NBD2M",
            "name": "liam",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1694781853.808759",
        "parent_user_id": "U4H19D1D2",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "2K+",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Hmm but you are looking at one market \/ line, this "
                            },
                            {
                                "type": "text",
                                "text": "isn’t"
                            },
                            {
                                "type": "text",
                                "text": " equivalent to what would come out of the stream when you subscribe to multiple markets "
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U05PD1LRGGH",
        "type": "message",
        "ts": "1694808124.926059",
        "client_msg_id": "3efc7925-f8f6-4d5d-a693-eb61b0592d56",
        "text": "it's possible for even small messages of less than the buffer size to be combined together in a single read, it all very much depends on the network\n\na simple check would be to run a small test where in `_receive_all` where you check for the presence of `\\r\\n` in `data` not at the last two bytes and count the total number of reads\n\nI would do this but unfortunately I have very little time now after my flurry of activity",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "9dfcb6634166",
            "image_72": "https:\/\/avatars.slack-edge.com\/2023-08-22\/5795054986257_9dfcb6634166b21165c1_72.png",
            "first_name": "Pete",
            "real_name": "Pete",
            "display_name": "Pete",
            "team": "T4G9NBD2M",
            "name": "pete.d.marsh",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1694781853.808759",
        "parent_user_id": "U4H19D1D2",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "hfOvy",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "it's possible for even small messages of less than the buffer size to be combined together in a single read, it all very much depends on the network\n\na simple check would be to run a small test where in "
                            },
                            {
                                "type": "text",
                                "text": "_receive_all",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " where you check for the presence of "
                            },
                            {
                                "type": "text",
                                "text": "\\r\\n",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " in "
                            },
                            {
                                "type": "text",
                                "text": "data",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " not at the last two bytes and count the total number of reads\n\nI would do this but unfortunately I have very little time now after my flurry of activity"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U05PD1LRGGH",
        "type": "message",
        "ts": "1694808154.064639",
        "client_msg_id": "7b59125d-ac1d-4263-ba70-1b9bd5cee3cb",
        "text": "one thing I will take away is that one should not make any conclusions based off of what Windows does",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "9dfcb6634166",
            "image_72": "https:\/\/avatars.slack-edge.com\/2023-08-22\/5795054986257_9dfcb6634166b21165c1_72.png",
            "first_name": "Pete",
            "real_name": "Pete",
            "display_name": "Pete",
            "team": "T4G9NBD2M",
            "name": "pete.d.marsh",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1694781853.808759",
        "parent_user_id": "U4H19D1D2",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "zDIp",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "one thing I will take away is that one should not make any conclusions based off of what Windows does"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U05PD1LRGGH",
        "type": "message",
        "ts": "1694808366.754689",
        "client_msg_id": "94cd6b6a-5623-42d5-87f8-bce0b4cff021",
        "text": "what you should use for your socket receive buffer size is something that very much depends\n\nwith a low latency connection, fast processing of received messages and smallish message sizes from bf I would imagine you will quickly get diminishing returns from larger and larger buffers\n\nthis is also something you can test by recording how often the receive buffer you use is completely full",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "9dfcb6634166",
            "image_72": "https:\/\/avatars.slack-edge.com\/2023-08-22\/5795054986257_9dfcb6634166b21165c1_72.png",
            "first_name": "Pete",
            "real_name": "Pete",
            "display_name": "Pete",
            "team": "T4G9NBD2M",
            "name": "pete.d.marsh",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1694781853.808759",
        "parent_user_id": "U4H19D1D2",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "xLwhr",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "what you should use for your socket receive buffer size is something that very much depends\n\nwith a low latency connection, fast processing of received messages and smallish message sizes from bf I would imagine you will quickly get diminishing returns from larger and larger buffers\n\nthis is also something you can test by recording how often the receive buffer you use is completely full"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U02RN7YDRQ9",
        "type": "message",
        "ts": "1694810637.180029",
        "client_msg_id": "1735597a-9af1-476e-a97f-815b055a626c",
        "text": "Maybe it's a case of \"it aint broke\" ? Could supply a `buffer_size` argument in the strategy constructor that feeds down into `MarketStream` to allow users to try their own buffer sizing - bit like the current `market_filter` ? That could provide some useful feedback as to what works best.",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "ge46f1f8b708",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/e46f1f8b708a630e3191de7b2c42b1d1.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0023-72.png",
            "first_name": "edblock",
            "real_name": "edblock",
            "display_name": "foxwood",
            "team": "T4G9NBD2M",
            "name": "eanb",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1694781853.808759",
        "parent_user_id": "U4H19D1D2",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "JDGL",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Maybe it's a case of \"it aint broke\" ? Could supply a "
                            },
                            {
                                "type": "text",
                                "text": "buffer_size ",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": "argument in the strategy constructor that feeds down into "
                            },
                            {
                                "type": "text",
                                "text": "MarketStream ",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": "to allow users to try their own buffer sizing - bit like the current "
                            },
                            {
                                "type": "text",
                                "text": "market_filter",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " ? That could provide some useful feedback as to what works best."
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U05PD1LRGGH",
        "type": "message",
        "ts": "1694813557.165669",
        "client_msg_id": "629bb82b-0e4c-48ca-92b8-a095e07ab530",
        "text": "yeah I'm no longer convinced my changes are worth it",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "9dfcb6634166",
            "image_72": "https:\/\/avatars.slack-edge.com\/2023-08-22\/5795054986257_9dfcb6634166b21165c1_72.png",
            "first_name": "Pete",
            "real_name": "Pete",
            "display_name": "Pete",
            "team": "T4G9NBD2M",
            "name": "pete.d.marsh",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1694781853.808759",
        "parent_user_id": "U4H19D1D2",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "Qlp",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "yeah I'm no longer convinced my changes are worth it"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U05PD1LRGGH",
        "type": "message",
        "ts": "1694813608.722299",
        "client_msg_id": "89ec1ff0-b636-47a6-8dd8-990db351725a",
        "text": "if the numbers I got on Windows transferred across to Linux then absolutely, but as that does not appear to be the case I can't make the argument for them",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "9dfcb6634166",
            "image_72": "https:\/\/avatars.slack-edge.com\/2023-08-22\/5795054986257_9dfcb6634166b21165c1_72.png",
            "first_name": "Pete",
            "real_name": "Pete",
            "display_name": "Pete",
            "team": "T4G9NBD2M",
            "name": "pete.d.marsh",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1694781853.808759",
        "parent_user_id": "U4H19D1D2",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "XgiR",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "if the numbers I got on Windows transferred across to Linux then absolutely, but as that does not appear to be the case I can't make the argument for them"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "text": "hi guys,\ntryng to calculate the actual winning runner from result and from event name\ni see the sometime event name does not contain the runner name, so it's difficult to match the winning runner (calculate) with the runner, any ideas, i.e:",
        "files": [
            {
                "id": "F05SMT5FVEE",
                "mode": "hidden_by_limit"
            }
        ],
        "upload": false,
        "user": "U05KGFZUNAK",
        "display_as_bot": false,
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "DR+H",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "hi guys,\ntryng to calculate the actual winning runner from result and from event name\ni see the sometime event name does not contain the runner name, so it's difficult to match the winning runner (calculate) with the runner, any ideas, i.e:"
                            }
                        ]
                    }
                ]
            }
        ],
        "type": "message",
        "ts": "1694845925.401779",
        "client_msg_id": "351863c3-4e6e-432e-af10-21d95827cf8f",
        "thread_ts": "1694845925.401779",
        "reply_count": 14,
        "reply_users_count": 3,
        "latest_reply": "1694856396.650429",
        "reply_users": [
            "U4H19D1D2",
            "UBS7QANF3",
            "U05KGFZUNAK"
        ],
        "replies": [
            {
                "user": "U4H19D1D2",
                "ts": "1694846924.305519"
            },
            {
                "user": "UBS7QANF3",
                "ts": "1694847869.597659"
            },
            {
                "user": "U05KGFZUNAK",
                "ts": "1694847907.139739"
            },
            {
                "user": "U05KGFZUNAK",
                "ts": "1694847923.840669"
            },
            {
                "user": "UBS7QANF3",
                "ts": "1694848122.428939"
            },
            {
                "user": "U05KGFZUNAK",
                "ts": "1694848717.181129"
            },
            {
                "user": "U05KGFZUNAK",
                "ts": "1694848724.571559"
            },
            {
                "user": "UBS7QANF3",
                "ts": "1694848727.420469"
            },
            {
                "user": "UBS7QANF3",
                "ts": "1694848768.186349"
            },
            {
                "user": "U05KGFZUNAK",
                "ts": "1694849199.468049"
            },
            {
                "user": "UBS7QANF3",
                "ts": "1694849239.941649"
            },
            {
                "user": "U05KGFZUNAK",
                "ts": "1694849559.721939"
            },
            {
                "user": "UBS7QANF3",
                "ts": "1694849994.750589"
            },
            {
                "user": "U05KGFZUNAK",
                "ts": "1694856396.650429"
            }
        ],
        "is_locked": false,
        "subscribed": true,
        "last_read": "1694856396.650429"
    },
    {
        "user": "U4H19D1D2",
        "type": "message",
        "ts": "1694846924.305519",
        "client_msg_id": "AD6B49AD-4D90-4EC9-9A6C-FED334BF6E9C",
        "text": "What are we looking at here \/ why aren’t you using the market\/selectionId?",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "137c5a3ef323",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-03-15\/6819395173841_137c5a3ef323f1944a1a_72.png",
            "first_name": "liam",
            "real_name": "liam",
            "display_name": "liam",
            "team": "T4G9NBD2M",
            "name": "liam",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1694845925.401779",
        "parent_user_id": "U05KGFZUNAK",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "cW4a",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "What are we looking at here \/ why "
                            },
                            {
                                "type": "text",
                                "text": "aren’t"
                            },
                            {
                                "type": "text",
                                "text": " you using the market\/selectionId?"
                            }
                        ]
                    }
                ]
            }
        ]
    }
]