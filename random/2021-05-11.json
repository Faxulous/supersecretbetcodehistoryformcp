[
    {
        "user": "UPMUFSGCR",
        "type": "message",
        "ts": "1620724644.333100",
        "client_msg_id": "9b1e636b-748d-45cc-9db8-506f4423580c",
        "text": "How hard would it be to refactor BFLW, so that it returns the price\/sizes as lists ornumpy arrays? I see that the data comes from the market cache. When profiling my backtests, they spend a lot of time converting \"price\/size lists of dicts\" into numpy arrays. I feed these into my numba-compiled pricing functions, which is why they need the conversion. So I guess I'm wondering whether or not it's common for people to feed the market data into numerical pricing functions, and whether or not enough people would like the data in array-format, for this to be worth doing.",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "31c0bb5a442c",
            "image_72": "https:\/\/avatars.slack-edge.com\/2019-10-28\/812386967189_31c0bb5a442c5b8d2c61_72.png",
            "first_name": "Jon",
            "real_name": "Jon Jon Jon Jon Jon Jon Jon Jon",
            "display_name": "Jonjonjon",
            "team": "T4G9NBD2M",
            "name": "fcmisc",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "wSxc",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "How hard would it be to refactor BFLW, so that it returns the price\/sizes as lists ornumpy arrays? I see that the data comes from the market cache. When profiling my backtests, they spend a lot of time converting \"price\/size lists of dicts\" into numpy arrays. I feed these into my numba-compiled pricing functions, which is why they need the conversion. So I guess I'm wondering whether or not it's common for people to feed the market data into numerical pricing functions, and whether or not enough people would like the data in array-format, for this to be worth doing."
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U4H19D1D2",
        "type": "message",
        "ts": "1620725936.334000",
        "client_msg_id": "75cc41a9-ac7e-44a8-a8fb-49d39e63b73b",
        "text": "just patch it, in flumine we <https:\/\/github.com\/liampauling\/flumine\/blob\/master\/flumine\/patching.py|patch> the price size by not converting to py objects so you could just do the same to numpy arrays",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "137c5a3ef323",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-03-15\/6819395173841_137c5a3ef323f1944a1a_72.png",
            "first_name": "liam",
            "real_name": "liam",
            "display_name": "liam",
            "team": "T4G9NBD2M",
            "name": "liam",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1620725936.334000",
        "reply_count": 2,
        "reply_users_count": 2,
        "latest_reply": "1620728373.335700",
        "reply_users": [
            "UPMUFSGCR",
            "U4H19D1D2"
        ],
        "replies": [
            {
                "user": "UPMUFSGCR",
                "ts": "1620727622.335300"
            },
            {
                "user": "U4H19D1D2",
                "ts": "1620728373.335700"
            }
        ],
        "is_locked": false,
        "subscribed": true,
        "last_read": "1620728373.335700",
        "attachments": [
            {
                "text": "```\n\"\"\"\ndjango style `lazy` object creation, the main bulk of processing\nis turning {priceSize} into &lt;PriceSize&gt; objects but this is\npointless a lot of the time as the object is not used or can be\nhandled as a dict instead.\n\nThe inclusion of slots further reduces the processing time as well\nas reducing memory.\n\nThis optimisation will improve normal streaming as well as\nbacktesting, with more speed, less CPU + ram and minimal reduction\nin usability.\n\"\"\"\n\n\nclass SP:\n    __slots__ = [\n        \"near_price\",\n        \"far_price\",\n        \"actual_sp\",\n        \"back_stake_taken\",\n        \"lay_liability_taken\",\n    ]\n\n    def __init__(\n        self,\n        nearPrice: float = None,\n        farPrice: float = None,\n        backStakeTaken: list = None,\n        layLiabilityTaken: list = None,\n        actualSP: float = None,\n    ):\n        self.near_price = nearPrice\n        self.far_price = farPrice\n        self.actual_sp = actualSP\n        self.back_stake_taken = backStakeTaken\n        self.lay_liability_taken = layLiabilityTaken\n\n\nclass EX:\n    __slots__ = [\"available_to_back\", \"available_to_lay\", \"traded_volume\"]\n\n    def __init__(\n        self,\n        availableToBack: list = None,\n        availableToLay: list = None,\n        tradedVolume: list = None,\n    ):\n        self.available_to_back = availableToBack\n        self.available_to_lay = availableToLay\n        self.traded_volume = tradedVolume\n\n```",
                "title": "<https:\/\/github.com\/liampauling\/flumine\/blob\/master\/flumine\/patching.py | patching.py>",
                "footer": "<https:\/\/github.com\/liampauling\/flumine|liampauling\/flumine>",
                "id": 1,
                "footer_icon": "https:\/\/slack.github.com\/static\/img\/favicon-neutral.png",
                "color": "24292f",
                "mrkdwn_in": [
                    "text"
                ],
                "fallback": "<https:\/\/github.com\/liampauling\/flumine\/blob\/master\/flumine\/patching.py | patching.py>",
                "bot_id": "B021ZJYSBMW",
                "app_unfurl_url": "https:\/\/github.com\/liampauling\/flumine\/blob\/master\/flumine\/patching.py",
                "is_app_unfurl": true
            }
        ],
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "2KXu",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "just patch it, in flumine we "
                            },
                            {
                                "type": "link",
                                "url": "https:\/\/github.com\/liampauling\/flumine\/blob\/master\/flumine\/patching.py",
                                "text": "patch"
                            },
                            {
                                "type": "text",
                                "text": " the price size by not converting to py objects so you could just do the same to numpy arrays"
                            }
                        ]
                    }
                ]
            }
        ],
        "reactions": [
            {
                "name": "+1::skin-tone-6",
                "users": [
                    "UPMUFSGCR"
                ],
                "count": 1
            }
        ]
    },
    {
        "user": "ULDAVFDRP",
        "type": "message",
        "ts": "1620726374.334600",
        "client_msg_id": "28944922-fa9f-43b8-b5b2-87e2024b0414",
        "text": "has there been any statement from betfair about recent outages (mainly last night)",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "g46fe1c1bf03",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/b46fe1c1bf03e18d951e7032fb494283.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0019-72.png",
            "first_name": "",
            "real_name": "Oliver Varney",
            "display_name": "Oliver Varney",
            "team": "T4G9NBD2M",
            "name": "oliverashleyvarney",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "A0y",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "has there been any statement from betfair about recent outages (mainly last night)"
                            }
                        ]
                    }
                ]
            }
        ],
        "reactions": [
            {
                "name": "facepunch",
                "users": [
                    "U4H19D1D2"
                ],
                "count": 1
            }
        ]
    },
    {
        "user": "UPMUFSGCR",
        "type": "message",
        "ts": "1620727622.335300",
        "client_msg_id": "44bce22e-cb8b-4c81-bb0c-d64dd94e8d30",
        "text": "Thanks for the tip <@U4H19D1D2>. I might also try patching the market cache to keep everything in numpy arrays. Insertions and deletions could be slower, but if it saves my code from creating new numpy arrays at every time step, perhaps it will be faster anyway.\n\n<https:\/\/github.com\/liampauling\/betfair\/blob\/ee4488ddb4f4bee775450f7497c08ea0fb470e9b\/betfairlightweight\/streaming\/cache.py#L45-L72>",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "31c0bb5a442c",
            "image_72": "https:\/\/avatars.slack-edge.com\/2019-10-28\/812386967189_31c0bb5a442c5b8d2c61_72.png",
            "first_name": "Jon",
            "real_name": "Jon Jon Jon Jon Jon Jon Jon Jon",
            "display_name": "Jonjonjon",
            "team": "T4G9NBD2M",
            "name": "fcmisc",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1620725936.334000",
        "parent_user_id": "U4H19D1D2",
        "attachments": [
            {
                "text": "```\n    def update(self, book_update: list) -&gt; None:\n        deletion_select = self.deletion_select  # local vars\n        for book in book_update:\n            book = book.copy()  # create copy to keep streaming_update raw\n            key = book[0]  # price or position\n            if book[deletion_select] == 0:\n                # remove price\/size\n                try:\n                    del self.order_book[key]\n                except KeyError:\n                    continue\n            else:\n                # serialise once and cache in the book\n                book.append(\n                    {\n                        \"price\": book[deletion_select - 1],\n                        \"size\": book[deletion_select],\n                    }\n                )\n                if key not in self.order_book:\n                    # new price requiring a reorder\n                    # to the book.\n                    self.order_book[key] = book\n                    self._sort_order_book()\n                else:\n                    # update book\n                    self.order_book[key] = book\n        self.serialise()\n```",
                "title": "<https:\/\/github.com\/liampauling\/betfair\/blob\/ee4488ddb4f4bee775450f7497c08ea0fb470e9b\/betfairlightweight\/streaming\/cache.py | cache.py>",
                "footer": "<https:\/\/github.com\/liampauling\/betfair|liampauling\/betfair>",
                "id": 1,
                "footer_icon": "https:\/\/slack.github.com\/static\/img\/favicon-neutral.png",
                "color": "24292f",
                "mrkdwn_in": [
                    "text"
                ],
                "fallback": "<https:\/\/github.com\/liampauling\/betfair\/blob\/ee4488ddb4f4bee775450f7497c08ea0fb470e9b\/betfairlightweight\/streaming\/cache.py | cache.py>",
                "bot_id": "B021ZJYSBMW",
                "app_unfurl_url": "https:\/\/github.com\/liampauling\/betfair\/blob\/ee4488ddb4f4bee775450f7497c08ea0fb470e9b\/betfairlightweight\/streaming\/cache.py#L45-L72",
                "is_app_unfurl": true
            }
        ],
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "vdTZ",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Thanks for the tip "
                            },
                            {
                                "type": "user",
                                "user_id": "U4H19D1D2"
                            },
                            {
                                "type": "text",
                                "text": ". I might also try patching the market cache to keep everything in numpy arrays. Insertions and deletions could be slower, but if it saves my code from creating new numpy arrays at every time step, perhaps it will be faster anyway.\n\n"
                            },
                            {
                                "type": "link",
                                "url": "https:\/\/github.com\/liampauling\/betfair\/blob\/ee4488ddb4f4bee775450f7497c08ea0fb470e9b\/betfairlightweight\/streaming\/cache.py#L45-L72"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U4H19D1D2",
        "type": "message",
        "ts": "1620728373.335700",
        "client_msg_id": "2054473e-6277-4edf-ac45-65f297d7e43a",
        "text": "good luck",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "137c5a3ef323",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-03-15\/6819395173841_137c5a3ef323f1944a1a_72.png",
            "first_name": "liam",
            "real_name": "liam",
            "display_name": "liam",
            "team": "T4G9NBD2M",
            "name": "liam",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1620725936.334000",
        "parent_user_id": "U4H19D1D2",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "V2h5",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "good luck"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "UBS7QANF3",
        "type": "message",
        "ts": "1620748392.336300",
        "client_msg_id": "2f6dff2f-5b9b-4a45-927c-4cc3a645e686",
        "text": "This (online) event on Statistics and Football may be of some interest to people: <https:\/\/rss.org.uk\/training-events\/events\/events-2021\/local-groups\/rss-merseyside-local-group-statistics-and-football\/>",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "gaaf844a4a90",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/eaaf844a4a905431d83430e563b077aa.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0011-72.png",
            "first_name": "",
            "real_name": "Maurice Berk",
            "display_name": "Mo",
            "team": "T4G9NBD2M",
            "name": "maurice",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "rwT",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "This (online) event on Statistics and Football may be of some interest to people: "
                            },
                            {
                                "type": "link",
                                "url": "https:\/\/rss.org.uk\/training-events\/events\/events-2021\/local-groups\/rss-merseyside-local-group-statistics-and-football\/"
                            }
                        ]
                    }
                ]
            }
        ],
        "reactions": [
            {
                "name": "+1",
                "users": [
                    "U0122TPQABW",
                    "UUE6E1LA1"
                ],
                "count": 2
            }
        ]
    },
    {
        "user": "ULDAVFDRP",
        "type": "message",
        "ts": "1620754843.337100",
        "edited": {
            "user": "ULDAVFDRP",
            "ts": "1620754895.000000"
        },
        "client_msg_id": "79e5c6ee-20ba-49c4-b6fe-57eb74faed01",
        "text": "Van Dijk backers finally rewarded :raised_hands: :joy:",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "g46fe1c1bf03",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/b46fe1c1bf03e18d951e7032fb494283.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0019-72.png",
            "first_name": "",
            "real_name": "Oliver Varney",
            "display_name": "Oliver Varney",
            "team": "T4G9NBD2M",
            "name": "oliverashleyvarney",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "icw",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Van Dijk backers finally rewarded "
                            },
                            {
                                "type": "emoji",
                                "name": "raised_hands",
                                "unicode": "1f64c"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "emoji",
                                "name": "joy",
                                "unicode": "1f602"
                            }
                        ]
                    }
                ]
            }
        ]
    }
]