[
    {
        "user": "U4H19D1D2",
        "type": "message",
        "ts": "1675939632.204639",
        "client_msg_id": "1cc4cbf9-bc9c-49bc-9894-20c98aa40ccb",
        "text": "*<https:\/\/promos.betfair.com\/promotion?promoCode=CHELTHISTDATA|Cheltenham Festival - Free Exchange Historical Data>*\n\n_The Betfair Historical Data service provides time-stamped Betfair Exchange data for purchase &amp; download to registered Betfair customers_\n_To mark the up and coming Cheltenham Festival (14th-17th March) we are offering the following free data packages (worth £1097) covering the Cheltenham Festival period over the last 4 years._\n\n_• Horse Racing - ADVANCED data – March 2019-2022_\n_• Horse Racing - PRO data - March 2019-2022_",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "137c5a3ef323",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-03-15\/6819395173841_137c5a3ef323f1944a1a_72.png",
            "first_name": "liam",
            "real_name": "liam",
            "display_name": "liam",
            "team": "T4G9NBD2M",
            "name": "liam",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "sXw",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "link",
                                "url": "https:\/\/promos.betfair.com\/promotion?promoCode=CHELTHISTDATA",
                                "text": "Cheltenham Festival - Free Exchange Historical Data",
                                "style": {
                                    "bold": true
                                }
                            },
                            {
                                "type": "text",
                                "text": "\n\n"
                            },
                            {
                                "type": "text",
                                "text": "The Betfair Historical Data service provides time-stamped Betfair Exchange data for purchase & download to registered Betfair customers",
                                "style": {
                                    "italic": true
                                }
                            },
                            {
                                "type": "text",
                                "text": "\n"
                            },
                            {
                                "type": "text",
                                "text": "To mark the up and coming Cheltenham Festival (14th-17th March) we are offering the following free data packages (worth £1097) covering the Cheltenham Festival period over the last 4 years.",
                                "style": {
                                    "italic": true
                                }
                            },
                            {
                                "type": "text",
                                "text": "\n\n"
                            },
                            {
                                "type": "text",
                                "text": "• Horse Racing - ADVANCED data – March 2019-2022",
                                "style": {
                                    "italic": true
                                }
                            },
                            {
                                "type": "text",
                                "text": "\n"
                            },
                            {
                                "type": "text",
                                "text": "• Horse Racing - PRO data - March 2019-2022",
                                "style": {
                                    "italic": true
                                }
                            }
                        ]
                    }
                ]
            }
        ],
        "reactions": [
            {
                "name": "raised_hands",
                "users": [
                    "U01EZ613ZCZ",
                    "U04H54Q392N"
                ],
                "count": 2
            }
        ]
    },
    {
        "user": "UQL0QDEKA",
        "type": "message",
        "ts": "1675944260.015499",
        "client_msg_id": "fb3d5a58-98de-4bc1-b494-06c744902d87",
        "text": "I saw that Liam in the newsletter. So (and hope this isnt a stupid question!) but can it be used in its raw format to use with Flumine backtesting?",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "g444d10128c0",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/444d10128c0aaf094041a52a76796602.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0005-72.png",
            "first_name": "Peter",
            "real_name": "Peter Lenagh",
            "display_name": "PeterLe",
            "team": "T4G9NBD2M",
            "name": "lenagh",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "rx7b",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "I saw that Liam in the newsletter. So (and hope this isnt a stupid question!) but can it be used in its raw format to use with Flumine backtesting?"
                            }
                        ]
                    }
                ]
            }
        ],
        "reactions": [
            {
                "name": "100",
                "users": [
                    "U01D23DDMTQ"
                ],
                "count": 1
            }
        ]
    },
    {
        "user": "U4H19D1D2",
        "type": "message",
        "ts": "1675944283.691359",
        "client_msg_id": "a3ddc8b5-20f7-416a-a83a-d3103f41b81c",
        "text": "Yep, straight in",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "137c5a3ef323",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-03-15\/6819395173841_137c5a3ef323f1944a1a_72.png",
            "first_name": "liam",
            "real_name": "liam",
            "display_name": "liam",
            "team": "T4G9NBD2M",
            "name": "liam",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1675944283.691359",
        "reply_count": 1,
        "reply_users_count": 1,
        "latest_reply": "1675944427.933249",
        "reply_users": [
            "UQL0QDEKA"
        ],
        "replies": [
            {
                "user": "UQL0QDEKA",
                "ts": "1675944427.933249"
            }
        ],
        "is_locked": false,
        "subscribed": true,
        "last_read": "1675944427.933249",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "Zu1J",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Yep, straight in"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "UQL0QDEKA",
        "type": "message",
        "ts": "1675944427.933249",
        "client_msg_id": "e0f5f42d-f070-4a5d-89f0-26a974939a40",
        "text": "Nice one :+1:",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "g444d10128c0",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/444d10128c0aaf094041a52a76796602.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0005-72.png",
            "first_name": "Peter",
            "real_name": "Peter Lenagh",
            "display_name": "PeterLe",
            "team": "T4G9NBD2M",
            "name": "lenagh",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1675944283.691359",
        "parent_user_id": "U4H19D1D2",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "DN+",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Nice one "
                            },
                            {
                                "type": "emoji",
                                "name": "+1",
                                "unicode": "1f44d"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U03CL4F39M4",
        "type": "message",
        "ts": "1675945261.759839",
        "client_msg_id": "2cddf4b8-2162-491f-b7c6-9aa5bd325cd7",
        "text": "Hey guys,\nHope everyone is keeping well.\n\nI am attempting to parse Betfair historical stream data (bz2 files) to CSV using the modules Betfair_Data and Betfair Lightweight in Python.\nHowever, when parsing the bz2 files using Betfair_Data, I am receiving the print statement _“ (JSON Parse Error) missing required field &lt;marketType&gt; at line X column Y“_, and consequently, data on the markets that exhibit this error are not included in my final csv.\n\n*I was wondering if somebody may be able to point me to the module (or help me modify the module), such that the bz2 files that are missing the MarketType entry are still parsed with market_type = NaN, rather than excluded from consideration.* \n\nAs a side note, I have confirmed that this issue is indeed arising because in several of the raw bz2 files provided by Betfair, the marketType entry is missing.\nAny help that could be provided would be much appreciated!\n\nCheers!",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "914e66aa98f5",
            "image_72": "https:\/\/avatars.slack-edge.com\/2022-04-25\/3458558719456_914e66aa98f5dcdbe576_72.png",
            "first_name": "Nicholas",
            "real_name": "Nicholas vizard",
            "display_name": "Nicholas vizard",
            "team": "T4G9NBD2M",
            "name": "nsavizard",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1675945261.759839",
        "reply_count": 15,
        "reply_users_count": 4,
        "latest_reply": "1676030212.245269",
        "reply_users": [
            "U4H19D1D2",
            "U03CL4F39M4",
            "UBS7QANF3",
            "U80AMMRKP"
        ],
        "replies": [
            {
                "user": "U4H19D1D2",
                "ts": "1675945341.172059"
            },
            {
                "user": "U03CL4F39M4",
                "ts": "1675945623.589869"
            },
            {
                "user": "U4H19D1D2",
                "ts": "1675945732.414439"
            },
            {
                "user": "UBS7QANF3",
                "ts": "1675945854.467499"
            },
            {
                "user": "U03CL4F39M4",
                "ts": "1675946052.890849"
            },
            {
                "user": "UBS7QANF3",
                "ts": "1675946118.023159"
            },
            {
                "user": "U03CL4F39M4",
                "ts": "1675947131.176789"
            },
            {
                "user": "UBS7QANF3",
                "ts": "1675947159.804439"
            },
            {
                "user": "UBS7QANF3",
                "ts": "1675947826.983869"
            },
            {
                "user": "U80AMMRKP",
                "ts": "1675959305.720849"
            },
            {
                "user": "U03CL4F39M4",
                "ts": "1676027268.075879"
            },
            {
                "user": "UBS7QANF3",
                "ts": "1676027317.156759"
            },
            {
                "user": "U03CL4F39M4",
                "ts": "1676029702.656959"
            },
            {
                "user": "UBS7QANF3",
                "ts": "1676030161.240619"
            },
            {
                "user": "UBS7QANF3",
                "ts": "1676030212.245269"
            }
        ],
        "is_locked": false,
        "subscribed": true,
        "last_read": "1676030212.245269",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "Ly1",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Hey guys,\nHope everyone is keeping well.\n\nI am attempting to parse Betfair historical stream data (bz2 files) to CSV using the modules Betfair_Data and Betfair Lightweight in Python.\nHowever, when parsing the bz2 files using Betfair_Data, I am receiving the print statement "
                            },
                            {
                                "type": "text",
                                "text": "“ (JSON Parse Error) missing required field <marketType> at line X column Y“",
                                "style": {
                                    "italic": true
                                }
                            },
                            {
                                "type": "text",
                                "text": ", and consequently, data on the markets that exhibit this error are not included in my final csv.\n\n"
                            },
                            {
                                "type": "text",
                                "text": "I was wondering if somebody may be able to point me to the module (or help me modify the module), such that the bz2 files that are missing the MarketType entry are still parsed with market_type = NaN, rather than excluded from consideration. ",
                                "style": {
                                    "bold": true
                                }
                            },
                            {
                                "type": "text",
                                "text": "\n\nAs a side note, I have confirmed that this issue is indeed arising because in several of the raw bz2 files provided by Betfair, the marketType entry is missing.\nAny help that could be provided would be much appreciated!\n\nCheers!"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U4H19D1D2",
        "type": "message",
        "ts": "1675945341.172059",
        "client_msg_id": "82d8c53e-ccca-423c-9678-b77f2ef99d31",
        "text": "Which library are you using? You mention two?",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "137c5a3ef323",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-03-15\/6819395173841_137c5a3ef323f1944a1a_72.png",
            "first_name": "liam",
            "real_name": "liam",
            "display_name": "liam",
            "team": "T4G9NBD2M",
            "name": "liam",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1675945261.759839",
        "parent_user_id": "U03CL4F39M4",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "T=DX3",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Which library are you using? You mention two?"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "text": "Apologies, I am rather new to Python. My load_markets functionality uses betfair lightweight, though this module is imported via betfair_data.",
        "files": [
            {
                "id": "F04NN0H3TGE",
                "mode": "hidden_by_limit"
            },
            {
                "id": "F04NUEZLHBM",
                "mode": "hidden_by_limit"
            }
        ],
        "upload": false,
        "user": "U03CL4F39M4",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "6HC",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Apologies, I am rather new to Python. My load_markets functionality uses betfair lightweight, though this module is imported via betfair_data."
                            }
                        ]
                    }
                ]
            }
        ],
        "type": "message",
        "ts": "1675945623.589869",
        "client_msg_id": "47b58bc3-b9b4-4d5e-81f1-4cad3c99dbf0",
        "thread_ts": "1675945261.759839",
        "parent_user_id": "U03CL4F39M4"
    },
    {
        "user": "U4H19D1D2",
        "type": "message",
        "ts": "1675945732.414439",
        "client_msg_id": "86740cbc-889e-468c-99c0-fc08ffea6f17",
        "text": "So you are using the `betfair_data` library but in 'betfairlightweight' format, therefore a bug in the Rust library, I would create an issue on the <https:\/\/github.com\/tarb\/betfair_data\/issues|repo> however I am not sure how active Rob is",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "137c5a3ef323",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-03-15\/6819395173841_137c5a3ef323f1944a1a_72.png",
            "first_name": "liam",
            "real_name": "liam",
            "display_name": "liam",
            "team": "T4G9NBD2M",
            "name": "liam",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1675945261.759839",
        "parent_user_id": "U03CL4F39M4",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "mzL",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "So you are using the "
                            },
                            {
                                "type": "text",
                                "text": "betfair_data",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " library but in 'betfairlightweight' format, therefore a bug in the Rust library, I would create an issue on the "
                            },
                            {
                                "type": "link",
                                "url": "https:\/\/github.com\/tarb\/betfair_data\/issues",
                                "text": "repo"
                            },
                            {
                                "type": "text",
                                "text": " however I am not sure how active Rob is"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "UBS7QANF3",
        "type": "message",
        "ts": "1675945854.467499",
        "client_msg_id": "13417211-9fc0-4971-8336-67212f930ac1",
        "text": "Extremely inactive in my experience",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "gaaf844a4a90",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/eaaf844a4a905431d83430e563b077aa.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0011-72.png",
            "first_name": "",
            "real_name": "Maurice Berk",
            "display_name": "Mo",
            "team": "T4G9NBD2M",
            "name": "maurice",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1675945261.759839",
        "parent_user_id": "U03CL4F39M4",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "B8Acd",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Extremely inactive in my experience"
                            }
                        ]
                    }
                ]
            }
        ],
        "reactions": [
            {
                "name": "cry",
                "users": [
                    "U4H19D1D2"
                ],
                "count": 1
            }
        ]
    },
    {
        "user": "U03CL4F39M4",
        "type": "message",
        "ts": "1675946052.890849",
        "client_msg_id": "d45755e2-6419-4af6-a0d1-d7df780c8b50",
        "text": "Thanks for the feedback guys. Do you think it would be worthwhile attempting the whole thing in Betfair lightweight exclusively?",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "914e66aa98f5",
            "image_72": "https:\/\/avatars.slack-edge.com\/2022-04-25\/3458558719456_914e66aa98f5dcdbe576_72.png",
            "first_name": "Nicholas",
            "real_name": "Nicholas vizard",
            "display_name": "Nicholas vizard",
            "team": "T4G9NBD2M",
            "name": "nsavizard",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1675945261.759839",
        "parent_user_id": "U03CL4F39M4",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "ZkY",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Thanks for the feedback guys. Do you think it would be worthwhile attempting the whole thing in Betfair lightweight exclusively?"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "UBS7QANF3",
        "type": "message",
        "ts": "1675946118.023159",
        "edited": {
            "user": "UBS7QANF3",
            "ts": "1675946130.000000"
        },
        "client_msg_id": "9831e099-25c2-45e7-955c-5dfcb74da93a",
        "text": "Sounds like you're going to have to. Although depending on what you're trying to do I would obviously advise you use betfairutil :wink:",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "gaaf844a4a90",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/eaaf844a4a905431d83430e563b077aa.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0011-72.png",
            "first_name": "",
            "real_name": "Maurice Berk",
            "display_name": "Mo",
            "team": "T4G9NBD2M",
            "name": "maurice",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1675945261.759839",
        "parent_user_id": "U03CL4F39M4",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "0BoVX",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Sounds like you're going to have to. Although depending on what you're trying to do I would obviously advise you use betfairutil "
                            },
                            {
                                "type": "emoji",
                                "name": "wink",
                                "unicode": "1f609"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U03CL4F39M4",
        "type": "message",
        "ts": "1675947131.176789",
        "client_msg_id": "b12816cf-7bac-4309-9c36-7a0d67ab8818",
        "text": "Thanks for the advice Mo. Would you advice to use betfairutil for the below objective?\n\n I am looking to parse several years of the historical stream bz2 files (across several sports - so I have a lot of bz2 files) into csv files so that I can perform analyses in a format more familiar to me. For each market, I would like to extract data at periodic intervals (e.g. every 10 minutes) and also at target points (e.g. final market_books\/last pre play market_books). The contents of the extraction would need to include data  on market_defintions\/times\/prices\/volumes on a selection by selection basis.\nThanks!",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "914e66aa98f5",
            "image_72": "https:\/\/avatars.slack-edge.com\/2022-04-25\/3458558719456_914e66aa98f5dcdbe576_72.png",
            "first_name": "Nicholas",
            "real_name": "Nicholas vizard",
            "display_name": "Nicholas vizard",
            "team": "T4G9NBD2M",
            "name": "nsavizard",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1675945261.759839",
        "parent_user_id": "U03CL4F39M4",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "o15",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Thanks for the advice Mo. Would you advice to use betfairutil for the below objective?\n\n I am looking to parse several years of the historical stream bz2 files (across several sports - so I have a lot of bz2 files) into csv files so that I can perform analyses in a format more familiar to me. For each market, I would like to extract data at periodic intervals (e.g. every 10 minutes) and also at target points (e.g. final market_books\/last pre play market_books). The contents of the extraction would need to include data  on market_defintions\/times\/prices\/volumes on a selection by selection basis.\nThanks!"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "UBS7QANF3",
        "type": "message",
        "ts": "1675947159.804439",
        "client_msg_id": "d326204c-5ff8-492a-8332-e15ec6550da8",
        "text": "Yes",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "gaaf844a4a90",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/eaaf844a4a905431d83430e563b077aa.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0011-72.png",
            "first_name": "",
            "real_name": "Maurice Berk",
            "display_name": "Mo",
            "team": "T4G9NBD2M",
            "name": "maurice",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1675945261.759839",
        "parent_user_id": "U03CL4F39M4",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "Efsb",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Yes"
                            }
                        ]
                    }
                ]
            }
        ],
        "reactions": [
            {
                "name": "+1",
                "users": [
                    "U03CL4F39M4"
                ],
                "count": 1
            }
        ]
    },
    {
        "user": "UBS7QANF3",
        "type": "message",
        "ts": "1675947826.983869",
        "edited": {
            "user": "UBS7QANF3",
            "ts": "1675949540.000000"
        },
        "client_msg_id": "873b1b6b-11fd-4b79-938d-ddd043499acd",
        "text": "Pseudo code:\n\n```import betfairutil as bu\n\nfor path_to_file in files:\n    last_extract_time = 0\n    previous_market_book = None\n    for market_book in bu.create_market_book_generator_from_prices_file(path_to_file):\n        # Calculate time since last extract time\n        if time_since_last_extract_time &gt;= # 10 minutes\n            df = bu.market_book_to_data_frame(market_book, ...)\n            df.to_csv(...)  # Save to CSV here or append and write at the end\n            last_extract_time = market_book[\"publishTime\"]\n        elif previous_market_book is not None and not previous_market_book[\"inplay\"] and market_book[\"inplay\"]:\n            # Capture final pre-event market book\n            df = bu.market_book_to_data_frame(previous_market_book, ...)\n            ...\n        previous_market_book = market_book\n     # Process final market book\n     df = bu.market_book_to_data_frame(market_book, ...)```",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "gaaf844a4a90",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/eaaf844a4a905431d83430e563b077aa.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0011-72.png",
            "first_name": "",
            "real_name": "Maurice Berk",
            "display_name": "Mo",
            "team": "T4G9NBD2M",
            "name": "maurice",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1675945261.759839",
        "parent_user_id": "U03CL4F39M4",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "Zcy7",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Pseudo code:\n\n"
                            }
                        ]
                    },
                    {
                        "type": "rich_text_preformatted",
                        "elements": [
                            {
                                "type": "text",
                                "text": "import betfairutil as bu\n\nfor path_to_file in files:\n    last_extract_time = 0\n    previous_market_book = None\n    for market_book in bu.create_market_book_generator_from_prices_file(path_to_file):\n        # Calculate time since last extract time\n        if time_since_last_extract_time >= # 10 minutes\n            df = bu.market_book_to_data_frame(market_book, ...)\n            df.to_csv(...)  # Save to CSV here or append and write at the end\n            last_extract_time = market_book[\"publishTime\"]\n        elif previous_market_book is not None and not previous_market_book[\"inplay\"] and market_book[\"inplay\"]:\n            # Capture final pre-event market book\n            df = bu.market_book_to_data_frame(previous_market_book, ...)\n            ...\n        previous_market_book = market_book\n     # Process final market book\n     df = bu.market_book_to_data_frame(market_book, ...)"
                            }
                        ],
                        "border": 0
                    }
                ]
            }
        ]
    },
    {
        "user": "U01FQH5FA8M",
        "type": "message",
        "ts": "1675949939.230099",
        "edited": {
            "user": "U01FQH5FA8M",
            "ts": "1675950866.000000"
        },
        "client_msg_id": "dbe07a03-29d9-4e6f-b57f-21eab5998893",
        "text": "I was just looking at the horse Ivetwiggedit which won the 13:05 at Doncaster just now. My system suggested that it had no hope whatsoever. I just had a look at the <https:\/\/www.sportinglife.com\/racing\/racecards\/2023-02-09\/doncaster\/racecard\/724448\/virgin-bet-conditional-jockeys-handicap-hurdle|pre race comment on Sporting Life> and saw that it said \"Well held in bumper\/trio of mares' novice hurdles during 2021\/22 for Ben Pauling...\" - can anyone tell me what that means? \"Well held\"?",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "c2ad96dd9f4b",
            "image_72": "https:\/\/avatars.slack-edge.com\/2020-11-30\/1550305177569_c2ad96dd9f4b70daf43d_72.jpg",
            "first_name": "Michael",
            "real_name": "Michael Reiss",
            "display_name": "Mick",
            "team": "T4G9NBD2M",
            "name": "reissgo",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1675949939.230099",
        "reply_count": 1,
        "reply_users_count": 1,
        "latest_reply": "1675952489.587009",
        "reply_users": [
            "U02RN7YDRQ9"
        ],
        "replies": [
            {
                "user": "U02RN7YDRQ9",
                "ts": "1675952489.587009"
            }
        ],
        "is_locked": false,
        "subscribed": false,
        "attachments": [
            {
                "from_url": "https:\/\/www.sportinglife.com\/racing\/racecards\/2023-02-09\/doncaster\/racecard\/724448\/virgin-bet-conditional-jockeys-handicap-hurdle",
                "service_icon": "https:\/\/www.sportinglife.com\/favicon-16x16.png",
                "id": 1,
                "original_url": "https:\/\/www.sportinglife.com\/racing\/racecards\/2023-02-09\/doncaster\/racecard\/724448\/virgin-bet-conditional-jockeys-handicap-hurdle",
                "fallback": "13:05 Doncaster - 9 February 2023 - Racecard - Horse Racing - Sporting Life",
                "text": "Virgin Bet Conditional Jockeys' Handicap Hurdle racecard with form, betting forecast and the Sporting Life verdict",
                "title": "13:05 Doncaster - 9 February 2023 - Racecard - Horse Racing - Sporting Life",
                "title_link": "https:\/\/www.sportinglife.com\/racing\/racecards\/2023-02-09\/doncaster\/racecard\/724448\/virgin-bet-conditional-jockeys-handicap-hurdle",
                "service_name": "sportinglife.com"
            }
        ],
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "kDu",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "I was just looking at the horse Ivetwiggedit which won the 13:05 at Doncaster just now. My system suggested that it had no hope whatsoever. I just had a look at the "
                            },
                            {
                                "type": "link",
                                "url": "https:\/\/www.sportinglife.com\/racing\/racecards\/2023-02-09\/doncaster\/racecard\/724448\/virgin-bet-conditional-jockeys-handicap-hurdle",
                                "text": "pre race comment on Sporting Life"
                            },
                            {
                                "type": "text",
                                "text": " and saw that it said \"Well held in bumper\/trio of mares' novice hurdles during 2021\/22 for Ben Pauling...\" - can anyone tell me what that means? \"Well held\"?"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U02RN7YDRQ9",
        "type": "message",
        "ts": "1675952489.587009",
        "client_msg_id": "db9900ad-1a07-45fd-9386-7ae239652cce",
        "text": "\"easily beaten\" i think - same as your system presumably recognized based on past form and \/ or prices. The clue however was in the next sentence in the TF comments \"Has since switched yards ahead of this handicap debut and worth a check in the betting for positive vibes.\" Maybe the TF suggested SP of 5.5 should have made your system scratch it's head a bit ?",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "ge46f1f8b708",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/e46f1f8b708a630e3191de7b2c42b1d1.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0023-72.png",
            "first_name": "edblock",
            "real_name": "edblock",
            "display_name": "foxwood",
            "team": "T4G9NBD2M",
            "name": "eanb",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1675949939.230099",
        "parent_user_id": "U01FQH5FA8M",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "y+r",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "\"easily beaten\" i think - same as your system presumably recognized based on past form and \/ or prices. The clue however was in the next sentence in the TF comments \"Has since switched yards ahead of this handicap debut and worth a check in the betting for positive vibes.\" Maybe the TF suggested SP of 5.5 should have made your system scratch it's head a bit ?"
                            }
                        ]
                    }
                ]
            }
        ],
        "reactions": [
            {
                "name": "+1",
                "users": [
                    "U01FQH5FA8M"
                ],
                "count": 1
            }
        ]
    },
    {
        "user": "U80AMMRKP",
        "type": "message",
        "ts": "1675959305.720849",
        "client_msg_id": "418670e2-4590-416a-9699-3745af06caa3",
        "text": "<https:\/\/www.betfairhistoricdata.co.uk\/>",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "g09081be09e4",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/709081be09e4187898ec0e3540c4bb49.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0004-72.png",
            "first_name": "J",
            "real_name": "J",
            "display_name": "Gooat",
            "team": "T4G9NBD2M",
            "name": "maunders.abie",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1675945261.759839",
        "parent_user_id": "U03CL4F39M4",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "LsY",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "link",
                                "url": "https:\/\/www.betfairhistoricdata.co.uk\/"
                            }
                        ]
                    }
                ]
            }
        ]
    }
]