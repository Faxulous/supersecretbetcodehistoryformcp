[
    {
        "user": "U01C12ZEADQ",
        "type": "message",
        "ts": "1650871815.899569",
        "client_msg_id": "1f0b117f-e98c-4341-8805-510a66fda60f",
        "text": "So, as the post says, move to AU\/NZ?;-)",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "e3b7687b0ef8",
            "image_72": "https:\/\/avatars.slack-edge.com\/2020-10-06\/1432945617648_e3b7687b0ef86e4f28b8_72.png",
            "first_name": "Alessio",
            "real_name": "Alessio",
            "display_name": "Alessio",
            "team": "T4G9NBD2M",
            "name": "alessio",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1650815421.754849",
        "parent_user_id": "U0128E7BEHW",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "bI3",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "So, as the post says, move to AU\/NZ?;-)"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U0128E7BEHW",
        "type": "message",
        "ts": "1650871946.229399",
        "client_msg_id": "b17ad7e2-698f-45d6-817a-4d5e867b0248",
        "text": "I rmemeber a post from maybe last year on here of someone doing the opposite primarily for better exchange liquidity haha",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "gb57a2bdd15a",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/b57a2bdd15acccdb845ce257f38940cc.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png",
            "first_name": "Dave",
            "real_name": "Dave R",
            "display_name": "Dave",
            "team": "T4G9NBD2M",
            "name": "d7m",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1650815421.754849",
        "parent_user_id": "U0128E7BEHW",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "sm66z",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "I rmemeber a post from maybe last year on here of someone doing the opposite primarily for better exchange liquidity haha"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U4H19D1D2",
        "type": "message",
        "ts": "1650873314.338769",
        "client_msg_id": "f72a4ba6-23a0-4ea3-a012-d569b6943a94",
        "text": "Tbh they are both bad, the top one is very bad (likely CPU exhaustion) whereas the bottom is more likely to be a temporary network issue",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "137c5a3ef323",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-03-15\/6819395173841_137c5a3ef323f1944a1a_72.png",
            "first_name": "liam",
            "real_name": "liam",
            "display_name": "liam",
            "team": "T4G9NBD2M",
            "name": "liam",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1650804386.760549",
        "parent_user_id": "UFTBRB3F1",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "ouv",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Tbh they are both bad, the top one is very bad (likely CPU exhaustion) whereas the bottom is more likely to be a temporary network issue"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "UFTBRB3F1",
        "type": "message",
        "ts": "1650875226.957999",
        "client_msg_id": "d3a38e0d-e0aa-497a-8923-af0e94e61d9e",
        "text": "The top one interestingly I have discovered somehow only ever occurs on markets where I've used middleware to pull in historic orders...so need to have a look at that some more it seems!!",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "g771e110be94",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/a771e110be945b86bede9d5c1bb551e3.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png",
            "first_name": "",
            "real_name": "Newbie99",
            "display_name": "",
            "team": "T4G9NBD2M",
            "name": "vjmehra",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1650804386.760549",
        "parent_user_id": "UFTBRB3F1",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "9BZ",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "The top one interestingly I have discovered somehow only ever occurs on markets where I've used middleware to pull in historic orders...so need to have a look at that some more it seems!!"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U4H19D1D2",
        "type": "message",
        "ts": "1650875264.155109",
        "client_msg_id": "8b074eab-12b4-44d5-bdd3-3103a3a225cb",
        "text": "oh that is interesting, there must be a leak somewhere",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "137c5a3ef323",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-03-15\/6819395173841_137c5a3ef323f1944a1a_72.png",
            "first_name": "liam",
            "real_name": "liam",
            "display_name": "liam",
            "team": "T4G9NBD2M",
            "name": "liam",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1650804386.760549",
        "parent_user_id": "UFTBRB3F1",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "P7v",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "oh that is interesting, there must be a leak somewhere"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U4H19D1D2",
        "type": "message",
        "ts": "1650875281.757439",
        "client_msg_id": "a293f2e2-f934-4caa-8a40-a1f02d5f1d0f",
        "text": "60s is really bad!",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "137c5a3ef323",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-03-15\/6819395173841_137c5a3ef323f1944a1a_72.png",
            "first_name": "liam",
            "real_name": "liam",
            "display_name": "liam",
            "team": "T4G9NBD2M",
            "name": "liam",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1650804386.760549",
        "parent_user_id": "UFTBRB3F1",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "1rSj",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "60s is really bad!"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "UFTBRB3F1",
        "type": "message",
        "ts": "1650875292.857109",
        "client_msg_id": "9fb57e0c-464d-4ad8-abf4-d691b663d586",
        "text": "It gets worse, ha!",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "g771e110be94",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/a771e110be945b86bede9d5c1bb551e3.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png",
            "first_name": "",
            "real_name": "Newbie99",
            "display_name": "",
            "team": "T4G9NBD2M",
            "name": "vjmehra",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1650804386.760549",
        "parent_user_id": "UFTBRB3F1",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "7FBXF",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "It gets worse, ha!"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "UFTBRB3F1",
        "type": "message",
        "ts": "1650875301.587529",
        "client_msg_id": "0ea6dd7c-51f3-4a6b-8d2c-bd871e2c421a",
        "text": "It just carries on so definitely a leak",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "g771e110be94",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/a771e110be945b86bede9d5c1bb551e3.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png",
            "first_name": "",
            "real_name": "Newbie99",
            "display_name": "",
            "team": "T4G9NBD2M",
            "name": "vjmehra",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1650804386.760549",
        "parent_user_id": "UFTBRB3F1",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "odP",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "It just carries on so definitely a leak"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "UFTBRB3F1",
        "type": "message",
        "ts": "1650875306.279619",
        "client_msg_id": "be822f6b-16da-420e-9c8b-34ec437aa980",
        "text": "But haven't found it yet",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "g771e110be94",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/a771e110be945b86bede9d5c1bb551e3.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png",
            "first_name": "",
            "real_name": "Newbie99",
            "display_name": "",
            "team": "T4G9NBD2M",
            "name": "vjmehra",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1650804386.760549",
        "parent_user_id": "UFTBRB3F1",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "DLi",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "But haven't found it yet"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "UFTBRB3F1",
        "type": "message",
        "ts": "1650875315.915149",
        "client_msg_id": "29a749c4-2306-4e18-b224-8888c48e5739",
        "text": "But at least now I think I know where to focus on",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "g771e110be94",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/a771e110be945b86bede9d5c1bb551e3.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png",
            "first_name": "",
            "real_name": "Newbie99",
            "display_name": "",
            "team": "T4G9NBD2M",
            "name": "vjmehra",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1650804386.760549",
        "parent_user_id": "UFTBRB3F1",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "ZGBz0",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "But at least now I think I know where to focus on"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U4H19D1D2",
        "type": "message",
        "ts": "1650875322.944599",
        "client_msg_id": "34e1a47e-c2fb-4ada-a455-681cb4f87837",
        "text": "Have you modified the middleware? \/ can you share it exactly?",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "137c5a3ef323",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-03-15\/6819395173841_137c5a3ef323f1944a1a_72.png",
            "first_name": "liam",
            "real_name": "liam",
            "display_name": "liam",
            "team": "T4G9NBD2M",
            "name": "liam",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1650804386.760549",
        "parent_user_id": "UFTBRB3F1",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "K80",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Have you modified the middleware? \/ can you share it exactly?"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "UFTBRB3F1",
        "type": "message",
        "ts": "1650875327.821449",
        "client_msg_id": "928ea23f-3876-4391-b90b-d75957cd419d",
        "text": "Yeah sure",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "g771e110be94",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/a771e110be945b86bede9d5c1bb551e3.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png",
            "first_name": "",
            "real_name": "Newbie99",
            "display_name": "",
            "team": "T4G9NBD2M",
            "name": "vjmehra",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1650804386.760549",
        "parent_user_id": "UFTBRB3F1",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "hBE",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Yeah sure"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "UFTBRB3F1",
        "type": "message",
        "ts": "1650875380.178139",
        "client_msg_id": "6ed5272d-a2a4-442f-bda1-fee57da4b733",
        "text": "```import logging\nfrom flumine import config\nfrom flumine.utils import STRATEGY_NAME_HASH_LENGTH\nfrom flumine.markets.middleware import Middleware\nfrom flumine.order.trade import Trade\nfrom misc_functions import get_utc_time\nfrom datetime import datetime\nimport pytz\n\nlogger = logging.getLogger(__name__)\n\n\nclass OrdersMiddleware(Middleware):\n    \"\"\"\n    Middleware to add execution complete orders\n    to the blotter. This is required on a restart\n    as the order stream does not include\n    EXECUTION_COMPLETE orders\n    \"\"\"\n\n    def __init__(self, flumine):\n        self.flumine = flumine\n\n    def add_market(self, market) -&gt; None:\n        ''' This checks each market, subject to the below filters (if the check is True then it will call list_current_orders) '''\n\n        ''' Checks to see if the market is politics (2378961) or if it is due to start within the next 20 mins for others...hardcoded, may need to change.'''\n        if market.seconds_to_start &lt;= 1200 or str(market.event_type_id) == str(2378961):\n\n            ''' Calls list_current_orders and loops through if there are more than 1000 '''\n            current_order_list = get_current_orders_flumine(self, 'ALL', market=market, all_market_orders=True)\n\n            ''' If the output of current_order_list is non zero then checks the market_book to get runner info to use later...if the market_book hasn't loaded makes\n             a call to the API to get the latest market_book'''\n            if len(current_order_list) &gt; 0:\n                if market.market_book is None:\n                    market_book = self.flumine.clients.get_betfair_default().betting_client.betting.list_market_book(market_ids=[market.market_id])[0]\n                    # market_book = self.flumine.client.betting_client.betting.list_market_book(market_ids=[market.market_id])[0]\n                else:\n                    market_book = market.market_book\n\n                ''' Creates a list of Active runners (so that non-active runners are not included later when orders are created) '''\n                runner_list = [(str(runner.selection_id), str(float(runner.handicap))) for runner in market_book.runners if runner.status == 'ACTIVE']\n                for current_order in current_order_list:\n                    if (str(current_order.selection_id), str(float(current_order.handicap))) in runner_list:\n                        if current_order.customer_strategy_ref != config.hostname or current_order.status not in ['EXECUTABLE']:\n                            if str(current_order.bet_id) not in [str(o.bet_id) for o in market.blotter]:\n                                <http:\/\/logger.info|logger.info>(\n                                    \"OrdersMiddleware: Processing order {0}\".format(current_order.bet_id),\n                                    extra={\n                                        \"bet_id\": current_order.bet_id,\n                                        \"market_id\": current_order.market_id,\n                                        \"customer_strategy_ref\": current_order.customer_strategy_ref,\n                                        \"customer_order_ref\": current_order.customer_order_ref,\n                                    },\n                                )\n                                order = self._create_order_from_current(current_order, market)\n                                if order:\n                                    order.update_current_order(current_order)\n                                    if current_order.status == \"EXECUTION_COMPLETE\":\n                                        order.execution_complete()\n                                    else:\n                                        # if order.bet_id not in [o.bet_id for o in market.blotter]:\n                                        order.executable()\n                                    # order.execution_complete()\n\n        ''' Adds flag to market.context, so market is not processed until all orders added '''\n        if 'order_startup_process_time' in market.context.keys():\n            market.context.update({'order_startup_process_time': get_utc_time()})\n        else:\n            market.context['order_startup_process_time'] = get_utc_time()\n\n    def _create_order_from_current(self, current_order, market):\n        ''' Some legacy Politics markets had manual orders, this assigns a strategy to them '''\n        legacy_market_id_list = ['1.160740937',\n                                 '1.129176457',\n                                 '1.160683973',\n                                 '1.160843673',\n                                 '1.176878927',\n                                 '1.166577732',\n                                 '1.160663234',\n                                 '1.167249009'\n                                 ]\n        # strategy_name_hash = current_order.customer_order_ref[\n        #     :STRATEGY_NAME_HASH_LENGTH\n        # ]\n        # order_id = current_order.customer_order_ref[STRATEGY_NAME_HASH_LENGTH + 1 :]\n        if current_order.market_id in legacy_market_id_list:\n            if current_order.side == 'BACK':\n                strategy_name_hash = 'd0df7e7076e65'\n            else:\n                strategy_name_hash = '3203239236f2d'\n            order_id = current_order.bet_id\n        else:\n            strategy_name_hash = current_order.customer_order_ref[\n                                 :STRATEGY_NAME_HASH_LENGTH\n                                 ]\n\n            order_id = current_order.customer_order_ref[STRATEGY_NAME_HASH_LENGTH + 1:]\n            # Had to put this in, so that replace orders were picked up correctly (otherwise it thinks they are already in the blotter and doesn't add the latest)\n            # order_id = current_order.bet_id\n        # get strategy\n        strategy = self.flumine.strategies.hashes.get(strategy_name_hash)\n        if strategy is None:\n            logger.warning(\n                \"OrdersMiddleware: Strategy not available to create order {0}\".format(\n                    order_id\n                ),\n                extra={\n                    \"bet_id\": current_order.bet_id,\n                    \"market_id\": current_order.market_id,\n                    \"customer_strategy_ref\": current_order.customer_strategy_ref,\n                    \"customer_order_ref\": current_order.customer_order_ref,\n                    \"strategy_name\": str(strategy),\n                },\n            )\n            return\n        # add trade\/order\n        trade = Trade(\n            market.market_id,\n            current_order.selection_id,\n            current_order.handicap,\n            strategy,\n        )\n\n        order = trade.create_order_from_current(client=self.flumine.clients.get_betfair_default(), current_order=current_order, order_id=order_id)\n        market.blotter[order.id] = order\n        runner_context = strategy.get_runner_context(*order.lookup)\n        runner_context.place(trade.id)\n        <http:\/\/logger.info|logger.info>(\n            \"OrdersMiddleware: New order trade created\",\n            extra={\n                \"bet_id\": current_order.bet_id,\n                \"market_id\": current_order.market_id,\n                \"customer_strategy_ref\": current_order.customer_strategy_ref,\n                \"customer_order_ref\": current_order.customer_order_ref,\n                \"strategy_name\": str(strategy),\n            },\n        )\n        return order\n\ndef get_current_orders_flumine(self, order_status, market=False, all_market_orders=True):\n    start_record = 0\n    complete_order_list = []\n    if market is not False:\n        market_ids = [market.market_id]\n    else:\n        market_ids = None\n\n    if all_market_orders is True:\n        strategy_ref = None\n    else:\n        strategy_ref = [config.hostname]\n\n    while True:\n        # market_orders = self.flumine.client.betting_client.betting.list_current_orders(\n        market_orders = self.flumine.clients.get_betfair_default().betting_client.betting.list_current_orders(\n            market_ids=market_ids,\n            customer_strategy_refs=strategy_ref,\n            order_projection=order_status,\n            from_record=start_record)\n        complete_order_list.extend(market_orders.orders)\n        start_record +=1000\n        if not market_orders.more_available is True:\n            break\n    return complete_order_list```",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "g771e110be94",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/a771e110be945b86bede9d5c1bb551e3.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png",
            "first_name": "",
            "real_name": "Newbie99",
            "display_name": "",
            "team": "T4G9NBD2M",
            "name": "vjmehra",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1650804386.760549",
        "parent_user_id": "UFTBRB3F1",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "\/zBl",
                "elements": [
                    {
                        "type": "rich_text_preformatted",
                        "elements": [
                            {
                                "type": "text",
                                "text": "import logging\nfrom flumine import config\nfrom flumine.utils import STRATEGY_NAME_HASH_LENGTH\nfrom flumine.markets.middleware import Middleware\nfrom flumine.order.trade import Trade\nfrom misc_functions import get_utc_time\nfrom datetime import datetime\nimport pytz\n\nlogger = logging.getLogger(__name__)\n\n\nclass OrdersMiddleware(Middleware):\n    \"\"\"\n    Middleware to add execution complete orders\n    to the blotter. This is required on a restart\n    as the order stream does not include\n    EXECUTION_COMPLETE orders\n    \"\"\"\n\n    def __init__(self, flumine):\n        self.flumine = flumine\n\n    def add_market(self, market) -> None:\n        ''' This checks each market, subject to the below filters (if the check is True then it will call list_current_orders) '''\n\n        ''' Checks to see if the market is politics (2378961) or if it is due to start within the next 20 mins for others...hardcoded, may need to change.'''\n        if market.seconds_to_start <= 1200 or str(market.event_type_id) == str(2378961):\n\n            ''' Calls list_current_orders and loops through if there are more than 1000 '''\n            current_order_list = get_current_orders_flumine(self, 'ALL', market=market, all_market_orders=True)\n\n            ''' If the output of current_order_list is non zero then checks the market_book to get runner info to use later...if the market_book hasn't loaded makes\n             a call to the API to get the latest market_book'''\n            if len(current_order_list) > 0:\n                if market.market_book is None:\n                    market_book = self.flumine.clients.get_betfair_default().betting_client.betting.list_market_book(market_ids=[market.market_id])[0]\n                    # market_book = self.flumine.client.betting_client.betting.list_market_book(market_ids=[market.market_id])[0]\n                else:\n                    market_book = market.market_book\n\n                ''' Creates a list of Active runners (so that non-active runners are not included later when orders are created) '''\n                runner_list = [(str(runner.selection_id), str(float(runner.handicap))) for runner in market_book.runners if runner.status == 'ACTIVE']\n                for current_order in current_order_list:\n                    if (str(current_order.selection_id), str(float(current_order.handicap))) in runner_list:\n                        if current_order.customer_strategy_ref != config.hostname or current_order.status not in ['EXECUTABLE']:\n                            if str(current_order.bet_id) not in [str(o.bet_id) for o in market.blotter]:\n                                logger.info(\n                                    \"OrdersMiddleware: Processing order {0}\".format(current_order.bet_id),\n                                    extra={\n                                        \"bet_id\": current_order.bet_id,\n                                        \"market_id\": current_order.market_id,\n                                        \"customer_strategy_ref\": current_order.customer_strategy_ref,\n                                        \"customer_order_ref\": current_order.customer_order_ref,\n                                    },\n                                )\n                                order = self._create_order_from_current(current_order, market)\n                                if order:\n                                    order.update_current_order(current_order)\n                                    if current_order.status == \"EXECUTION_COMPLETE\":\n                                        order.execution_complete()\n                                    else:\n                                        # if order.bet_id not in [o.bet_id for o in market.blotter]:\n                                        order.executable()\n                                    # order.execution_complete()\n\n        ''' Adds flag to market.context, so market is not processed until all orders added '''\n        if 'order_startup_process_time' in market.context.keys():\n            market.context.update({'order_startup_process_time': get_utc_time()})\n        else:\n            market.context['order_startup_process_time'] = get_utc_time()\n\n    def _create_order_from_current(self, current_order, market):\n        ''' Some legacy Politics markets had manual orders, this assigns a strategy to them '''\n        legacy_market_id_list = ['1.160740937',\n                                 '1.129176457',\n                                 '1.160683973',\n                                 '1.160843673',\n                                 '1.176878927',\n                                 '1.166577732',\n                                 '1.160663234',\n                                 '1.167249009'\n                                 ]\n        # strategy_name_hash = current_order.customer_order_ref[\n        #     :STRATEGY_NAME_HASH_LENGTH\n        # ]\n        # order_id = current_order.customer_order_ref[STRATEGY_NAME_HASH_LENGTH + 1 :]\n        if current_order.market_id in legacy_market_id_list:\n            if current_order.side == 'BACK':\n                strategy_name_hash = 'd0df7e7076e65'\n            else:\n                strategy_name_hash = '3203239236f2d'\n            order_id = current_order.bet_id\n        else:\n            strategy_name_hash = current_order.customer_order_ref[\n                                 :STRATEGY_NAME_HASH_LENGTH\n                                 ]\n\n            order_id = current_order.customer_order_ref[STRATEGY_NAME_HASH_LENGTH + 1:]\n            # Had to put this in, so that replace orders were picked up correctly (otherwise it thinks they are already in the blotter and doesn't add the latest)\n            # order_id = current_order.bet_id\n        # get strategy\n        strategy = self.flumine.strategies.hashes.get(strategy_name_hash)\n        if strategy is None:\n            logger.warning(\n                \"OrdersMiddleware: Strategy not available to create order {0}\".format(\n                    order_id\n                ),\n                extra={\n                    \"bet_id\": current_order.bet_id,\n                    \"market_id\": current_order.market_id,\n                    \"customer_strategy_ref\": current_order.customer_strategy_ref,\n                    \"customer_order_ref\": current_order.customer_order_ref,\n                    \"strategy_name\": str(strategy),\n                },\n            )\n            return\n        # add trade\/order\n        trade = Trade(\n            market.market_id,\n            current_order.selection_id,\n            current_order.handicap,\n            strategy,\n        )\n\n        order = trade.create_order_from_current(client=self.flumine.clients.get_betfair_default(), current_order=current_order, order_id=order_id)\n        market.blotter[order.id] = order\n        runner_context = strategy.get_runner_context(*order.lookup)\n        runner_context.place(trade.id)\n        logger.info(\n            \"OrdersMiddleware: New order trade created\",\n            extra={\n                \"bet_id\": current_order.bet_id,\n                \"market_id\": current_order.market_id,\n                \"customer_strategy_ref\": current_order.customer_strategy_ref,\n                \"customer_order_ref\": current_order.customer_order_ref,\n                \"strategy_name\": str(strategy),\n            },\n        )\n        return order\n\ndef get_current_orders_flumine(self, order_status, market=False, all_market_orders=True):\n    start_record = 0\n    complete_order_list = []\n    if market is not False:\n        market_ids = [market.market_id]\n    else:\n        market_ids = None\n\n    if all_market_orders is True:\n        strategy_ref = None\n    else:\n        strategy_ref = [config.hostname]\n\n    while True:\n        # market_orders = self.flumine.client.betting_client.betting.list_current_orders(\n        market_orders = self.flumine.clients.get_betfair_default().betting_client.betting.list_current_orders(\n            market_ids=market_ids,\n            customer_strategy_refs=strategy_ref,\n            order_projection=order_status,\n            from_record=start_record)\n        complete_order_list.extend(market_orders.orders)\n        start_record +=1000\n        if not market_orders.more_available is True:\n            break\n    return complete_order_list"
                            }
                        ],
                        "border": 0
                    }
                ]
            }
        ]
    },
    {
        "user": "UFTBRB3F1",
        "type": "message",
        "ts": "1650875415.968349",
        "client_msg_id": "ae20c668-7aca-4ceb-9088-45c0267f58ac",
        "text": "I have modified it (trying to remember why now), I think it is because for some legacy markets I have orders that were non Flumine created and I want to capture those too",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "g771e110be94",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/a771e110be945b86bede9d5c1bb551e3.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png",
            "first_name": "",
            "real_name": "Newbie99",
            "display_name": "",
            "team": "T4G9NBD2M",
            "name": "vjmehra",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1650804386.760549",
        "parent_user_id": "UFTBRB3F1",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "YsD",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "I have modified it (trying to remember why now), I think it is because for some legacy markets I have orders that were non Flumine created and I want to capture those too"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U01HQ97J5HA",
        "type": "message",
        "ts": "1650880251.538169",
        "client_msg_id": "b5dc22d2-4741-454d-a667-d1123f8fdebe",
        "text": "Star Sports have uploaded part 1 of a 5 part interview with Patrick Veitch:\n\n<https:\/\/www.youtube.com\/watch?v=WHnQhuug0J4&amp;ab_channel=StarSports>",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "32438a94ff5b",
            "image_72": "https:\/\/avatars.slack-edge.com\/2020-12-23\/1596357610883_32438a94ff5b8841a65e_72.jpg",
            "first_name": "Christopher",
            "real_name": "Christopher Croft",
            "display_name": "Crofty",
            "team": "T4G9NBD2M",
            "name": "telephoneprospector",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1650880251.538169",
        "reply_count": 1,
        "reply_users_count": 1,
        "latest_reply": "1650900140.406419",
        "reply_users": [
            "UCQB6S222"
        ],
        "replies": [
            {
                "user": "UCQB6S222",
                "ts": "1650900140.406419"
            }
        ],
        "is_locked": false,
        "subscribed": false,
        "attachments": [
            {
                "from_url": "https:\/\/www.youtube.com\/watch?v=WHnQhuug0J4&amp;ab_channel=StarSports",
                "thumb_url": "https:\/\/i.ytimg.com\/vi\/WHnQhuug0J4\/hqdefault.jpg",
                "thumb_width": 480,
                "thumb_height": 360,
                "video_html": "<iframe width=\"400\" height=\"225\" src=\"https:\/\/www.youtube.com\/embed\/WHnQhuug0J4?feature=oembed&autoplay=1&iv_load_policy=3\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen><\/iframe>",
                "video_html_width": 400,
                "video_html_height": 225,
                "service_icon": "https:\/\/a.slack-edge.com\/80588\/img\/unfurl_icons\/youtube.png",
                "id": 1,
                "original_url": "https:\/\/www.youtube.com\/watch?v=WHnQhuug0J4&amp;ab_channel=StarSports",
                "fallback": "YouTube Video: #BettingPeople Interview PATRICK VEITCH Professional Punter 1\/5",
                "title": "#BettingPeople Interview PATRICK VEITCH Professional Punter 1\/5",
                "title_link": "https:\/\/www.youtube.com\/watch?v=WHnQhuug0J4&amp;ab_channel=StarSports",
                "author_name": "Star Sports",
                "author_link": "https:\/\/www.youtube.com\/user\/StarSportsBettingTV",
                "service_name": "YouTube",
                "service_url": "https:\/\/www.youtube.com\/"
            }
        ],
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "5B97o",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Star Sports have uploaded part 1 of a 5 part interview with Patrick Veitch:\n\n"
                            },
                            {
                                "type": "link",
                                "url": "https:\/\/www.youtube.com\/watch?v=WHnQhuug0J4&ab_channel=StarSports"
                            }
                        ]
                    }
                ]
            }
        ],
        "reactions": [
            {
                "name": "+1",
                "users": [
                    "U4H19D1D2"
                ],
                "count": 1
            }
        ]
    },
    {
        "user": "U4H19D1D2",
        "type": "message",
        "ts": "1650881150.270349",
        "edited": {
            "user": "U4H19D1D2",
            "ts": "1650881163.000000"
        },
        "client_msg_id": "39f3d0a7-e99c-419e-8bb4-5ab575f0e0eb",
        "text": "Just to confirm you don't have anything that is causing a market to be constantly re-added so this is being called more than once per market? ie. lots of these logs\n\n```OrdersMiddleware: Processing order..```\nHow many orders roughly per market?",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "137c5a3ef323",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-03-15\/6819395173841_137c5a3ef323f1944a1a_72.png",
            "first_name": "liam",
            "real_name": "liam",
            "display_name": "liam",
            "team": "T4G9NBD2M",
            "name": "liam",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1650804386.760549",
        "parent_user_id": "UFTBRB3F1",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "QUO",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Just to confirm you don't have anything that is causing a market to be constantly re-added so this is being called more than once per market? ie. lots of these logs\n\n"
                            }
                        ]
                    },
                    {
                        "type": "rich_text_preformatted",
                        "elements": [
                            {
                                "type": "text",
                                "text": "OrdersMiddleware: Processing order.."
                            }
                        ],
                        "border": 0
                    },
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "\nHow many orders roughly per market?"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "UFTBRB3F1",
        "type": "message",
        "ts": "1650881194.863189",
        "client_msg_id": "fbb28da2-2a62-4a71-a84f-bdb1383afbd1",
        "text": "I don't believe so, nothing I can see that would cause a market to be re-added.",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "g771e110be94",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/a771e110be945b86bede9d5c1bb551e3.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png",
            "first_name": "",
            "real_name": "Newbie99",
            "display_name": "",
            "team": "T4G9NBD2M",
            "name": "vjmehra",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1650804386.760549",
        "parent_user_id": "UFTBRB3F1",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "wYH",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "I don't believe so, nothing I can see that would cause a market to be re-added."
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "UFTBRB3F1",
        "type": "message",
        "ts": "1650881245.364989",
        "client_msg_id": "6b0709ec-a453-44d1-8f72-1942b6d4b87e",
        "text": "In terms of orders, it can be &gt;1000, however that doesn't seem to be the issue as for 1.182979902 I only have a handful and the latency warnings start almost straight away.",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "g771e110be94",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/a771e110be945b86bede9d5c1bb551e3.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png",
            "first_name": "",
            "real_name": "Newbie99",
            "display_name": "",
            "team": "T4G9NBD2M",
            "name": "vjmehra",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1650804386.760549",
        "parent_user_id": "UFTBRB3F1",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "xKMqh",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "In terms of orders, it can be >1000, however that doesn't seem to be the issue as for 1.182979902 I only have a handful and the latency warnings start almost straight away."
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U4H19D1D2",
        "type": "message",
        "ts": "1650881273.063049",
        "client_msg_id": "e402b39d-b146-43c8-acaa-2e316da532d2",
        "text": "single process so it could be one market causing the issues",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "137c5a3ef323",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-03-15\/6819395173841_137c5a3ef323f1944a1a_72.png",
            "first_name": "liam",
            "real_name": "liam",
            "display_name": "liam",
            "team": "T4G9NBD2M",
            "name": "liam",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1650804386.760549",
        "parent_user_id": "UFTBRB3F1",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "S0J",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "single process so it could be one market causing the issues"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U4H19D1D2",
        "type": "message",
        "ts": "1650881298.694259",
        "client_msg_id": "f1194946-f9ff-4f5c-83b8-89293ab2f626",
        "text": "if you can run it with cprofilev for a few minutes and share a screenshot it should be pretty obvious what is causing it",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "137c5a3ef323",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-03-15\/6819395173841_137c5a3ef323f1944a1a_72.png",
            "first_name": "liam",
            "real_name": "liam",
            "display_name": "liam",
            "team": "T4G9NBD2M",
            "name": "liam",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1650804386.760549",
        "parent_user_id": "UFTBRB3F1",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "Q4iaV",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "if you can run it with cprofilev for a few minutes and share a screenshot it should be pretty obvious what is causing it"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "UFTBRB3F1",
        "type": "message",
        "ts": "1650881308.121529",
        "client_msg_id": "1ae2aded-7068-448a-a78d-94a998ffa177",
        "text": "It could of course be a red herring, that its to do with middleware, but it hasn't impacted any horse racing markets so I am sort of making an assumption here (horse racing markets for me don't really require the middleware as I don't need historic orders)",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "g771e110be94",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/a771e110be945b86bede9d5c1bb551e3.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png",
            "first_name": "",
            "real_name": "Newbie99",
            "display_name": "",
            "team": "T4G9NBD2M",
            "name": "vjmehra",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1650804386.760549",
        "parent_user_id": "UFTBRB3F1",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "2xeta",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "It could of course be a red herring, that its to do with middleware, but it hasn't impacted any horse racing markets so I am sort of making an assumption here (horse racing markets for me don't really require the middleware as I don't need historic orders)"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "UFTBRB3F1",
        "type": "message",
        "ts": "1650881322.384529",
        "client_msg_id": "1350415c-72c3-450f-a4d0-38501a9ccb52",
        "text": "ok cool, will try that and report back",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "g771e110be94",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/a771e110be945b86bede9d5c1bb551e3.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png",
            "first_name": "",
            "real_name": "Newbie99",
            "display_name": "",
            "team": "T4G9NBD2M",
            "name": "vjmehra",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1650804386.760549",
        "parent_user_id": "UFTBRB3F1",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "AaBS9",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "ok cool, will try that and report back"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U02RN7YDRQ9",
        "type": "message",
        "ts": "1650882377.197799",
        "client_msg_id": "ac6bc5fe-0145-4044-b456-ef08a57b75b0",
        "text": "Sadly they closed the 10 pom scheme 40 years ago :upside_down_face:",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "ge46f1f8b708",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/e46f1f8b708a630e3191de7b2c42b1d1.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0023-72.png",
            "first_name": "edblock",
            "real_name": "edblock",
            "display_name": "foxwood",
            "team": "T4G9NBD2M",
            "name": "eanb",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1650815421.754849",
        "parent_user_id": "U0128E7BEHW",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "gNev\/",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Sadly they closed the 10 pom scheme 40 years ago "
                            },
                            {
                                "type": "emoji",
                                "name": "upside_down_face",
                                "unicode": "1f643"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "UFTBRB3F1",
        "type": "message",
        "ts": "1650885276.419559",
        "client_msg_id": "c3de3b01-c8fd-49bb-943f-0d83c5b5590d",
        "text": "```53265807 function calls (53250311 primitive calls) in 151.446 seconds\n\n   Ordered by: cumulative time\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n     5682    0.076    0.000  124.859    0.022 D:\\Python37\\webpages\\place_order_functions.py:192(place_or_cancel)\n      738    0.068    0.000  124.829    0.169 D:\\Python37\\webpages\\market_making.py:19(place_passive_order)\n      341    0.007    0.000  116.552    0.342 D:\\Python38\\lib\\site-packages\\flumine\\baseflumine.py:254(_process_current_orders)\n      681    0.001    0.000  115.210    0.169 D:\\Python38\\lib\\site-packages\\flumine\\utils.py:259(call_process_orders_error_handling)\n      681    0.003    0.000  115.209    0.169 D:\\Python37\\webpages\\betting_strategy.py:32(process_orders)\n     5697   21.047    0.004   80.373    0.014 D:\\Python37\\webpages\\risk_functions.py:18(get_runner_exposure)\n     4997    0.022    0.000   43.979    0.009 D:\\Python37\\webpages\\place_order_functions.py:188(cancel_orders_by_price)\n     4997    0.014    0.000   42.767    0.009 D:\\Python37\\webpages\\place_order_functions.py:180(get_orders)\n     4997    0.541    0.000   42.754    0.009 D:\\Python37\\webpages\\place_order_functions.py:185(&lt;listcomp&gt;)\n    77775    0.790    0.000   42.540    0.001 D:\\Python37\\webpages\\place_order_functions.py:132(construct_price)\n    73587    0.095    0.000   39.810    0.001 D:\\Python37\\webpages\\place_order_functions.py:489(adjust_price_for_self_matching)\n    73587    0.390    0.000   39.715    0.001 D:\\Python37\\webpages\\validation_functions.py:425(validate_order_self_matching)\n   147174    0.484    0.000   39.253    0.000 D:\\Python37\\webpages\\validation_functions.py:465(get_order_list)\n   147174   37.736    0.000   37.736    0.000 D:\\Python37\\webpages\\validation_functions.py:474(&lt;listcomp&gt;)\n  1056788   23.509    0.000   23.509    0.000 D:\\Python37\\webpages\\risk_functions.py:33(&lt;listcomp&gt;)\n      108    0.001    0.000   21.532    0.199 D:\\Python38\\lib\\threading.py:270(wait)\n      997   21.530    0.022   21.530    0.022 {method 'acquire' of '_thread.lock' objects}\n      464    0.004    0.000   21.454    0.046 D:\\Python38\\lib\\queue.py:153(get)\n     5697    0.030    0.000   19.673    0.003 D:\\Python37\\webpages\\risk_functions.py:78(check_combined_strategy)\n     5697    3.140    0.001   19.598    0.003 D:\\Python37\\webpages\\risk_functions.py:86(&lt;listcomp&gt;)\n       50    0.002    0.000    9.686    0.194 D:\\Python38\\lib\\site-packages\\flumine\\baseflumine.py:134(_process_market_books)\n      625    0.001    0.000    9.638    0.015 D:\\Python38\\lib\\site-packages\\flumine\\utils.py:222(call_strategy_error_handling)\n       57    0.000    0.000    9.624    0.169 D:\\Python37\\webpages\\betting_strategy.py:22(process_market_book)\n  2113432    4.618    0.000    9.271    0.000 D:\\Python38\\lib\\site-packages\\flumine\\utils.py:80(create_cheap_hash)\n  8518043    4.560    0.000    8.305    0.000 D:\\Python38\\lib\\site-packages\\flumine\\order\\order.py:426(size_matched)\n  2113059    2.288    0.000    7.743    0.000 D:\\Python37\\webpages\\risk_functions.py:11(get_order_matched_exposure)\n  4291494    2.451    0.000    7.361    0.000 D:\\Python37\\webpages\\risk_functions.py:4(get_order_matched_stake)\n  2113821    3.039    0.000    5.130    0.000 D:\\Python38\\lib\\site-packages\\flumine\\order\\order.py:259(customer_order_ref)\n 10643310    4.577    0.000    4.577    0.000 D:\\Python38\\lib\\site-packages\\flumine\\order\\order.py:188(current_order)\n     5696    0.775    0.000    4.467    0.001 D:\\Python37\\webpages\\risk_functions.py:39(&lt;listcomp&gt;)\n   1391\/2    0.018    0.000    3.269    1.635 {built-in method builtins.exec}\n        1    0.000    0.000    3.269    3.269 startup.py:1(&lt;module&gt;)\n  1045\/16    0.014    0.000    3.082    0.193 &lt;frozen importlib._bootstrap&gt;:986(_find_and_load)\n  1044\/16    0.007    0.000    3.081    0.193 &lt;frozen importlib._bootstrap&gt;:956(_find_and_load_unlocked)\n  1002\/16    0.007    0.000    3.066    0.192 &lt;frozen importlib._bootstrap&gt;:650(_load_unlocked)\n   890\/16    0.005    0.000    3.065    0.192 &lt;frozen importlib._bootstrap_external&gt;:777(exec_module)\n  1348\/16    0.002    0.000    3.053    0.191 &lt;frozen importlib._bootstrap&gt;:211(_call_with_frames_removed)\n  2113432    2.341    0.000    2.341    0.000 {method 'hexdigest' of '_hashlib.HASH' objects}\n  2113469    1.233    0.000    2.061    0.000 D:\\Python38\\lib\\site-packages\\flumine\\order\\order.py:419(average_price_matched)\n      341    0.013    0.000    1.827    0.005 D:\\Python38\\lib\\site-packages\\flumine\\order\\process.py:33(process_current_orders)\n  563\/115    0.003    0.000    1.797    0.016 {built-in method builtins.__import__}\n       46    0.001    0.000    1.721    0.037 D:\\Python38\\lib\\site-packages\\flumine\\order\\process.py:93(create_order_from_current)\n        7    0.000    0.000    1.603    0.229 D:\\Python38\\lib\\site-packages\\flumine\\baseflumine.py:197(_add_market)\n        7    0.008    0.001    1.596    0.228 D:\\Python37\\webpages\\middleware_example.py:24(add_market)\n2117384\/2117380    1.525    0.000    1.525    0.000 {method 'format' of 'str' objects}\n 1227\/677    0.003    0.000    1.475    0.002 &lt;frozen importlib._bootstrap&gt;:1017(_handle_fromlist)\n     1586    0.005    0.000    1.400    0.001 D:\\Python38\\lib\\logging\\__init__.py:1553(_log)\n        1    0.000    0.000    1.335    1.335 D:\\Python37\\webpages\\orders_worker.py:1(&lt;module&gt;)\n        1    0.000    0.000    1.332    1.332 D:\\Python37\\webpages\\racing_functions.py:1(&lt;module&gt;)\n  2113432    1.331    0.000    1.331    0.000 {built-in method _hashlib.openssl_sha1}\n        1    0.000    0.000    1.325    1.325 D:\\Python37\\webpages\\import_historic_horse_data.py:1(&lt;module&gt;)\n     1586    0.002    0.000    1.308    0.001 D:\\Python38\\lib\\logging\\__init__.py:1579(handle)\n     1586    0.012    0.000    1.305    0.001 D:\\Python38\\lib\\logging\\__init__.py:1633(callHandlers)\n     4758    0.011    0.000    1.293    0.000 D:\\Python38\\lib\\logging\\__init__.py:937(handle)\n    77775    0.183    0.000    1.271    0.000 D:\\Python37\\webpages\\place_order_functions.py:222(get_base_price_source)\n     4758    0.019    0.000    1.265    0.000 D:\\Python38\\lib\\logging\\__init__.py:1069(emit)\n     1505    0.007    0.000    1.249    0.001 D:\\Python38\\lib\\logging\\__init__.py:1424(info)\n        6    0.000    0.000    1.222    0.204 D:\\Python38\\lib\\site-packages\\requests\\api.py:16(request)\n        6    0.000    0.000    1.199    0.200 D:\\Python38\\lib\\site-packages\\requests\\sessions.py:470(request)\n     4997    0.018    0.000    1.189    0.000 D:\\Python37\\webpages\\cancel_and_replace.py:33(cancel_orders)\n        6    0.000    0.000    1.111    0.185 D:\\Python38\\lib\\site-packages\\requests\\sessions.py:626(send)\n        6    0.000    0.000    1.105    0.184 D:\\Python38\\lib\\site-packages\\requests\\adapters.py:394(send)\n   153222    1.010    0.000    1.078    0.000 D:\\Python38\\lib\\site-packages\\flumine\\markets\\blotter.py:268(__iter__)\n        6    0.000    0.000    1.062    0.177 D:\\Python38\\lib\\site-packages\\urllib3\\connectionpool.py:518(urlopen)\n        6    0.000    0.000    1.058    0.176 D:\\Python38\\lib\\site-packages\\urllib3\\connectionpool.py:357(_make_request)\n        5    0.000    0.000    1.056    0.211 D:\\Python38\\lib\\site-packages\\requests\\api.py:107(post)\n        1    0.000    0.000    1.056    1.056 D:\\Python38\\lib\\site-packages\\pandas\\__init__.py:3(&lt;module&gt;)```",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "g771e110be94",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/a771e110be945b86bede9d5c1bb551e3.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png",
            "first_name": "",
            "real_name": "Newbie99",
            "display_name": "",
            "team": "T4G9NBD2M",
            "name": "vjmehra",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1650804386.760549",
        "parent_user_id": "UFTBRB3F1",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "Ook",
                "elements": [
                    {
                        "type": "rich_text_preformatted",
                        "elements": [
                            {
                                "type": "text",
                                "text": "53265807 function calls (53250311 primitive calls) in 151.446 seconds\n\n   Ordered by: cumulative time\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n     5682    0.076    0.000  124.859    0.022 D:\\Python37\\webpages\\place_order_functions.py:192(place_or_cancel)\n      738    0.068    0.000  124.829    0.169 D:\\Python37\\webpages\\market_making.py:19(place_passive_order)\n      341    0.007    0.000  116.552    0.342 D:\\Python38\\lib\\site-packages\\flumine\\baseflumine.py:254(_process_current_orders)\n      681    0.001    0.000  115.210    0.169 D:\\Python38\\lib\\site-packages\\flumine\\utils.py:259(call_process_orders_error_handling)\n      681    0.003    0.000  115.209    0.169 D:\\Python37\\webpages\\betting_strategy.py:32(process_orders)\n     5697   21.047    0.004   80.373    0.014 D:\\Python37\\webpages\\risk_functions.py:18(get_runner_exposure)\n     4997    0.022    0.000   43.979    0.009 D:\\Python37\\webpages\\place_order_functions.py:188(cancel_orders_by_price)\n     4997    0.014    0.000   42.767    0.009 D:\\Python37\\webpages\\place_order_functions.py:180(get_orders)\n     4997    0.541    0.000   42.754    0.009 D:\\Python37\\webpages\\place_order_functions.py:185(<listcomp>)\n    77775    0.790    0.000   42.540    0.001 D:\\Python37\\webpages\\place_order_functions.py:132(construct_price)\n    73587    0.095    0.000   39.810    0.001 D:\\Python37\\webpages\\place_order_functions.py:489(adjust_price_for_self_matching)\n    73587    0.390    0.000   39.715    0.001 D:\\Python37\\webpages\\validation_functions.py:425(validate_order_self_matching)\n   147174    0.484    0.000   39.253    0.000 D:\\Python37\\webpages\\validation_functions.py:465(get_order_list)\n   147174   37.736    0.000   37.736    0.000 D:\\Python37\\webpages\\validation_functions.py:474(<listcomp>)\n  1056788   23.509    0.000   23.509    0.000 D:\\Python37\\webpages\\risk_functions.py:33(<listcomp>)\n      108    0.001    0.000   21.532    0.199 D:\\Python38\\lib\\threading.py:270(wait)\n      997   21.530    0.022   21.530    0.022 {method 'acquire' of '_thread.lock' objects}\n      464    0.004    0.000   21.454    0.046 D:\\Python38\\lib\\queue.py:153(get)\n     5697    0.030    0.000   19.673    0.003 D:\\Python37\\webpages\\risk_functions.py:78(check_combined_strategy)\n     5697    3.140    0.001   19.598    0.003 D:\\Python37\\webpages\\risk_functions.py:86(<listcomp>)\n       50    0.002    0.000    9.686    0.194 D:\\Python38\\lib\\site-packages\\flumine\\baseflumine.py:134(_process_market_books)\n      625    0.001    0.000    9.638    0.015 D:\\Python38\\lib\\site-packages\\flumine\\utils.py:222(call_strategy_error_handling)\n       57    0.000    0.000    9.624    0.169 D:\\Python37\\webpages\\betting_strategy.py:22(process_market_book)\n  2113432    4.618    0.000    9.271    0.000 D:\\Python38\\lib\\site-packages\\flumine\\utils.py:80(create_cheap_hash)\n  8518043    4.560    0.000    8.305    0.000 D:\\Python38\\lib\\site-packages\\flumine\\order\\order.py:426(size_matched)\n  2113059    2.288    0.000    7.743    0.000 D:\\Python37\\webpages\\risk_functions.py:11(get_order_matched_exposure)\n  4291494    2.451    0.000    7.361    0.000 D:\\Python37\\webpages\\risk_functions.py:4(get_order_matched_stake)\n  2113821    3.039    0.000    5.130    0.000 D:\\Python38\\lib\\site-packages\\flumine\\order\\order.py:259(customer_order_ref)\n 10643310    4.577    0.000    4.577    0.000 D:\\Python38\\lib\\site-packages\\flumine\\order\\order.py:188(current_order)\n     5696    0.775    0.000    4.467    0.001 D:\\Python37\\webpages\\risk_functions.py:39(<listcomp>)\n   1391\/2    0.018    0.000    3.269    1.635 {built-in method builtins.exec}\n        1    0.000    0.000    3.269    3.269 startup.py:1(<module>)\n  1045\/16    0.014    0.000    3.082    0.193 <frozen importlib._bootstrap>:986(_find_and_load)\n  1044\/16    0.007    0.000    3.081    0.193 <frozen importlib._bootstrap>:956(_find_and_load_unlocked)\n  1002\/16    0.007    0.000    3.066    0.192 <frozen importlib._bootstrap>:650(_load_unlocked)\n   890\/16    0.005    0.000    3.065    0.192 <frozen importlib._bootstrap_external>:777(exec_module)\n  1348\/16    0.002    0.000    3.053    0.191 <frozen importlib._bootstrap>:211(_call_with_frames_removed)\n  2113432    2.341    0.000    2.341    0.000 {method 'hexdigest' of '_hashlib.HASH' objects}\n  2113469    1.233    0.000    2.061    0.000 D:\\Python38\\lib\\site-packages\\flumine\\order\\order.py:419(average_price_matched)\n      341    0.013    0.000    1.827    0.005 D:\\Python38\\lib\\site-packages\\flumine\\order\\process.py:33(process_current_orders)\n  563\/115    0.003    0.000    1.797    0.016 {built-in method builtins.__import__}\n       46    0.001    0.000    1.721    0.037 D:\\Python38\\lib\\site-packages\\flumine\\order\\process.py:93(create_order_from_current)\n        7    0.000    0.000    1.603    0.229 D:\\Python38\\lib\\site-packages\\flumine\\baseflumine.py:197(_add_market)\n        7    0.008    0.001    1.596    0.228 D:\\Python37\\webpages\\middleware_example.py:24(add_market)\n2117384\/2117380    1.525    0.000    1.525    0.000 {method 'format' of 'str' objects}\n 1227\/677    0.003    0.000    1.475    0.002 <frozen importlib._bootstrap>:1017(_handle_fromlist)\n     1586    0.005    0.000    1.400    0.001 D:\\Python38\\lib\\logging\\__init__.py:1553(_log)\n        1    0.000    0.000    1.335    1.335 D:\\Python37\\webpages\\orders_worker.py:1(<module>)\n        1    0.000    0.000    1.332    1.332 D:\\Python37\\webpages\\racing_functions.py:1(<module>)\n  2113432    1.331    0.000    1.331    0.000 {built-in method _hashlib.openssl_sha1}\n        1    0.000    0.000    1.325    1.325 D:\\Python37\\webpages\\import_historic_horse_data.py:1(<module>)\n     1586    0.002    0.000    1.308    0.001 D:\\Python38\\lib\\logging\\__init__.py:1579(handle)\n     1586    0.012    0.000    1.305    0.001 D:\\Python38\\lib\\logging\\__init__.py:1633(callHandlers)\n     4758    0.011    0.000    1.293    0.000 D:\\Python38\\lib\\logging\\__init__.py:937(handle)\n    77775    0.183    0.000    1.271    0.000 D:\\Python37\\webpages\\place_order_functions.py:222(get_base_price_source)\n     4758    0.019    0.000    1.265    0.000 D:\\Python38\\lib\\logging\\__init__.py:1069(emit)\n     1505    0.007    0.000    1.249    0.001 D:\\Python38\\lib\\logging\\__init__.py:1424(info)\n        6    0.000    0.000    1.222    0.204 D:\\Python38\\lib\\site-packages\\requests\\api.py:16(request)\n        6    0.000    0.000    1.199    0.200 D:\\Python38\\lib\\site-packages\\requests\\sessions.py:470(request)\n     4997    0.018    0.000    1.189    0.000 D:\\Python37\\webpages\\cancel_and_replace.py:33(cancel_orders)\n        6    0.000    0.000    1.111    0.185 D:\\Python38\\lib\\site-packages\\requests\\sessions.py:626(send)\n        6    0.000    0.000    1.105    0.184 D:\\Python38\\lib\\site-packages\\requests\\adapters.py:394(send)\n   153222    1.010    0.000    1.078    0.000 D:\\Python38\\lib\\site-packages\\flumine\\markets\\blotter.py:268(__iter__)\n        6    0.000    0.000    1.062    0.177 D:\\Python38\\lib\\site-packages\\urllib3\\connectionpool.py:518(urlopen)\n        6    0.000    0.000    1.058    0.176 D:\\Python38\\lib\\site-packages\\urllib3\\connectionpool.py:357(_make_request)\n        5    0.000    0.000    1.056    0.211 D:\\Python38\\lib\\site-packages\\requests\\api.py:107(post)\n        1    0.000    0.000    1.056    1.056 D:\\Python38\\lib\\site-packages\\pandas\\__init__.py:3(<module>)"
                            }
                        ],
                        "border": 0
                    }
                ]
            }
        ]
    },
    {
        "text": "or if easier",
        "files": [
            {
                "id": "F03CKQFG80N",
                "mode": "hidden_by_limit"
            }
        ],
        "upload": false,
        "user": "UFTBRB3F1",
        "display_as_bot": false,
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "YrTK",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "or if easier"
                            }
                        ]
                    }
                ]
            }
        ],
        "type": "message",
        "ts": "1650885285.738099",
        "client_msg_id": "551c7832-8e02-4636-9bfe-dfe854404488",
        "thread_ts": "1650804386.760549",
        "parent_user_id": "UFTBRB3F1"
    },
    {
        "user": "U4H19D1D2",
        "type": "message",
        "ts": "1650885458.064729",
        "client_msg_id": "0c3aa2ff-3774-4d53-ba3e-0f0dc82ba2c6",
        "text": "Looks like there are a lot of functions causing issues here, risk_functions `get_runner_exposure` is mega mega mega slow, can you click on that to see what is causing it?",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "137c5a3ef323",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-03-15\/6819395173841_137c5a3ef323f1944a1a_72.png",
            "first_name": "liam",
            "real_name": "liam",
            "display_name": "liam",
            "team": "T4G9NBD2M",
            "name": "liam",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1650804386.760549",
        "parent_user_id": "UFTBRB3F1",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "WNSd",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Looks like there are a lot of functions causing issues here, risk_functions "
                            },
                            {
                                "type": "text",
                                "text": "get_runner_exposure",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " is mega mega mega slow, can you click on that to see what is causing it?"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "text": "",
        "files": [
            {
                "id": "F03CSF2N9J7",
                "mode": "hidden_by_limit"
            }
        ],
        "upload": false,
        "user": "UFTBRB3F1",
        "display_as_bot": false,
        "type": "message",
        "ts": "1650885750.819499",
        "client_msg_id": "2cb8b5bd-fad3-4b21-a8ec-5b165234f4c4",
        "thread_ts": "1650804386.760549",
        "parent_user_id": "UFTBRB3F1"
    },
    {
        "user": "UFTBRB3F1",
        "type": "message",
        "ts": "1650885790.919389",
        "client_msg_id": "05cece66-9c9b-406b-991d-1fff589a91d9",
        "text": "So if I'm reading that correctly, its essentially saying I need to re-write that as its horrendously inefficient and causing a bottleneck?",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "g771e110be94",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/a771e110be945b86bede9d5c1bb551e3.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png",
            "first_name": "",
            "real_name": "Newbie99",
            "display_name": "",
            "team": "T4G9NBD2M",
            "name": "vjmehra",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1650804386.760549",
        "parent_user_id": "UFTBRB3F1",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "1NIFU",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "So if I'm reading that correctly, its essentially saying I need to re-write that as its horrendously inefficient and causing a bottleneck?"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U4H19D1D2",
        "type": "message",
        "ts": "1650886042.682229",
        "client_msg_id": "9698db92-3d15-4909-8f43-8d165756d559",
        "text": "fix line 33 and it will be a good start",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "137c5a3ef323",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-03-15\/6819395173841_137c5a3ef323f1944a1a_72.png",
            "first_name": "liam",
            "real_name": "liam",
            "display_name": "liam",
            "team": "T4G9NBD2M",
            "name": "liam",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1650804386.760549",
        "parent_user_id": "UFTBRB3F1",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "oABB",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "fix line 33 and it will be a good start"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "UFTBRB3F1",
        "type": "message",
        "ts": "1650886155.092129",
        "client_msg_id": "9645b5a8-f8cc-426a-a043-4bb91e315dc5",
        "text": "Okay cool, I think I see what the issue is. This is where I'm checking all orders in the market (regardless of strategy) to avoid self matching...\n\nWill have a re-write",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "g771e110be94",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/a771e110be945b86bede9d5c1bb551e3.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png",
            "first_name": "",
            "real_name": "Newbie99",
            "display_name": "",
            "team": "T4G9NBD2M",
            "name": "vjmehra",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1650804386.760549",
        "parent_user_id": "UFTBRB3F1",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "Ldji1",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Okay cool, I think I see what the issue is. This is where I'm checking all orders in the market (regardless of strategy) to avoid self matching...\n\nWill have a re-write"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U4H19D1D2",
        "type": "message",
        "ts": "1650886196.946309",
        "client_msg_id": "397D2821-C861-4C8F-8E89-B57AF8055ED8",
        "text": "Refactor or call less, the latter can be a lot more powerful if you can't easily do the former ",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "137c5a3ef323",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-03-15\/6819395173841_137c5a3ef323f1944a1a_72.png",
            "first_name": "liam",
            "real_name": "liam",
            "display_name": "liam",
            "team": "T4G9NBD2M",
            "name": "liam",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1650804386.760549",
        "parent_user_id": "UFTBRB3F1",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "8L6o",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Refactor or call less, the latter can be a lot more powerful if you can't easily do the former "
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "UFTBRB3F1",
        "type": "message",
        "ts": "1650886353.171109",
        "client_msg_id": "13dc791d-9176-489f-8610-c36271132021",
        "text": "I think the former should be possible here tbh, but will have a think if I can reduce the number of calls too",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "g771e110be94",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/a771e110be945b86bede9d5c1bb551e3.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png",
            "first_name": "",
            "real_name": "Newbie99",
            "display_name": "",
            "team": "T4G9NBD2M",
            "name": "vjmehra",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1650804386.760549",
        "parent_user_id": "UFTBRB3F1",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "cRS",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "I think the former should be possible here tbh, but will have a think if I can reduce the number of calls too"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U4H19D1D2",
        "type": "message",
        "ts": "1650887006.874189",
        "client_msg_id": "35c85f36-618f-4273-ac3b-e970ce3cf48c",
        "text": "what is `place_passive_order` ? That seems to be taking about 2 years to complete",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "137c5a3ef323",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-03-15\/6819395173841_137c5a3ef323f1944a1a_72.png",
            "first_name": "liam",
            "real_name": "liam",
            "display_name": "liam",
            "team": "T4G9NBD2M",
            "name": "liam",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1650804386.760549",
        "parent_user_id": "UFTBRB3F1",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "cH9dU",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "what is "
                            },
                            {
                                "type": "text",
                                "text": "place_passive_order",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " ? That seems to be taking about 2 years to complete"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U01EZ613ZCZ",
        "type": "message",
        "ts": "1650887037.084589",
        "client_msg_id": "33d84179-c422-47cc-b1a2-8ec3e70deb1e",
        "text": "Thanks for posting. Very interesting that he's done that.",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "gee1fd669100",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/ee1fd6691003d1a11867dc2baf04174d.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0009-72.png",
            "first_name": "",
            "real_name": "Graham",
            "display_name": "Graham",
            "team": "T4G9NBD2M",
            "name": "sharkey88",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "YqI",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Thanks for posting. Very interesting that he's done that."
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "UFTBRB3F1",
        "type": "message",
        "ts": "1650887189.075869",
        "client_msg_id": "0a6d2387-3869-4ce2-a5b1-b85e6a1c7ca7",
        "text": "Yeah I think its because when",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "g771e110be94",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/a771e110be945b86bede9d5c1bb551e3.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png",
            "first_name": "",
            "real_name": "Newbie99",
            "display_name": "",
            "team": "T4G9NBD2M",
            "name": "vjmehra",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1650804386.760549",
        "parent_user_id": "UFTBRB3F1",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "e+0",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Yeah I think its because when"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "UFTBRB3F1",
        "type": "message",
        "ts": "1650887217.236339",
        "client_msg_id": "7e3dfd84-9deb-447e-81b4-bc5126b61852",
        "text": "my exposure check is really inefficient, so it tries to call the get_exposure function each time and that really slows it down",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "g771e110be94",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/a771e110be945b86bede9d5c1bb551e3.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png",
            "first_name": "",
            "real_name": "Newbie99",
            "display_name": "",
            "team": "T4G9NBD2M",
            "name": "vjmehra",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1650804386.760549",
        "parent_user_id": "UFTBRB3F1",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "QWNs",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "my exposure check is really inefficient, so it tries to call the get_exposure function each time and that really slows it down"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "UFTBRB3F1",
        "type": "message",
        "ts": "1650887280.747379",
        "client_msg_id": "a7b93a85-0d1a-4ada-b7d5-e976a0e01950",
        "text": "I can see a fairly obvious improvement straight away, there is at least one (possibly more) superflous loop, which is going to cause huge slowdown I'd image",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "g771e110be94",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/a771e110be945b86bede9d5c1bb551e3.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png",
            "first_name": "",
            "real_name": "Newbie99",
            "display_name": "",
            "team": "T4G9NBD2M",
            "name": "vjmehra",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1650804386.760549",
        "parent_user_id": "UFTBRB3F1",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "eq4",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "I can see a fairly obvious improvement straight away, there is at least one (possibly more) superflous loop, which is going to cause huge slowdown I'd image"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "UFTBRB3F1",
        "type": "message",
        "ts": "1650887287.021259",
        "client_msg_id": "b68eb0f2-3998-42d6-8365-2b386fdcd4c9",
        "text": "So will start there",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "g771e110be94",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/a771e110be945b86bede9d5c1bb551e3.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png",
            "first_name": "",
            "real_name": "Newbie99",
            "display_name": "",
            "team": "T4G9NBD2M",
            "name": "vjmehra",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1650804386.760549",
        "parent_user_id": "UFTBRB3F1",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "CYv",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "So will start there"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U4H19D1D2",
        "type": "message",
        "ts": "1650887304.550779",
        "client_msg_id": "f7d857a7-3b81-4ef5-ae9a-e1730bd21df2",
        "text": ":+1:",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "137c5a3ef323",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-03-15\/6819395173841_137c5a3ef323f1944a1a_72.png",
            "first_name": "liam",
            "real_name": "liam",
            "display_name": "liam",
            "team": "T4G9NBD2M",
            "name": "liam",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1650804386.760549",
        "parent_user_id": "UFTBRB3F1",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "9N6",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "emoji",
                                "name": "+1",
                                "unicode": "1f44d"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U01SXA01VAN",
        "type": "message",
        "ts": "1650889729.825209",
        "client_msg_id": "dc177193-c3a7-4ce9-b1ff-b0cf19415216",
        "text": ":+1:",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "362aa98b9eb7",
            "image_72": "https:\/\/avatars.slack-edge.com\/2022-05-14\/3519381695894_362aa98b9eb760213ec7_72.jpg",
            "first_name": "charlie_v",
            "real_name": "charlie_v",
            "display_name": "charlie_v",
            "team": "T4G9NBD2M",
            "name": "charlieejv",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "yH56K",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "emoji",
                                "name": "+1",
                                "unicode": "1f44d"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "UCQB6S222",
        "type": "message",
        "ts": "1650900140.406419",
        "client_msg_id": "9719f17b-7c18-4e6e-8bd0-d190196ffe46",
        "text": "who is he talking about at the end?",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "g953ffd5e3b7",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/5813be539113b05ece8212c2a06d006a.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0011-72.png",
            "first_name": "George",
            "real_name": "George",
            "display_name": "George",
            "team": "T4G9NBD2M",
            "name": "gd",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1650880251.538169",
        "parent_user_id": "U01HQ97J5HA",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "OXdEI",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "who is he talking about at the end?"
                            }
                        ]
                    }
                ]
            }
        ]
    }
]