[
    {
        "user": "U013Z24LD0U",
        "type": "message",
        "ts": "1592379202.362700",
        "edited": {
            "user": "U013Z24LD0U",
            "ts": "1592379419.000000"
        },
        "client_msg_id": "370c16e3-5909-47c2-b789-2e583daaca89",
        "text": "<@U0155J92A7Q> I've implemented a cashout feature just recently for the App I'm building and had the same complications you described. I'm not using that endpoint from the cashout service as it's not officially available to us and probably not suitable for distribution (I wish I could use it). I do hedge each selection individually and most of the times it works just fine but I still need to do some optimisation because there are edge cases that are very easy to mess up the calculations. An example is when you have a back order on all selections of the market (profit on both selections) and you want to hedge the profits, let's consider a simple market here: under 0.5 goals on football.\n\n1. Back under 0.5 -  £10 @ 11.5 \n2. Back over 0.5 - £80 @ 1.15\n3. Now you have the following PL: £23.75 (if under) or £1.90 (if over)\n4. You want to distribute the profit evenly here and the cashout formula will tell you to create an order for each selection that's OPPOSITE of their respective first order. Clearly this is not the best approach to hedge on this scenario and could also potentially lead to negative cashout offers, so there needs to be something in place to catch these edge cases and remove the \"worst\" selection's closing bet when it's not appropriate (this is what I'm trying to work out now)",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "gd66c8675972",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/d66c8675972fda4db8644e1a6df5dc3f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0019-72.png",
            "first_name": "Fabio",
            "real_name": "Fabio Simao",
            "display_name": "SrFabio",
            "team": "T4G9NBD2M",
            "name": "sr.fabiosimao",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "ynkh",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "user",
                                "user_id": "U0155J92A7Q"
                            },
                            {
                                "type": "text",
                                "text": " I've implemented a cashout feature just recently for the App I'm building and had the same complications you described. I'm not using that endpoint from the cashout service as it's not officially available to us and probably not suitable for distribution (I wish I could use it). I do hedge each selection individually and most of the times it works just fine but I still need to do some optimisation because there are edge cases that are very easy to mess up the calculations. An example is when you have a back order on all selections of the market (profit on both selections) and you want to hedge the profits, let's consider a simple market here: under 0.5 goals on football.\n\n"
                            }
                        ]
                    },
                    {
                        "type": "rich_text_list",
                        "elements": [
                            {
                                "type": "rich_text_section",
                                "elements": [
                                    {
                                        "type": "text",
                                        "text": "Back under 0.5 -  £10 @ 11.5 "
                                    }
                                ]
                            },
                            {
                                "type": "rich_text_section",
                                "elements": [
                                    {
                                        "type": "text",
                                        "text": "Back over 0.5 - £80 @ 1.15"
                                    }
                                ]
                            },
                            {
                                "type": "rich_text_section",
                                "elements": [
                                    {
                                        "type": "text",
                                        "text": "Now you have the following PL: £23.75 (if under) or £1.90 (if over)"
                                    }
                                ]
                            },
                            {
                                "type": "rich_text_section",
                                "elements": [
                                    {
                                        "type": "text",
                                        "text": "You want to distribute the profit evenly here and the cashout formula will tell you to create an order for each selection that's OPPOSITE of their respective first order. Clearly this is not the best approach to hedge on this scenario and could also potentially lead to negative cashout offers, so there needs to be something in place to catch these edge cases and remove the \"worst\" selection's closing bet when it's not appropriate (this is what I'm trying to work out now)"
                                    }
                                ]
                            }
                        ],
                        "style": "ordered",
                        "indent": 0
                    }
                ]
            }
        ]
    },
    {
        "subtype": "channel_join",
        "user": "U015K26204A",
        "text": "<@U015K26204A> has joined the channel",
        "type": "message",
        "ts": "1592385281.363000"
    },
    {
        "user": "U013MLED3V1",
        "type": "message",
        "ts": "1592385672.365900",
        "client_msg_id": "ffe28775-3bee-494e-8b5d-8f837a5ba0d3",
        "text": "<@U013Z24LD0U>, your can close bet position either by opposite bet (back\/lay or lay\/back) or by dutching bets, exactly in such situation, when you open your bet position on all selection, dutch bets can get better return, if you match your bets on better odds, otherwise it is the same like hedging.",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "g76de2b0594d",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/76de2b0594d8598d76169231046f271a.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0001-72.png",
            "first_name": "StefanBelo",
            "real_name": "StefanBelo",
            "display_name": "Stefan",
            "team": "T4G9NBD2M",
            "name": "stefanbelopotocan",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "3G2k",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "user",
                                "user_id": "U013Z24LD0U"
                            },
                            {
                                "type": "text",
                                "text": ", your can close bet position either by opposite bet (back\/lay or lay\/back) or by dutching bets, exactly in such situation, when you open your bet position on all selection, dutch bets can get better return, if you match your bets on better odds, otherwise it is the same like hedging."
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U013Z24LD0U",
        "type": "message",
        "ts": "1592386327.372600",
        "edited": {
            "user": "U013Z24LD0U",
            "ts": "1592386498.000000"
        },
        "client_msg_id": "fe1f5ccf-1df1-4482-ae6b-387224fdcba7",
        "text": "<@U013MLED3V1> :+1: yes dutching is actually what I'm looking to implement as a fallback when the common cash out formula is not appropriate - but first I need a reliable way of telling when the cashout is not possible \/ optimal before doing the dutching calculations as I'm assuming they are harder to compute. Or do you think I should compute a cashout using both methods and just choose the better one?",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "gd66c8675972",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/d66c8675972fda4db8644e1a6df5dc3f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0019-72.png",
            "first_name": "Fabio",
            "real_name": "Fabio Simao",
            "display_name": "SrFabio",
            "team": "T4G9NBD2M",
            "name": "sr.fabiosimao",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "wFJB",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "user",
                                "user_id": "U013MLED3V1"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "emoji",
                                "name": "+1",
                                "unicode": "1f44d"
                            },
                            {
                                "type": "text",
                                "text": " yes dutching is actually what I'm looking to implement as a fallback when the common cash out formula is not appropriate - but first I need a reliable way of telling when the cashout is not possible \/ optimal before doing the dutching calculations as I'm assuming they are harder to compute. Or do you think I should compute a cashout using both methods and just choose the better one?"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U0155J92A7Q",
        "type": "message",
        "ts": "1592386682.375700",
        "client_msg_id": "3e7a1afb-c97d-44b2-a28e-38ed471b1b85",
        "text": "Hi <@U013Z24LD0U>, I arrived to the conclusion that replicating Betfair's cash out functionality (without using the endpoint) is doable for 2 runner games, but very complicated for 3+ runners. In 2 runner games you can just compute a cashout using both methods (dutching and back\/lay) and choose the best.",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "gde8c5d51af5",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/de8c5d51af54a5ac7b501f416ddb262c.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0016-72.png",
            "first_name": "",
            "real_name": "Jorge",
            "display_name": "Jorge",
            "team": "T4G9NBD2M",
            "name": "jgarciam95",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "QOd",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Hi "
                            },
                            {
                                "type": "user",
                                "user_id": "U013Z24LD0U"
                            },
                            {
                                "type": "text",
                                "text": ", I arrived to the conclusion that replicating Betfair's cash out functionality (without using the endpoint) is doable for 2 runner games, but very complicated for 3+ runners. In 2 runner games you can just compute a cashout using both methods (dutching and back\/lay) and choose the best."
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U0155J92A7Q",
        "type": "message",
        "ts": "1592387884.376500",
        "client_msg_id": "1b7f240c-a651-450e-98ec-ac1fda4b311e",
        "text": "I'm currently using the endpoint from the cashout service and is working fine, but of course only for personal use.",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "gde8c5d51af5",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/de8c5d51af54a5ac7b501f416ddb262c.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0016-72.png",
            "first_name": "",
            "real_name": "Jorge",
            "display_name": "Jorge",
            "team": "T4G9NBD2M",
            "name": "jgarciam95",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "O6U",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "I'm currently using the endpoint from the cashout service and is working fine, but of course only for personal use."
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U013Z24LD0U",
        "type": "message",
        "ts": "1592388250.378500",
        "client_msg_id": "512b1313-7549-4b96-903e-46f150de7aeb",
        "text": "<@U0155J92A7Q> the process is the same for 2 or 2+ runners, it only gets complicated if:\n• You have more than one order on a runner\n• You have orders on all runners but not all runners should be used on the hedging process ",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "gd66c8675972",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/d66c8675972fda4db8644e1a6df5dc3f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0019-72.png",
            "first_name": "Fabio",
            "real_name": "Fabio Simao",
            "display_name": "SrFabio",
            "team": "T4G9NBD2M",
            "name": "sr.fabiosimao",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "7wrv",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "user",
                                "user_id": "U0155J92A7Q"
                            },
                            {
                                "type": "text",
                                "text": " the process is the same for 2 or 2+ runners, it only gets complicated if:\n"
                            }
                        ]
                    },
                    {
                        "type": "rich_text_list",
                        "elements": [
                            {
                                "type": "rich_text_section",
                                "elements": [
                                    {
                                        "type": "text",
                                        "text": "You have more than one order on a runner"
                                    }
                                ]
                            },
                            {
                                "type": "rich_text_section",
                                "elements": [
                                    {
                                        "type": "text",
                                        "text": "You have orders on all runners but not all runners should be used on the hedging process "
                                    }
                                ]
                            }
                        ],
                        "style": "bullet",
                        "indent": 0
                    }
                ]
            }
        ]
    },
    {
        "user": "U013Z24LD0U",
        "type": "message",
        "ts": "1592388633.380000",
        "client_msg_id": "c646c966-fa7d-4c54-a2f9-2891bec8dedb",
        "text": "The other \"problem\" is that the cashout might be composed by multiple orders (one per traded selection) and some of those orders might not get matched, so we need some type of \"slippage\" to prevent this...there's a lot of things to consider on a cashout",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "gd66c8675972",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/d66c8675972fda4db8644e1a6df5dc3f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0019-72.png",
            "first_name": "Fabio",
            "real_name": "Fabio Simao",
            "display_name": "SrFabio",
            "team": "T4G9NBD2M",
            "name": "sr.fabiosimao",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "51P\/",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "The other \"problem\" is that the cashout might be composed by multiple orders (one per traded selection) and some of those orders might not get matched, so we need some type of \"slippage\" to prevent this...there's a lot of things to consider on a cashout"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U0155J92A7Q",
        "type": "message",
        "ts": "1592390994.381200",
        "client_msg_id": "9e8e7211-3918-4bf5-89ac-0d0abb395fab",
        "text": "<@U013MLED3V1> well I meant for 2 runners it is possible to solve all the possible complications in a simple way (you'll only have to place 1 bet), whereas 2+ runners makes it very complicated to be solved",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "gde8c5d51af5",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/de8c5d51af54a5ac7b501f416ddb262c.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0016-72.png",
            "first_name": "",
            "real_name": "Jorge",
            "display_name": "Jorge",
            "team": "T4G9NBD2M",
            "name": "jgarciam95",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "bWMM",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "user",
                                "user_id": "U013MLED3V1"
                            },
                            {
                                "type": "text",
                                "text": " well I meant for 2 runners it is possible to solve all the possible complications in a simple way (you'll only have to place 1 bet), whereas 2+ runners makes it very complicated to be solved"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "subtype": "channel_join",
        "user": "U0154JA98TH",
        "text": "<@U0154JA98TH> has joined the channel",
        "type": "message",
        "ts": "1592395263.381500"
    },
    {
        "subtype": "channel_join",
        "user": "U01697K27UY",
        "text": "<@U01697K27UY> has joined the channel",
        "type": "message",
        "ts": "1592397017.381700"
    },
    {
        "subtype": "channel_join",
        "user": "U015SD5A744",
        "text": "<@U015SD5A744> has joined the channel",
        "type": "message",
        "ts": "1592415463.381900"
    }
]