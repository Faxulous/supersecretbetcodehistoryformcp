[
    {
        "user": "UUCD6P13J",
        "type": "message",
        "ts": "1597232405.117900",
        "client_msg_id": "d21659d2-7b87-4abc-b3bc-a4d0cc4217e2",
        "text": "I think i might not be understanding the MarketOnCloseOrder correctly. I'm trying to take SP just before going inplay but can't seem to get any money matched (flumine backtesting). I've removed my trigger and try to place an order on all runners and still get zero matched.\nI've also set my strategy exposure high and not getting any voilation errors on the orders in the logs.\nI'm creating an order using the following\n```order = trade.create_order(\n    side=\"BACK\", order_type=MarketOnCloseOrder(liability=20)\n)```\nAny idea where i'm going wrong or if it's just a misunderstanding\n\nhere's a log too\n```{\"asctime\": \"2020-08-12 11:32:33,047\", \"levelname\": \"INFO\", \"message\": \"Order status update: Execution complete\", \"market_id\": \"1.170576255\", \"selection_id\": 19436243, \"handicap\": 0, \"id\": \"138165247530344110\", \"customer_order_ref\": \"890b98c67ce74-138165247530344110\", \"bet_id\": \"100000000007\", \"trade\": {\"id\": \"83599e5e-dc8f-11ea-80ef-d45d6453ef52\", \"strategy\": \"xxxxxxx\", \"status\": \"TradeStatus.LIVE\", \"orders\": [\"138165247530344110\"], \"notes\": \"\", \"market_notes\": \"15.5,16,15.5\"}, \"order_type\": {\"order_type\": \"Market on close\", \"liability\": 20}, \"info\": {\"side\": \"BACK\", \"size_matched\": 0.0, \"size_remaining\": 0.0, \"size_cancelled\": 0.0, \"size_lapsed\": 0.0, \"size_voided\": 0.0, \"average_price_matched\": 0.0}, \"status\": \"Execution complete\", \"status_log\": \"Pending, Executable, Execution complete\"}```",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "g6898272ab81",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/6898272ab810e419c2c9ca9af1e53da8.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0012-72.png",
            "first_name": "Lee",
            "real_name": "Lee U",
            "display_name": "Lee",
            "team": "T4G9NBD2M",
            "name": "lunswor",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1597232405.117900",
        "reply_count": 2,
        "reply_users_count": 2,
        "latest_reply": "1597672093.144200",
        "reply_users": [
            "U4H19D1D2",
            "UUCD6P13J"
        ],
        "replies": [
            {
                "user": "U4H19D1D2",
                "ts": "1597668670.143900"
            },
            {
                "user": "UUCD6P13J",
                "ts": "1597672093.144200"
            }
        ],
        "is_locked": false,
        "subscribed": true,
        "last_read": "1597672093.144200",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "50RI",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "I think i might not be understanding the MarketOnCloseOrder correctly. I'm trying to take SP just before going inplay but can't seem to get any money matched (flumine backtesting). I've removed my trigger and try to place an order on all runners and still get zero matched.\nI've also set my strategy exposure high and not getting any voilation errors on the orders in the logs.\nI'm creating an order using the following\n"
                            }
                        ]
                    },
                    {
                        "type": "rich_text_preformatted",
                        "elements": [
                            {
                                "type": "text",
                                "text": "order = trade.create_order(\n    side=\"BACK\", order_type=MarketOnCloseOrder(liability=20)\n)"
                            }
                        ]
                    },
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Any idea where i'm going wrong or if it's just a misunderstanding\n\nhere's a log too\n"
                            }
                        ]
                    },
                    {
                        "type": "rich_text_preformatted",
                        "elements": [
                            {
                                "type": "text",
                                "text": "{\"asctime\": \"2020-08-12 11:32:33,047\", \"levelname\": \"INFO\", \"message\": \"Order status update: Execution complete\", \"market_id\": \"1.170576255\", \"selection_id\": 19436243, \"handicap\": 0, \"id\": \"138165247530344110\", \"customer_order_ref\": \"890b98c67ce74-138165247530344110\", \"bet_id\": \"100000000007\", \"trade\": {\"id\": \"83599e5e-dc8f-11ea-80ef-d45d6453ef52\", \"strategy\": \"xxxxxxx\", \"status\": \"TradeStatus.LIVE\", \"orders\": [\"138165247530344110\"], \"notes\": \"\", \"market_notes\": \"15.5,16,15.5\"}, \"order_type\": {\"order_type\": \"Market on close\", \"liability\": 20}, \"info\": {\"side\": \"BACK\", \"size_matched\": 0.0, \"size_remaining\": 0.0, \"size_cancelled\": 0.0, \"size_lapsed\": 0.0, \"size_voided\": 0.0, \"average_price_matched\": 0.0}, \"status\": \"Execution complete\", \"status_log\": \"Pending, Executable, Execution complete\"}"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U4H19D1D2",
        "type": "message",
        "ts": "1597233139.118300",
        "client_msg_id": "7ac28ca9-f811-4e4c-acb4-3b194811e7e1",
        "text": "Whats the market type, confident it has SP \/ it becomes reconciled? <https:\/\/github.com\/liampauling\/flumine\/blob\/master\/flumine\/backtest\/simulated.py#L41>",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "137c5a3ef323",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-03-15\/6819395173841_137c5a3ef323f1944a1a_72.png",
            "first_name": "liam",
            "real_name": "liam",
            "display_name": "liam",
            "team": "T4G9NBD2M",
            "name": "liam",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "attachments": [
            {
                "fallback": "[liampauling\/flumine] flumine\/backtest\/simulated.py:41",
                "text": "```\n            and market_book.bsp_reconciled\n```",
                "title": "flumine\/backtest\/simulated.py:41",
                "footer": "<https:\/\/github.com\/liampauling\/flumine|liampauling\/flumine>",
                "id": 1,
                "title_link": "https:\/\/github.com\/liampauling\/flumine\/blob\/master\/flumine\/backtest\/simulated.py#L41",
                "footer_icon": "https:\/\/github.githubassets.com\/favicon.ico",
                "color": "24292f",
                "mrkdwn_in": [
                    "text"
                ],
                "bot_id": "B01144Z0734",
                "app_unfurl_url": "https:\/\/github.com\/liampauling\/flumine\/blob\/master\/flumine\/backtest\/simulated.py#L41",
                "is_app_unfurl": true
            }
        ],
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "cVLm",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Whats the market type, confident it has SP \/ it becomes reconciled? "
                            },
                            {
                                "type": "link",
                                "url": "https:\/\/github.com\/liampauling\/flumine\/blob\/master\/flumine\/backtest\/simulated.py#L41"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "UUCD6P13J",
        "type": "message",
        "ts": "1597233169.118800",
        "client_msg_id": "56E741ED-E774-4D00-9924-3541A74C4726",
        "text": "Gb horse racing ",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "g6898272ab81",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/6898272ab810e419c2c9ca9af1e53da8.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0012-72.png",
            "first_name": "Lee",
            "real_name": "Lee U",
            "display_name": "Lee",
            "team": "T4G9NBD2M",
            "name": "lunswor",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "y1DGW",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Gb horse racing "
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U4H19D1D2",
        "type": "message",
        "ts": "1597233248.119400",
        "client_msg_id": "f6ab4cbc-6fce-49ee-ac43-cc6868ded207",
        "text": "Can you see if `_process__sp` is being called via the debugger?",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "137c5a3ef323",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-03-15\/6819395173841_137c5a3ef323f1944a1a_72.png",
            "first_name": "liam",
            "real_name": "liam",
            "display_name": "liam",
            "team": "T4G9NBD2M",
            "name": "liam",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "Tg5",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Can you see if "
                            },
                            {
                                "type": "text",
                                "text": "process_",
                                "style": {
                                    "italic": true,
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": "sp",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " is being called via the debugger?"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U4H19D1D2",
        "type": "message",
        "ts": "1597233656.120600",
        "client_msg_id": "12fde49e-57bb-4d23-8741-f72ce5899027",
        "text": "I see the problem",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "137c5a3ef323",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-03-15\/6819395173841_137c5a3ef323f1944a1a_72.png",
            "first_name": "liam",
            "real_name": "liam",
            "display_name": "liam",
            "team": "T4G9NBD2M",
            "name": "liam",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "M5d4",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "I see the problem"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "UUCD6P13J",
        "type": "message",
        "ts": "1597233668.121000",
        "client_msg_id": "4aeeaf31-7b38-4ac9-8e55-242fcb49f063",
        "text": "`process_sp` is being called when i place the order (pre race) at that point  market_book.bsp_reconciled is False",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "g6898272ab81",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/6898272ab810e419c2c9ca9af1e53da8.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0012-72.png",
            "first_name": "Lee",
            "real_name": "Lee U",
            "display_name": "Lee",
            "team": "T4G9NBD2M",
            "name": "lunswor",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "W5vOH",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "process_sp",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " is being called when i place the order (pre race) at that point  market_book.bsp_reconciled is False"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U4H19D1D2",
        "type": "message",
        "ts": "1597233672.121100",
        "client_msg_id": "bba1ea8a-604d-4527-918b-d440b6845112",
        "text": "it becomes Execution Complete so it never gets processed",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "137c5a3ef323",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-03-15\/6819395173841_137c5a3ef323f1944a1a_72.png",
            "first_name": "liam",
            "real_name": "liam",
            "display_name": "liam",
            "team": "T4G9NBD2M",
            "name": "liam",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "vCBM3",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "it becomes Execution Complete so it never gets processed"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U4H19D1D2",
        "type": "message",
        "ts": "1597233714.121500",
        "client_msg_id": "0c0a2d78-aef8-4ac5-80f2-9d81d3f2d8c1",
        "text": "<https:\/\/github.com\/liampauling\/flumine\/blob\/9a047934458899f4f452a10f9fa6375fd37a0ade\/flumine\/order\/process.py#L59>",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "137c5a3ef323",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-03-15\/6819395173841_137c5a3ef323f1944a1a_72.png",
            "first_name": "liam",
            "real_name": "liam",
            "display_name": "liam",
            "team": "T4G9NBD2M",
            "name": "liam",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "attachments": [
            {
                "fallback": "[liampauling\/flumine] flumine\/order\/process.py:59",
                "text": "```\n        elif order.size_remaining == 0:\n```",
                "title": "flumine\/order\/process.py:59",
                "footer": "<https:\/\/github.com\/liampauling\/flumine|liampauling\/flumine>",
                "id": 1,
                "title_link": "https:\/\/github.com\/liampauling\/flumine\/blob\/9a047934458899f4f452a10f9fa6375fd37a0ade\/flumine\/order\/process.py#L59",
                "footer_icon": "https:\/\/github.githubassets.com\/favicon.ico",
                "color": "24292f",
                "mrkdwn_in": [
                    "text"
                ],
                "bot_id": "B01144Z0734",
                "app_unfurl_url": "https:\/\/github.com\/liampauling\/flumine\/blob\/9a047934458899f4f452a10f9fa6375fd37a0ade\/flumine\/order\/process.py#L59",
                "is_app_unfurl": true
            }
        ],
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "k2Y",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "link",
                                "url": "https:\/\/github.com\/liampauling\/flumine\/blob\/9a047934458899f4f452a10f9fa6375fd37a0ade\/flumine\/order\/process.py#L59"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "UUCD6P13J",
        "type": "message",
        "ts": "1597233776.122200",
        "edited": {
            "user": "UUCD6P13J",
            "ts": "1597233786.000000"
        },
        "client_msg_id": "2e198097-db14-456e-b648-21a1d7ed46c0",
        "text": "is my understanding right that i should be able to place a MarketOnCloseOrder prerace and then it take SP going inplay?",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "g6898272ab81",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/6898272ab810e419c2c9ca9af1e53da8.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0012-72.png",
            "first_name": "Lee",
            "real_name": "Lee U",
            "display_name": "Lee",
            "team": "T4G9NBD2M",
            "name": "lunswor",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "SHtD",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "is my understanding right that i should be able to place a MarketOnCloseOrder prerace and then it take SP going inplay?"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U4H19D1D2",
        "type": "message",
        "ts": "1597233802.122700",
        "client_msg_id": "a8275518-2f34-4cc5-8289-ba94b04ba522",
        "text": "yeah, that line needs to be handled correctly for MarketOnCloseOrders",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "137c5a3ef323",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-03-15\/6819395173841_137c5a3ef323f1944a1a_72.png",
            "first_name": "liam",
            "real_name": "liam",
            "display_name": "liam",
            "team": "T4G9NBD2M",
            "name": "liam",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "f+Ar8",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "yeah, that line needs to be handled correctly for MarketOnCloseOrders"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U4H19D1D2",
        "type": "message",
        "ts": "1597233834.123300",
        "client_msg_id": "c8702d03-c949-4f0b-acfc-9381be5481b4",
        "text": "or remove the status if on this line <https:\/\/github.com\/liampauling\/flumine\/blob\/9a047934458899f4f452a10f9fa6375fd37a0ade\/flumine\/markets\/middleware.py#L121>",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "137c5a3ef323",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-03-15\/6819395173841_137c5a3ef323f1944a1a_72.png",
            "first_name": "liam",
            "real_name": "liam",
            "display_name": "liam",
            "team": "T4G9NBD2M",
            "name": "liam",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "attachments": [
            {
                "fallback": "[liampauling\/flumine] flumine\/markets\/middleware.py:121",
                "text": "```\n            if order.simulated and order.status == OrderStatus.EXECUTABLE:\n```",
                "title": "flumine\/markets\/middleware.py:121",
                "footer": "<https:\/\/github.com\/liampauling\/flumine|liampauling\/flumine>",
                "id": 1,
                "title_link": "https:\/\/github.com\/liampauling\/flumine\/blob\/9a047934458899f4f452a10f9fa6375fd37a0ade\/flumine\/markets\/middleware.py#L121",
                "footer_icon": "https:\/\/github.githubassets.com\/favicon.ico",
                "color": "24292f",
                "mrkdwn_in": [
                    "text"
                ],
                "bot_id": "B01144Z0734",
                "app_unfurl_url": "https:\/\/github.com\/liampauling\/flumine\/blob\/9a047934458899f4f452a10f9fa6375fd37a0ade\/flumine\/markets\/middleware.py#L121",
                "is_app_unfurl": true
            }
        ],
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "4Ew+Q",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "or remove the status if on this line "
                            },
                            {
                                "type": "link",
                                "url": "https:\/\/github.com\/liampauling\/flumine\/blob\/9a047934458899f4f452a10f9fa6375fd37a0ade\/flumine\/markets\/middleware.py#L121"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U4H19D1D2",
        "type": "message",
        "ts": "1597233871.124000",
        "client_msg_id": "567f5a5f-c9ce-4aca-9d7d-f3cf92553dad",
        "text": "regression bug on an optimisation (prevent simulated processing orders already complete)",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "137c5a3ef323",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-03-15\/6819395173841_137c5a3ef323f1944a1a_72.png",
            "first_name": "liam",
            "real_name": "liam",
            "display_name": "liam",
            "team": "T4G9NBD2M",
            "name": "liam",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "tQiQ6",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "regression bug on an optimisation (prevent simulated processing orders already complete)"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "UUCD6P13J",
        "type": "message",
        "ts": "1597233921.124900",
        "client_msg_id": "842460e2-aa9c-4eb3-b755-c2ed82b634ee",
        "text": "cool i think i understand the problem, my first thought was i was misunderstanding the purpose of the order type",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "g6898272ab81",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/6898272ab810e419c2c9ca9af1e53da8.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0012-72.png",
            "first_name": "Lee",
            "real_name": "Lee U",
            "display_name": "Lee",
            "team": "T4G9NBD2M",
            "name": "lunswor",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "8bh",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "cool i think i understand the problem, my first thought was i was misunderstanding the purpose of the order type"
                            }
                        ]
                    }
                ]
            }
        ]
    }
]