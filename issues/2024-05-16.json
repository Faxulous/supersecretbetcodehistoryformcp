[
    {
        "user": "U0155J92A7Q",
        "type": "message",
        "ts": "1715844240.515599",
        "client_msg_id": "1357e1c7-5dd2-40a4-8dd3-b5010d7e7678",
        "text": "Hey guys, I recently started Simulating 2 strategies in the same flumine instance, with the goal of running them live. Until now, I was running both strategies in different scripts. This is my code:\n\n```client = clients.SimulatedClient()\nframework = FlumineSimulation(client=client)\n\ncontrol = BacktestLoggingControl(logs_dir=logs_dir)\nframework.add_logging_control(control)\n\nwith patch(\"builtins.open\", smart_open.open):\n    framework.add_strategy(strategy_1)\n    framework.add_strategy(strategy_2)\n    framework.add_market_middleware(MarketCatalogueMiddleware(strategy_2.market_filter[\"markets\"]))\n    framework.run()```\nMy issue is with the <https:\/\/github.com\/betcode-org\/flumine\/blob\/master\/examples\/controls\/backtestloggingcontrol.py|backtestloggingcontrol.py> , I noticed that in my orders.txt, the orders from strategy_1 are duplicated. The same happens with the markets.txt (cleared_markets), I get double the amount of cleared_markets and the last half is the correct one which includes both strategies. How could I fix this so the <https:\/\/github.com\/betcode-org\/flumine\/blob\/master\/examples\/controls\/backtestloggingcontrol.py|backtestloggingcontrol.py> works when running multiple strategies in the same instance?",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "gde8c5d51af5",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/de8c5d51af54a5ac7b501f416ddb262c.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0016-72.png",
            "first_name": "",
            "real_name": "Jorge",
            "display_name": "Jorge",
            "team": "T4G9NBD2M",
            "name": "jgarciam95",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1715844240.515599",
        "reply_count": 8,
        "reply_users_count": 2,
        "latest_reply": "1715854940.697699",
        "reply_users": [
            "U4H19D1D2",
            "U0155J92A7Q"
        ],
        "replies": [
            {
                "user": "U4H19D1D2",
                "ts": "1715846754.153609"
            },
            {
                "user": "U0155J92A7Q",
                "ts": "1715848191.735419"
            },
            {
                "user": "U4H19D1D2",
                "ts": "1715848405.458929"
            },
            {
                "user": "U4H19D1D2",
                "ts": "1715848421.269989"
            },
            {
                "user": "U0155J92A7Q",
                "ts": "1715848590.832599"
            },
            {
                "user": "U0155J92A7Q",
                "ts": "1715848601.167049"
            },
            {
                "user": "U0155J92A7Q",
                "ts": "1715852653.055489"
            },
            {
                "user": "U4H19D1D2",
                "ts": "1715854940.697699"
            }
        ],
        "is_locked": false,
        "subscribed": true,
        "last_read": "1715854940.697699",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "2ggsP",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Hey guys, I recently started Simulating 2 strategies in the same flumine instance, with the goal of running them live. Until now, I was running both strategies in different scripts. This is my code:\n\n"
                            }
                        ]
                    },
                    {
                        "type": "rich_text_preformatted",
                        "elements": [
                            {
                                "type": "text",
                                "text": "client = clients.SimulatedClient()\nframework = FlumineSimulation(client=client)\n\ncontrol = BacktestLoggingControl(logs_dir=logs_dir)\nframework.add_logging_control(control)\n\nwith patch(\"builtins.open\", smart_open.open):\n    framework.add_strategy(strategy_1)\n    framework.add_strategy(strategy_2)\n    framework.add_market_middleware(MarketCatalogueMiddleware(strategy_2.market_filter[\"markets\"]))\n    framework.run()"
                            }
                        ],
                        "border": 0
                    },
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "\nMy issue is with the "
                            },
                            {
                                "type": "link",
                                "url": "https:\/\/github.com\/betcode-org\/flumine\/blob\/master\/examples\/controls\/backtestloggingcontrol.py",
                                "text": "backtestloggingcontrol.py",
                                "unsafe": true
                            },
                            {
                                "type": "text",
                                "text": " , I noticed that in my orders.txt, the orders from strategy_1 are duplicated. The same happens with the markets.txt (cleared_markets), I get double the amount of cleared_markets and the last half is the correct one which includes both strategies. How could I fix this so the "
                            },
                            {
                                "type": "link",
                                "url": "https:\/\/github.com\/betcode-org\/flumine\/blob\/master\/examples\/controls\/backtestloggingcontrol.py",
                                "text": "backtestloggingcontrol.py",
                                "unsafe": true
                            },
                            {
                                "type": "text",
                                "text": " works when running multiple strategies in the same instance?"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U4H19D1D2",
        "type": "message",
        "ts": "1715846754.153609",
        "client_msg_id": "698ca9aa-f23c-4950-a00b-1c72b256e847",
        "text": "Can you provide the full code to replicate? ie. copy the simulateexample",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "137c5a3ef323",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-03-15\/6819395173841_137c5a3ef323f1944a1a_72.png",
            "first_name": "liam",
            "real_name": "liam",
            "display_name": "liam",
            "team": "T4G9NBD2M",
            "name": "liam",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1715844240.515599",
        "parent_user_id": "U0155J92A7Q",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "qybz9",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Can you provide the full code to replicate? ie. copy the simulateexample"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U0155J92A7Q",
        "type": "message",
        "ts": "1715848191.735419",
        "client_msg_id": "07d0650a-2677-4d51-ab3d-6bdf3b3a2c09",
        "text": "Seems to be working well using the simulate.py example. I noticed that in my simulation it runs first the strategy_1 in the 100 markets and then runs the strategy_2 in the 100 markets, as opposed to the simulate.py which runs them in the same market at the same time. So in the simulate.py I only see 1 log of \"Cleared market\" and no duplicates...",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "gde8c5d51af5",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/de8c5d51af54a5ac7b501f416ddb262c.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0016-72.png",
            "first_name": "",
            "real_name": "Jorge",
            "display_name": "Jorge",
            "team": "T4G9NBD2M",
            "name": "jgarciam95",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1715844240.515599",
        "parent_user_id": "U0155J92A7Q",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "7Xkos",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Seems to be working well using the simulate.py example. I noticed that in my simulation it runs first the strategy_1 in the 100 markets and then runs the strategy_2 in the 100 markets, as opposed to the simulate.py which runs them in the same market at the same time. So in the simulate.py I only see 1 log of \"Cleared market\" and no duplicates..."
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U4H19D1D2",
        "type": "message",
        "ts": "1715848405.458929",
        "client_msg_id": "096e4a0f-f5b9-4bd4-a4af-5d8ca49930c3",
        "text": "need more info on what these 100 markets are, are they the same?",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "137c5a3ef323",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-03-15\/6819395173841_137c5a3ef323f1944a1a_72.png",
            "first_name": "liam",
            "real_name": "liam",
            "display_name": "liam",
            "team": "T4G9NBD2M",
            "name": "liam",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1715844240.515599",
        "parent_user_id": "U0155J92A7Q",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "jfbgQ",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "need more info on what these 100 markets are, are they the same?"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U4H19D1D2",
        "type": "message",
        "ts": "1715848421.269989",
        "client_msg_id": "6d3fb57c-ce0d-42d0-bfec-600788da9745",
        "text": "the answer will be in the full code ie. what you aren't sharing",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "137c5a3ef323",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-03-15\/6819395173841_137c5a3ef323f1944a1a_72.png",
            "first_name": "liam",
            "real_name": "liam",
            "display_name": "liam",
            "team": "T4G9NBD2M",
            "name": "liam",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1715844240.515599",
        "parent_user_id": "U0155J92A7Q",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "Cg\/z+",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "the answer will be in the full code ie. what you aren't sharing"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U0155J92A7Q",
        "type": "message",
        "ts": "1715848590.832599",
        "client_msg_id": "55bfb2aa-ae1f-49ee-a136-68d28f9fe39b",
        "text": "Going to clean it up and will share:grin:",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "gde8c5d51af5",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/de8c5d51af54a5ac7b501f416ddb262c.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0016-72.png",
            "first_name": "",
            "real_name": "Jorge",
            "display_name": "Jorge",
            "team": "T4G9NBD2M",
            "name": "jgarciam95",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1715844240.515599",
        "parent_user_id": "U0155J92A7Q",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "kyXjs",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Going to clean it up and will share"
                            },
                            {
                                "type": "emoji",
                                "name": "grin",
                                "unicode": "1f601"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U0155J92A7Q",
        "type": "message",
        "ts": "1715848601.167049",
        "client_msg_id": "920e85ba-0a51-4425-80b7-dc4228ac62d4",
        "text": "Good to see the simulate.py works tho",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "gde8c5d51af5",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/de8c5d51af54a5ac7b501f416ddb262c.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0016-72.png",
            "first_name": "",
            "real_name": "Jorge",
            "display_name": "Jorge",
            "team": "T4G9NBD2M",
            "name": "jgarciam95",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1715844240.515599",
        "parent_user_id": "U0155J92A7Q",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "yKuSP",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Good to see the simulate.py works tho"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U0155J92A7Q",
        "type": "message",
        "ts": "1715852653.055489",
        "edited": {
            "user": "U0155J92A7Q",
            "ts": "1715852659.000000"
        },
        "client_msg_id": "9a2ef135-2e59-49fe-931d-8e1f6ae39193",
        "text": "Found my issue, the strategies were using different listener_kwargs and that caused the problem. They were using different markets too but that works well",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "gde8c5d51af5",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/de8c5d51af54a5ac7b501f416ddb262c.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0016-72.png",
            "first_name": "",
            "real_name": "Jorge",
            "display_name": "Jorge",
            "team": "T4G9NBD2M",
            "name": "jgarciam95",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1715844240.515599",
        "parent_user_id": "U0155J92A7Q",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "pGBJW",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Found my issue, the strategies were using different listener_kwargs and that caused the problem. They were using different markets too but that works well"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U4H19D1D2",
        "type": "message",
        "ts": "1715854940.697699",
        "client_msg_id": "42219d62-cc8f-483b-a2e0-498e4d97f3ee",
        "text": "Yeah that makes sense, it would then repeat the markets as the logic requires a direct match to 're use' the markets",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "137c5a3ef323",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-03-15\/6819395173841_137c5a3ef323f1944a1a_72.png",
            "first_name": "liam",
            "real_name": "liam",
            "display_name": "liam",
            "team": "T4G9NBD2M",
            "name": "liam",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1715844240.515599",
        "parent_user_id": "U0155J92A7Q",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "1hLGV",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Yeah that makes sense, it would then repeat the markets as the logic requires a direct match to 're use' the markets"
                            }
                        ]
                    }
                ]
            }
        ],
        "reactions": [
            {
                "name": "+1",
                "users": [
                    "U0155J92A7Q"
                ],
                "count": 1
            }
        ]
    }
]