[
    {
        "user": "U02RN7YDRQ9",
        "type": "message",
        "ts": "1693844760.892269",
        "client_msg_id": "13a6a123-a454-4bb0-8052-4f61266c7e6c",
        "text": "In 2 dog races today a matched live bet was logged as being `OrderStatus.EXECUTABLE` (ie not matched) at `process_closed_market()`\nFrom the live logs it appears that the update message for the bet `\"Order status update: Execution complete\"` came in about half a second AFTER the `\"Market closed\"` message.\nI always thought everything was done and dusted at `process_closed_market()` ?\nIn simulation it works fine of course but how to handle this on live to avoid being misled as to what bets have really been matched ?",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "ge46f1f8b708",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/e46f1f8b708a630e3191de7b2c42b1d1.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0023-72.png",
            "first_name": "edblock",
            "real_name": "edblock",
            "display_name": "foxwood",
            "team": "T4G9NBD2M",
            "name": "eanb",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1693844760.892269",
        "reply_count": 4,
        "reply_users_count": 3,
        "latest_reply": "1693908609.465739",
        "reply_users": [
            "U4H19D1D2",
            "U05L8PZD2FM",
            "U02RN7YDRQ9"
        ],
        "replies": [
            {
                "user": "U4H19D1D2",
                "ts": "1693852536.628789"
            },
            {
                "user": "U05L8PZD2FM",
                "ts": "1693857883.197239"
            },
            {
                "user": "U02RN7YDRQ9",
                "ts": "1693859564.672699"
            },
            {
                "user": "U02RN7YDRQ9",
                "ts": "1693908609.465739"
            }
        ],
        "is_locked": false,
        "subscribed": true,
        "last_read": "1693908609.465739",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "+owk",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "In 2 dog races today a matched live bet was logged as being "
                            },
                            {
                                "type": "text",
                                "text": "OrderStatus.EXECUTABLE",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " (ie not matched) at "
                            },
                            {
                                "type": "text",
                                "text": "process_closed_market()",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": "\nFrom the live logs it appears that the update message for the bet "
                            },
                            {
                                "type": "text",
                                "text": "\"Order status update: Execution complete\"",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " came in about half a second AFTER the "
                            },
                            {
                                "type": "text",
                                "text": "\"Market closed\"",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " message.\nI always thought everything was done and dusted at "
                            },
                            {
                                "type": "text",
                                "text": "process_closed_market()",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " ?\nIn simulation it works fine of course but how to handle this on live to avoid being misled as to what bets have really been matched ?"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U4H19D1D2",
        "type": "message",
        "ts": "1693852536.628789",
        "client_msg_id": "9A6F05EB-42E8-42EF-A29E-5C8BB4B5853A",
        "text": "Are you confident it’s not just a logging issue\/ delay?",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "137c5a3ef323",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-03-15\/6819395173841_137c5a3ef323f1944a1a_72.png",
            "first_name": "liam",
            "real_name": "liam",
            "display_name": "liam",
            "team": "T4G9NBD2M",
            "name": "liam",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1693844760.892269",
        "parent_user_id": "U02RN7YDRQ9",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "lVVU",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Are you confident "
                            },
                            {
                                "type": "text",
                                "text": "it’s"
                            },
                            {
                                "type": "text",
                                "text": " not just a logging issue\/ delay?"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U05L8PZD2FM",
        "type": "message",
        "ts": "1693857883.197239",
        "client_msg_id": "e2487a26-35c7-4cc6-8985-ec37986b3f26",
        "text": "Market would suspend at the off, then BSP reconciliation which may cause a match, then close at settlement.",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "gb417ed434bb",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/b417ed434bbea199d58a9b4bd0affeb9.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0003-72.png",
            "first_name": "Joe",
            "real_name": "Joe",
            "display_name": "",
            "team": "T4G9NBD2M",
            "name": "stapleton_joe",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1693844760.892269",
        "parent_user_id": "U02RN7YDRQ9",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "=OQL=",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Market would suspend at the off, then BSP reconciliation which may cause a match, then close at settlement."
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U02RN7YDRQ9",
        "type": "message",
        "ts": "1693859564.672699",
        "edited": {
            "user": "U02RN7YDRQ9",
            "ts": "1693860132.000000"
        },
        "client_msg_id": "e5f38d84-152e-42b1-83cc-3806e2880344",
        "text": "Extract from log for that market shown below from placing bet onwards -  think I've identified the origin of the log messages correctly ...\n\n`{\"asctime\": \"2023-09-04 13:12:30,255\", \"levelname\": \"INFO\", \"message\": \"Order status update: Executable\", \"market_id\": \"1.217888463\",`\n`{\"asctime\": \"2023-09-04 13:13:41,499\", \"levelname\": \"INFO\", \"message\": \"Updated marketCatalogue for 1.217888463\"`\n`{\"asctime\": \"2023-09-04 13:15:41,582\", \"levelname\": \"INFO\", \"message\": \"Updated marketCatalogue for 1.217888463\"`\n\n\tmarket.close_market() produces next line\n`{\"asctime\": \"2023-09-04 13:15:52,069\", \"levelname\": \"INFO\", \"message\": \"Market 1.217888463 closed\", \"market_id\": \"1.217888463\"`\n\tmystrat.process_closed_market()\tproduces next line\n`{\"asctime\": \"2023-09-04 13:15:52,069\", \"levelname\": \"INFO\", \"message\": \"319679639999,stratXXXX,OrderStatus.EXECUTABLE\"}`\n\tBaseFlumine._process_close_market() produces next line\n`{\"asctime\": \"2023-09-04 13:15:52,069\", \"levelname\": \"INFO\", \"message\": \"Market closed\", \"market_id\": \"1.217888463\"`\n\n`{\"asctime\": \"2023-09-04 13:15:52,444\", \"levelname\": \"INFO\", \"message\": \"Order status update: Execution complete\", \"market_id\": \"1.217888463\"`\n`{\"asctime\": \"2023-09-04 13:16:27,594\", \"levelname\": \"INFO\", \"message\": \"1.217888463: 1 cleared orders found, more available: False\"}`\n`{\"asctime\": \"2023-09-04 13:16:27,609\", \"levelname\": \"INFO\", \"message\": \"Market cleared\", \"market_id\": \"1.217888463\", \"order_count\": 1`\n\nEdit; the bet was a \"take\" and BF accounts show matched at asked odds. Also the \"executable\" line above shows fully matched at asking price - so the issue is that the bet was still showing as executable until after close market - I didn't see it since I only report execution complete orders when deriving PL etc - maybe that's my fault then ?",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "ge46f1f8b708",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/e46f1f8b708a630e3191de7b2c42b1d1.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0023-72.png",
            "first_name": "edblock",
            "real_name": "edblock",
            "display_name": "foxwood",
            "team": "T4G9NBD2M",
            "name": "eanb",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1693844760.892269",
        "parent_user_id": "U02RN7YDRQ9",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "PxvlD",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Extract from log for that market shown below from placing bet onwards -  think I've identified the origin of the log messages correctly ...\n\n"
                            },
                            {
                                "type": "text",
                                "text": "{\"asctime\": \"2023-09-04 13:12:30,255\", \"levelname\": \"INFO\", \"message\": \"Order status update: Executable\", \"market_id\": \"1.217888463\",",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": "\n"
                            },
                            {
                                "type": "text",
                                "text": "{\"asctime\": \"2023-09-04 13:13:41,499\", \"levelname\": \"INFO\", \"message\": \"Updated marketCatalogue for 1.217888463\"",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": "\n"
                            },
                            {
                                "type": "text",
                                "text": "{\"asctime\": \"2023-09-04 13:15:41,582\", \"levelname\": \"INFO\", \"message\": \"Updated marketCatalogue for 1.217888463\"",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": "\n\n\tmarket.close_market() produces next line\n"
                            },
                            {
                                "type": "text",
                                "text": "{\"asctime\": \"2023-09-04 13:15:52,069\", \"levelname\": \"INFO\", \"message\": \"Market 1.217888463 closed\", \"market_id\": \"1.217888463\"",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": "\n\tmystrat.process_closed_market()\tproduces next line\n"
                            },
                            {
                                "type": "text",
                                "text": "{\"asctime\": \"2023-09-04 13:15:52,069\", \"levelname\": \"INFO\", \"message\": \"319679639999,stratXXXX,OrderStatus.EXECUTABLE\"}",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": "\n\tBaseFlumine._process_close_market() produces next line\n"
                            },
                            {
                                "type": "text",
                                "text": "{\"asctime\": \"2023-09-04 13:15:52,069\", \"levelname\": \"INFO\", \"message\": \"Market closed\", \"market_id\": \"1.217888463\"",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": "\n\n"
                            },
                            {
                                "type": "text",
                                "text": "{\"asctime\": \"2023-09-04 13:15:52,444\", \"levelname\": \"INFO\", \"message\": \"Order status update: Execution complete\", \"market_id\": \"1.217888463\"",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": "\n"
                            },
                            {
                                "type": "text",
                                "text": "{\"asctime\": \"2023-09-04 13:16:27,594\", \"levelname\": \"INFO\", \"message\": \"1.217888463: 1 cleared orders found, more available: False\"}",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": "\n"
                            },
                            {
                                "type": "text",
                                "text": "{\"asctime\": \"2023-09-04 13:16:27,609\", \"levelname\": \"INFO\", \"message\": \"Market cleared\", \"market_id\": \"1.217888463\", \"order_count\": 1",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": "\n\nEdit; the bet was a \"take\" and BF accounts show matched at asked odds. Also the \"executable\" line above shows fully matched at asking price - so the issue is that the bet was still showing as executable until after close market - I didn't see it since I only report execution complete orders when deriving PL etc - maybe that's my fault then ?"
                            }
                        ]
                    }
                ]
            }
        ]
    }
]