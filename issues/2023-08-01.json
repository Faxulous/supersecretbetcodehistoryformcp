[
    {
        "user": "U02RN7YDRQ9",
        "type": "message",
        "ts": "1690880508.866579",
        "client_msg_id": "4fd69800-14d8-4906-b417-c4f98e35ca88",
        "text": "I'm guessing it's something like that having slept on it - pretty sure the latest should work - BF manage to get the name plus \"Res\" suffix into their price data. Just used the flumine market recorder out of the box I think but will have a look and see if I managed to break it ! Assume this is not normal otherwise others would have fallen over it before ?",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "ge46f1f8b708",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/e46f1f8b708a630e3191de7b2c42b1d1.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0023-72.png",
            "first_name": "edblock",
            "real_name": "edblock",
            "display_name": "foxwood",
            "team": "T4G9NBD2M",
            "name": "eanb",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1690822362.139579",
        "parent_user_id": "U02RN7YDRQ9",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "rZv",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "I'm guessing it's something like that having slept on it - pretty sure the latest should work - BF manage to get the name plus \"Res\" suffix into their price data. Just used the flumine market recorder out of the box I think but will have a look and see if I managed to break it ! Assume this is not normal otherwise others would have fallen over it before ?"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U4H19D1D2",
        "type": "message",
        "ts": "1690880912.194869",
        "client_msg_id": "48cd6c62-fee1-483f-acf7-5a0882f6b3bc",
        "text": "Move the code from `add_market` to `remove_market`",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "137c5a3ef323",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-03-15\/6819395173841_137c5a3ef323f1944a1a_72.png",
            "first_name": "liam",
            "real_name": "liam",
            "display_name": "liam",
            "team": "T4G9NBD2M",
            "name": "liam",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1690822362.139579",
        "parent_user_id": "U02RN7YDRQ9",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "OvM",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Move the code from "
                            },
                            {
                                "type": "text",
                                "text": "add_market",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " to "
                            },
                            {
                                "type": "text",
                                "text": "remove_market",
                                "style": {
                                    "code": true
                                }
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U4H19D1D2",
        "type": "message",
        "ts": "1690880916.305789",
        "client_msg_id": "8e5891c8-3f72-44dd-9e37-149f819bb407",
        "text": "done",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "137c5a3ef323",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-03-15\/6819395173841_137c5a3ef323f1944a1a_72.png",
            "first_name": "liam",
            "real_name": "liam",
            "display_name": "liam",
            "team": "T4G9NBD2M",
            "name": "liam",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1690822362.139579",
        "parent_user_id": "U02RN7YDRQ9",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "DtgVa",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "done"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U02RN7YDRQ9",
        "type": "message",
        "ts": "1690891255.469499",
        "edited": {
            "user": "U02RN7YDRQ9",
            "ts": "1690891372.000000"
        },
        "client_msg_id": "b8b5369b-a9a8-4f9f-b3fb-6df47a9e5402",
        "text": "Sorry, being thick and can't find module with suitable looking `add_market` The one in `marketcatalogue.py` is for reading existing file but I think the issue is that the latest json is not being written when the market is closed and\/or the market is cleaned up ?\n_load() in mktRecorder.py seems to be only place it's written ?",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "ge46f1f8b708",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/e46f1f8b708a630e3191de7b2c42b1d1.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0023-72.png",
            "first_name": "edblock",
            "real_name": "edblock",
            "display_name": "foxwood",
            "team": "T4G9NBD2M",
            "name": "eanb",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1690822362.139579",
        "parent_user_id": "U02RN7YDRQ9",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "CeN",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Sorry, being thick and can't find module with suitable looking "
                            },
                            {
                                "type": "text",
                                "text": "add_market",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " The one in "
                            },
                            {
                                "type": "text",
                                "text": "marketcatalogue.py",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " is for reading existing file but I think the issue is that the latest json is not being written when the market is closed and\/or the market is cleaned up ?\n_load() in mktRecorder.py seems to be only place it's written ?"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U4H19D1D2",
        "type": "message",
        "ts": "1690893931.615889",
        "client_msg_id": "f9e7b410-ec90-4a72-a079-f7384db0a974",
        "text": "Whoops I was confusing the middleware with the recorder, so the loading of the catalogue actually happens at the completion (closure) of a market so should therefore be the 'latest'",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "137c5a3ef323",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-03-15\/6819395173841_137c5a3ef323f1944a1a_72.png",
            "first_name": "liam",
            "real_name": "liam",
            "display_name": "liam",
            "team": "T4G9NBD2M",
            "name": "liam",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1690822362.139579",
        "parent_user_id": "U02RN7YDRQ9",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "TCr",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Whoops I was confusing the middleware with the recorder, so the loading of the catalogue actually happens at the completion (closure) of a market so should therefore be the 'latest'"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U4H19D1D2",
        "type": "message",
        "ts": "1690894045.586079",
        "client_msg_id": "941d99f4-79c7-43d1-8748-1ec2e1753aa7",
        "text": "When do betfair add the new runner? I assume before the market itself is closed? Even then we default force update to True so :confused:",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "137c5a3ef323",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-03-15\/6819395173841_137c5a3ef323f1944a1a_72.png",
            "first_name": "liam",
            "real_name": "liam",
            "display_name": "liam",
            "team": "T4G9NBD2M",
            "name": "liam",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1690822362.139579",
        "parent_user_id": "U02RN7YDRQ9",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "Ynuo",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "When do betfair add the new runner? I assume before the market itself is closed? Even then we default force update to True so "
                            },
                            {
                                "type": "emoji",
                                "name": "confused",
                                "unicode": "1f615"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U02RN7YDRQ9",
        "type": "message",
        "ts": "1690906164.570909",
        "client_msg_id": "7f7e6769-2654-4e9d-8ca3-a812da01c816",
        "text": "Digging around 7 json catalogue files for races with reserves on a specific day and none had the reserve runner in the catalogue. Looking at the data stream for 1 race the removal of a runner and addition of reserve (giving 7 in runners) takes place at 10:25. Race start time was 12:21. From INFO logs catalogue created 17:49 the previous day and no further mentions of market until closed at 12:24.\nSo ... either 1) I've added a clever bug (minor Windows extensions to `strategies\/marketrecorder.py` early 2022 - not using S3) 2) catalogue not updating by worker every 60 seconds as expected 3) worker not running 4) BF never update the catalogue for this ?\nIs there any way to force a catalogue update aka `poll_market_catalogue()` which would be good experiment to prove what is happening - can spot when changes expected since runners goes from 6 to 7 typically ?",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "ge46f1f8b708",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/e46f1f8b708a630e3191de7b2c42b1d1.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0023-72.png",
            "first_name": "edblock",
            "real_name": "edblock",
            "display_name": "foxwood",
            "team": "T4G9NBD2M",
            "name": "eanb",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1690822362.139579",
        "parent_user_id": "U02RN7YDRQ9",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "dgcw",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Digging around 7 json catalogue files for races with reserves on a specific day and none had the reserve runner in the catalogue. Looking at the data stream for 1 race the removal of a runner and addition of reserve (giving 7 in runners) takes place at 10:25. Race start time was 12:21. From INFO logs catalogue created 17:49 the previous day and no further mentions of market until closed at 12:24.\nSo ... either 1) I've added a clever bug (minor Windows extensions to "
                            },
                            {
                                "type": "text",
                                "text": "strategies\/marketrecorder.py",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " early 2022 - not using S3) 2) catalogue not updating by worker every 60 seconds as expected 3) worker not running 4) BF never update the catalogue for this ?\nIs there any way to force a catalogue update aka "
                            },
                            {
                                "type": "text",
                                "text": "poll_market_catalogue()",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " which would be good experiment to prove what is happening - can spot when changes expected since runners goes from 6 to 7 typically ?"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U02RN7YDRQ9",
        "type": "message",
        "ts": "1690908493.838669",
        "edited": {
            "user": "U02RN7YDRQ9",
            "ts": "1690908546.000000"
        },
        "client_msg_id": "da1aadd0-c102-4076-889b-c48d4a34da04",
        "text": "Just did a quick mod of `BFLWexampleone.py` to dump current live GH catalogues - lots of runner in latest catalogues today with `\"(res)\"` suffix where reserve taking place of original dog. Therefore issue when recording doesn't appear to be a BF issue.",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "ge46f1f8b708",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/e46f1f8b708a630e3191de7b2c42b1d1.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0023-72.png",
            "first_name": "edblock",
            "real_name": "edblock",
            "display_name": "foxwood",
            "team": "T4G9NBD2M",
            "name": "eanb",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1690822362.139579",
        "parent_user_id": "U02RN7YDRQ9",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "seX6D",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Just did a quick mod of "
                            },
                            {
                                "type": "text",
                                "text": "BFLWexampleone.py",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " to dump current live GH catalogues - lots of runner in latest catalogues today with "
                            },
                            {
                                "type": "text",
                                "text": "\"(res)\"",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " suffix where reserve taking place of original dog. Therefore issue when recording doesn't appear to be a BF issue."
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U4H19D1D2",
        "type": "message",
        "ts": "1690909108.410239",
        "client_msg_id": "A6F28695-CCD0-4A40-A1AE-9A99647D212C",
        "text": "Need to see your recorder code ",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "137c5a3ef323",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-03-15\/6819395173841_137c5a3ef323f1944a1a_72.png",
            "first_name": "liam",
            "real_name": "liam",
            "display_name": "liam",
            "team": "T4G9NBD2M",
            "name": "liam",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1690822362.139579",
        "parent_user_id": "U02RN7YDRQ9",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "Askp",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Need to see your recorder code "
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U02RN7YDRQ9",
        "type": "message",
        "ts": "1690914918.479839",
        "client_msg_id": "6e79a7d5-c6ae-4f7c-b922-422d2f8a0f4e",
        "text": "Market objects have a `__call()` method which flags a catalogue update needed when the `market_book.version` changes. That changes a few times when the reserve substitution takes place. Debugging the market recorder the `market_book` field for every event is set to `None` - is this the gotcha - no book when recording ?",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "ge46f1f8b708",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/e46f1f8b708a630e3191de7b2c42b1d1.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0023-72.png",
            "first_name": "edblock",
            "real_name": "edblock",
            "display_name": "foxwood",
            "team": "T4G9NBD2M",
            "name": "eanb",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1690822362.139579",
        "parent_user_id": "U02RN7YDRQ9",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "2a9o",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Market objects have a "
                            },
                            {
                                "type": "text",
                                "text": "__call()",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " method which flags a catalogue update needed when the "
                            },
                            {
                                "type": "text",
                                "text": "market_book.version",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " changes. That changes a few times when the reserve substitution takes place. Debugging the market recorder the "
                            },
                            {
                                "type": "text",
                                "text": "market_book",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " field for every event is set to "
                            },
                            {
                                "type": "text",
                                "text": "None",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " - is this the gotcha - no book when recording ?"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U4H19D1D2",
        "type": "message",
        "ts": "1690915224.507809",
        "client_msg_id": "FE8BA0EE-7B4B-4C58-B37B-242FD90EB243",
        "text": "Ah good spot, can you create a github issue and I can see if we can fix ",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "137c5a3ef323",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-03-15\/6819395173841_137c5a3ef323f1944a1a_72.png",
            "first_name": "liam",
            "real_name": "liam",
            "display_name": "liam",
            "team": "T4G9NBD2M",
            "name": "liam",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1690822362.139579",
        "parent_user_id": "U02RN7YDRQ9",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "kK3I",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Ah good spot, can you"
                            },
                            {
                                "type": "text",
                                "text": " create"
                            },
                            {
                                "type": "text",
                                "text": " a github issue and "
                            },
                            {
                                "type": "text",
                                "text": "I"
                            },
                            {
                                "type": "text",
                                "text": " can see "
                            },
                            {
                                "type": "text",
                                "text": "if"
                            },
                            {
                                "type": "text",
                                "text": " we can fix "
                            }
                        ]
                    }
                ]
            }
        ],
        "reactions": [
            {
                "name": "+1",
                "users": [
                    "U02RN7YDRQ9"
                ],
                "count": 1
            }
        ]
    },
    {
        "user": "U02RN7YDRQ9",
        "type": "message",
        "ts": "1690924353.467849",
        "client_msg_id": "fb3c87f7-df4d-481a-8c78-26166554e356",
        "text": "done - suggested dirty fix",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "ge46f1f8b708",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/e46f1f8b708a630e3191de7b2c42b1d1.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0023-72.png",
            "first_name": "edblock",
            "real_name": "edblock",
            "display_name": "foxwood",
            "team": "T4G9NBD2M",
            "name": "eanb",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1690822362.139579",
        "parent_user_id": "U02RN7YDRQ9",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "sVez",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "done - suggested dirty fix"
                            }
                        ]
                    }
                ]
            }
        ],
        "reactions": [
            {
                "name": "+1",
                "users": [
                    "U4H19D1D2"
                ],
                "count": 1
            }
        ]
    }
]