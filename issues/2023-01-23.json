[
    {
        "user": "U4H19D1D2",
        "type": "message",
        "ts": "1674466106.745359",
        "client_msg_id": "db67c951-2c4f-46ee-a4e1-efca9e48253a",
        "text": "Unless I am misunderstanding the question, we do void <https:\/\/github.com\/betcode-org\/flumine\/blob\/4a52d52899de4ee153d4a1774e2e7384e043dff9\/flumine\/markets\/middleware.py#L85|orders>",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "137c5a3ef323",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-03-15\/6819395173841_137c5a3ef323f1944a1a_72.png",
            "first_name": "liam",
            "real_name": "liam",
            "display_name": "liam",
            "team": "T4G9NBD2M",
            "name": "liam",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1674415607.879039",
        "parent_user_id": "U02RN7YDRQ9",
        "attachments": [
            {
                "id": 1,
                "footer_icon": "https:\/\/slack.github.com\/static\/img\/favicon-neutral.png",
                "color": "24292f",
                "bot_id": "B021ZJYSBMW",
                "app_unfurl_url": "https:\/\/github.com\/betcode-org\/flumine\/blob\/4a52d52899de4ee153d4a1774e2e7384e043dff9\/flumine\/markets\/middleware.py#L85",
                "is_app_unfurl": true,
                "app_id": "A01BP7R4KNY",
                "fallback": "<https:\/\/github.com\/betcode-org\/flumine\/blob\/4a52d52899de4ee153d4a1774e2e7384e043dff9\/flumine\/markets\/middleware.py | middleware.py>",
                "text": "```\n    def _process_runner_removal(\n```",
                "title": "<https:\/\/github.com\/betcode-org\/flumine\/blob\/4a52d52899de4ee153d4a1774e2e7384e043dff9\/flumine\/markets\/middleware.py | middleware.py>",
                "footer": "<https:\/\/github.com\/betcode-org\/flumine|betcode-org\/flumine>",
                "mrkdwn_in": [
                    "text"
                ]
            }
        ],
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "IrB",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Unless I am misunderstanding the question, we do void "
                            },
                            {
                                "type": "link",
                                "url": "https:\/\/github.com\/betcode-org\/flumine\/blob\/4a52d52899de4ee153d4a1774e2e7384e043dff9\/flumine\/markets\/middleware.py#L85",
                                "text": "orders"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U4H19D1D2",
        "type": "message",
        "ts": "1674466495.758029",
        "client_msg_id": "6d10c99d-83fd-4544-be1e-bb35e13f60cd",
        "text": "I am suddenly getting a flumine instance dying at 04:55 almost every morning, from memory betfair do some currency calculations at around this time? Anyone else?",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "137c5a3ef323",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-03-15\/6819395173841_137c5a3ef323f1944a1a_72.png",
            "first_name": "liam",
            "real_name": "liam",
            "display_name": "liam",
            "team": "T4G9NBD2M",
            "name": "liam",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1674466495.758029",
        "reply_count": 5,
        "reply_users_count": 4,
        "latest_reply": "1674495099.627409",
        "reply_users": [
            "U4H19D1D2",
            "UUCD6P13J",
            "U01B8031PM1",
            "UQL0QDEKA"
        ],
        "replies": [
            {
                "user": "U4H19D1D2",
                "ts": "1674466619.518969"
            },
            {
                "user": "UUCD6P13J",
                "ts": "1674467151.225709"
            },
            {
                "user": "U01B8031PM1",
                "ts": "1674468373.672979"
            },
            {
                "user": "U4H19D1D2",
                "ts": "1674468532.346209"
            },
            {
                "user": "UQL0QDEKA",
                "ts": "1674495099.627409"
            }
        ],
        "is_locked": false,
        "subscribed": true,
        "last_read": "1674495099.627409",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "4OwW",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "I am suddenly getting a flumine instance dying at 04:55 almost every morning, from memory betfair do some currency calculations at around this time? Anyone else?"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "text": "Example from Sunday morning when CPU went through the roof",
        "files": [
            {
                "id": "F04KVGAG5PG",
                "mode": "hidden_by_limit"
            }
        ],
        "upload": false,
        "user": "U4H19D1D2",
        "display_as_bot": false,
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "vRKw",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Example from Sunday morning when CPU went through the roof"
                            }
                        ]
                    }
                ]
            }
        ],
        "type": "message",
        "ts": "1674466619.518969",
        "client_msg_id": "dc60da1c-6e9d-4404-bc6a-7bb5ffd3f9e1",
        "thread_ts": "1674466495.758029",
        "parent_user_id": "U4H19D1D2"
    },
    {
        "user": "UUCD6P13J",
        "type": "message",
        "ts": "1674467151.225709",
        "client_msg_id": "9d0ab4ca-c9a5-4f64-845f-f215b2d2a56d",
        "text": "no issues my end",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "g6898272ab81",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/6898272ab810e419c2c9ca9af1e53da8.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0012-72.png",
            "first_name": "Lee",
            "real_name": "Lee U",
            "display_name": "Lee",
            "team": "T4G9NBD2M",
            "name": "lunswor",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1674466495.758029",
        "parent_user_id": "U4H19D1D2",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "HuWpR",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "no issues my end"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U01B8031PM1",
        "type": "message",
        "ts": "1674468373.672979",
        "client_msg_id": "8b9ece57-1a5f-4083-b4f7-a169f2d72416",
        "text": "no issues here either",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "g6e482a0e41b",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/6e482a0e41b232f48d801454006dfa56.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0016-72.png",
            "first_name": "river_shah",
            "real_name": "river_shah",
            "display_name": "river_shah",
            "team": "T4G9NBD2M",
            "name": "ansar.sa",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1674466495.758029",
        "parent_user_id": "U4H19D1D2",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "Toh0j",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "no issues here either"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U4H19D1D2",
        "type": "message",
        "ts": "1674468532.346209",
        "client_msg_id": "6dab1edb-ab8b-48f2-b160-27fdc22c1548",
        "text": ":thinking_face:",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "137c5a3ef323",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-03-15\/6819395173841_137c5a3ef323f1944a1a_72.png",
            "first_name": "liam",
            "real_name": "liam",
            "display_name": "liam",
            "team": "T4G9NBD2M",
            "name": "liam",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1674466495.758029",
        "parent_user_id": "U4H19D1D2",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "kwk",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "emoji",
                                "name": "thinking_face",
                                "unicode": "1f914"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U02RN7YDRQ9",
        "type": "message",
        "ts": "1674471316.799309",
        "client_msg_id": "4abd008f-6d67-42fa-ba56-97b67e4d7491",
        "text": "Think it might have been a thread timing \/ sequence issue ? Did go through the blotter code (and checked latest version since am running 2.0.1 !). In `check_market_book` I walk the orders in `for order in market.blotter:` The order was in that set although the runner status was `REMOVED` Looking at the simulated packet time this situation arose on the first data packet milliseconds after the removal timestamp. My guess was that the order thread hadn't got round to dealing with this yet and that the strategy had got there first and saw this as a good order. Since <@U9JHLMZB4> confirmed what should happen I put some defensive code `if not self.isActiveRunner(market_book, order.selection_id): continue` in the loop to check and this solved the issue.",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "ge46f1f8b708",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/e46f1f8b708a630e3191de7b2c42b1d1.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0023-72.png",
            "first_name": "edblock",
            "real_name": "edblock",
            "display_name": "foxwood",
            "team": "T4G9NBD2M",
            "name": "eanb",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1674415607.879039",
        "parent_user_id": "U02RN7YDRQ9",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "AFL6",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Think it might have been a thread timing \/ sequence issue ? Did go through the blotter code (and checked latest version since am running 2.0.1 !). In "
                            },
                            {
                                "type": "text",
                                "text": "check_market_book",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " I walk the orders in "
                            },
                            {
                                "type": "text",
                                "text": "for order in market.blotter:",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " The order was in that set although the runner status was "
                            },
                            {
                                "type": "text",
                                "text": "REMOVED ",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": "Looking at the simulated packet time this situation arose on the first data packet milliseconds after the removal timestamp. My guess was that the order thread hadn't got round to dealing with this yet and that the strategy had got there first and saw this as a good order. Since "
                            },
                            {
                                "type": "user",
                                "user_id": "U9JHLMZB4"
                            },
                            {
                                "type": "text",
                                "text": " confirmed what should happen I put some defensive code "
                            },
                            {
                                "type": "text",
                                "text": "if not self.isActiveRunner(market_book, order.selection_id): continue",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " in the loop to check and this solved the issue."
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U4H19D1D2",
        "type": "message",
        "ts": "1674471394.284379",
        "client_msg_id": "cffd0b5b-cce7-4f54-94f0-a32e9561628f",
        "text": "its middleware so is executed before you received the book, the logs will tell you",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "137c5a3ef323",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-03-15\/6819395173841_137c5a3ef323f1944a1a_72.png",
            "first_name": "liam",
            "real_name": "liam",
            "display_name": "liam",
            "team": "T4G9NBD2M",
            "name": "liam",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1674415607.879039",
        "parent_user_id": "U02RN7YDRQ9",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "us7Ei",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "its middleware so is executed before you received the book, the logs will tell you"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U02RN7YDRQ9",
        "type": "message",
        "ts": "1674482861.477349",
        "client_msg_id": "5bfbbdcd-62d6-4cab-9f9c-8bfb7f0c942f",
        "text": "mmm - thought that should be the case - forget it for now since not sure market it happened on, and code has moved on since. Doesn't normally seem to be an issue and dogs are being pulled all the time so prob trying to blame my bug on the removal :grin:",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "ge46f1f8b708",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/e46f1f8b708a630e3191de7b2c42b1d1.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0023-72.png",
            "first_name": "edblock",
            "real_name": "edblock",
            "display_name": "foxwood",
            "team": "T4G9NBD2M",
            "name": "eanb",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1674415607.879039",
        "parent_user_id": "U02RN7YDRQ9",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "NW57z",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "mmm - thought that should be the case - forget it for now since not sure market it happened on, and code has moved on since. Doesn't normally seem to be an issue and dogs are being pulled all the time so prob trying to blame my bug on the removal "
                            },
                            {
                                "type": "emoji",
                                "name": "grin",
                                "unicode": "1f601"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "UQL0QDEKA",
        "type": "message",
        "ts": "1674495099.627409",
        "client_msg_id": "53904433-ca3f-4a89-8b40-a4fbc6e9980e",
        "text": "Sorry late reply, but no issues from mine either",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "g444d10128c0",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/444d10128c0aaf094041a52a76796602.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0005-72.png",
            "first_name": "Peter",
            "real_name": "Peter Lenagh",
            "display_name": "PeterLe",
            "team": "T4G9NBD2M",
            "name": "lenagh",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1674466495.758029",
        "parent_user_id": "U4H19D1D2",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "NCHEl",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Sorry late reply, but no issues from mine either"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U9JHLMZB4",
        "type": "message",
        "ts": "1674496006.043139",
        "client_msg_id": "53e511b2-a054-4851-b7b4-3c437233fa72",
        "text": "My apologies <@U02RN7YDRQ9>. I was completely unaware of the piece of middleware to which <@U4H19D1D2> refers. This one clever pice of software!!",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "g951ddcb43e7",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/3951ddcb43e788a387d6daf330dad5ca.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0018-72.png",
            "first_name": "",
            "real_name": "Peter Coles",
            "display_name": "Peter",
            "team": "T4G9NBD2M",
            "name": "peter",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1674415607.879039",
        "parent_user_id": "U02RN7YDRQ9",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "GzYv",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "My apologies "
                            },
                            {
                                "type": "user",
                                "user_id": "U02RN7YDRQ9"
                            },
                            {
                                "type": "text",
                                "text": ". I was completely unaware of the piece of middleware to which "
                            },
                            {
                                "type": "user",
                                "user_id": "U4H19D1D2"
                            },
                            {
                                "type": "text",
                                "text": " refers. This one clever pice of software!!"
                            }
                        ]
                    }
                ]
            }
        ],
        "reactions": [
            {
                "name": "grinning",
                "users": [
                    "U4H19D1D2"
                ],
                "count": 1
            }
        ]
    },
    {
        "user": "U02RN7YDRQ9",
        "type": "message",
        "ts": "1674506947.159409",
        "client_msg_id": "f4325f67-4c71-41eb-81bb-168ee5201ea2",
        "text": "lol no need to apologize - straightened out my thinking thanks",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "ge46f1f8b708",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/e46f1f8b708a630e3191de7b2c42b1d1.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0023-72.png",
            "first_name": "edblock",
            "real_name": "edblock",
            "display_name": "foxwood",
            "team": "T4G9NBD2M",
            "name": "eanb",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1674415607.879039",
        "parent_user_id": "U02RN7YDRQ9",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "Ze8y",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "lol no need to apologize - straightened out my thinking thanks"
                            }
                        ]
                    }
                ]
            }
        ]
    }
]