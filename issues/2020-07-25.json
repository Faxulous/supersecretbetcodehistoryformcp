[
    {
        "user": "U012ZFYR19V",
        "type": "message",
        "ts": "1595670554.456700",
        "client_msg_id": "e2a582bf-ddf7-4108-8892-9d5b9a3114fa",
        "text": "Happy weekend chaps!\nI've been using the examplestreaminghistorical.py from BFLW to run through some of the historical data files offered by Betfair recently. It's been working great.. except when I run through a Greyhound file where a reserve runner replaces the original. This seems to happen at least once per meeting and the whole thing chokes.\n\nI haven't touched anything except the location of each data file (obviously!) According to the Traceback, it's tripping up over a number of processes and I haven't a clue where to start.\n\nI've updated BFLW to 2.6.0 and I'm using the out-of-the-box examplestreaminghistorical.py without modification.\n\nHas anyone else come across the same thing and can point me in the right direction? Cheers!\n\n```Traceback (most recent call last):\n  File \"G:\/python\/scratchpad\/examplestreaminghistorical.py\", line 34, in &lt;module&gt;\n    for market_books in gen():\n  File \"C:\\Users\\Mark\\AppData\\Local\\Programs\\Python\\Python38-32\\lib\\site-packages\\betfairlightweight\\streaming\\betfairstream.py\", line 326, in _read_loop\n    if self.listener.on_data(update) is False:\n  File \"C:\\Users\\Mark\\AppData\\Local\\Programs\\Python\\Python38-32\\lib\\site-packages\\betfairlightweight\\streaming\\listener.py\", line 127, in on_data\n    self._on_change_message(data, unique_id)\n  File \"C:\\Users\\Mark\\AppData\\Local\\Programs\\Python\\Python38-32\\lib\\site-packages\\betfairlightweight\\streaming\\listener.py\", line 167, in _on_change_message\n    self.stream.on_update(data)\n  File \"C:\\Users\\Mark\\AppData\\Local\\Programs\\Python\\Python38-32\\lib\\site-packages\\betfairlightweight\\streaming\\stream.py\", line 59, in on_update\n    self._process(data[self._lookup], publish_time)\n  File \"C:\\Users\\Mark\\AppData\\Local\\Programs\\Python\\Python38-32\\lib\\site-packages\\betfairlightweight\\streaming\\stream.py\", line 152, in _process\n    market_book_cache.create_resource(\n  File \"C:\\Users\\Mark\\AppData\\Local\\Programs\\Python\\Python38-32\\lib\\site-packages\\betfairlightweight\\streaming\\cache.py\", line 218, in create_resource\n    data = self.serialise\n  File \"C:\\Users\\Mark\\AppData\\Local\\Programs\\Python\\Python38-32\\lib\\site-packages\\betfairlightweight\\streaming\\cache.py\", line 267, in serialise\n    \"runners\": [\n  File \"C:\\Users\\Mark\\AppData\\Local\\Programs\\Python\\Python38-32\\lib\\site-packages\\betfairlightweight\\streaming\\cache.py\", line 269, in &lt;listcomp&gt;\n    self.market_definition_runner_dict[\nKeyError: (27395886, 0)\n\nProcess finished with exit code 1```",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "gc2fb110e7c7",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/c2fb110e7c721641bc12bcf47335fbfd.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0025-72.png",
            "first_name": "Mark",
            "real_name": "Mark Heywood",
            "display_name": "Mark",
            "team": "T4G9NBD2M",
            "name": "mark842",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "yoyC",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Happy weekend chaps!\nI've been using the examplestreaminghistorical.py from BFLW to run through some of the historical data files offered by Betfair recently. It's been working great.. except when I run through a Greyhound file where a reserve runner replaces the original. This seems to happen at least once per meeting and the whole thing chokes.\n\nI haven't touched anything except the location of each data file (obviously!) According to the Traceback, it's tripping up over a number of processes and I haven't a clue where to start.\n\nI've updated BFLW to 2.6.0 and I'm using the out-of-the-box examplestreaminghistorical.py without modification.\n\nHas anyone else come across the same thing and can point me in the right direction? Cheers!\n\n"
                            }
                        ]
                    },
                    {
                        "type": "rich_text_preformatted",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Traceback (most recent call last):\n  File \"G:\/python\/scratchpad\/examplestreaminghistorical.py\", line 34, in <module>\n    for market_books in gen():\n  File \"C:\\Users\\Mark\\AppData\\Local\\Programs\\Python\\Python38-32\\lib\\site-packages\\betfairlightweight\\streaming\\betfairstream.py\", line 326, in _read_loop\n    if self.listener.on_data(update) is False:\n  File \"C:\\Users\\Mark\\AppData\\Local\\Programs\\Python\\Python38-32\\lib\\site-packages\\betfairlightweight\\streaming\\listener.py\", line 127, in on_data\n    self._on_change_message(data, unique_id)\n  File \"C:\\Users\\Mark\\AppData\\Local\\Programs\\Python\\Python38-32\\lib\\site-packages\\betfairlightweight\\streaming\\listener.py\", line 167, in _on_change_message\n    self.stream.on_update(data)\n  File \"C:\\Users\\Mark\\AppData\\Local\\Programs\\Python\\Python38-32\\lib\\site-packages\\betfairlightweight\\streaming\\stream.py\", line 59, in on_update\n    self._process(data[self._lookup], publish_time)\n  File \"C:\\Users\\Mark\\AppData\\Local\\Programs\\Python\\Python38-32\\lib\\site-packages\\betfairlightweight\\streaming\\stream.py\", line 152, in _process\n    market_book_cache.create_resource(\n  File \"C:\\Users\\Mark\\AppData\\Local\\Programs\\Python\\Python38-32\\lib\\site-packages\\betfairlightweight\\streaming\\cache.py\", line 218, in create_resource\n    data = self.serialise\n  File \"C:\\Users\\Mark\\AppData\\Local\\Programs\\Python\\Python38-32\\lib\\site-packages\\betfairlightweight\\streaming\\cache.py\", line 267, in serialise\n    \"runners\": [\n  File \"C:\\Users\\Mark\\AppData\\Local\\Programs\\Python\\Python38-32\\lib\\site-packages\\betfairlightweight\\streaming\\cache.py\", line 269, in <listcomp>\n    self.market_definition_runner_dict[\nKeyError: (27395886, 0)\n\nProcess finished with exit code 1"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U4H19D1D2",
        "type": "message",
        "ts": "1595670725.457200",
        "client_msg_id": "597773F2-B7D9-47FE-BCB7-38AA17ECFFE1",
        "text": "Never seen this before, can you share the historical file? ",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "137c5a3ef323",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-03-15\/6819395173841_137c5a3ef323f1944a1a_72.png",
            "first_name": "liam",
            "real_name": "liam",
            "display_name": "liam",
            "team": "T4G9NBD2M",
            "name": "liam",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "q5HZI",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Never seen this before, can you share the historical file? "
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "text": "Thanks, here it is:",
        "files": [
            {
                "id": "F018EDYKJ4Q",
                "mode": "hidden_by_limit"
            }
        ],
        "upload": false,
        "user": "U012ZFYR19V",
        "display_as_bot": false,
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "53gk2",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Thanks, here it is:"
                            }
                        ]
                    }
                ]
            }
        ],
        "type": "message",
        "ts": "1595671063.457500"
    },
    {
        "user": "U016TGY3676",
        "type": "message",
        "ts": "1595672547.460800",
        "client_msg_id": "802da7c5-c490-49f5-ad45-08a778ad5363",
        "text": "<@U4H19D1D2> I've seen this before in my own code and it's a PITA. I've overcome it by treating it as a new market from the point when the reserve runner was added.",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "g6a681220e11",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/6a681220e11c1a2ed3685375d658dadb.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0001-72.png",
            "first_name": "",
            "real_name": "birchy",
            "display_name": "birchy",
            "team": "T4G9NBD2M",
            "name": "birchy",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "vdcyr",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "user",
                                "user_id": "U4H19D1D2"
                            },
                            {
                                "type": "text",
                                "text": " I've seen this before in my own code and it's a PITA. I've overcome it by treating it as a new market from the point when the reserve runner was added."
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U4H19D1D2",
        "type": "message",
        "ts": "1595676052.461000",
        "client_msg_id": "d41a03d9-ca68-4234-bd44-036ccac9bcab",
        "text": "Issue created <https:\/\/github.com\/liampauling\/betfair\/issues\/320>",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "137c5a3ef323",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-03-15\/6819395173841_137c5a3ef323f1944a1a_72.png",
            "first_name": "liam",
            "real_name": "liam",
            "display_name": "liam",
            "team": "T4G9NBD2M",
            "name": "liam",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "attachments": [
            {
                "author_name": "liampauling",
                "fallback": "[liampauling\/betfair] #320 Streaming error: reserve runners",
                "text": "Bug within streaming code when reserve runner added to market:\n\n```\nTraceback (most recent call last):\n  File \"G:\/python\/scratchpad\/examplestreaminghistorical.py\", line 34, in &lt;module&gt;\n    for market_books in gen():\n  File \"C:\\Users\\Mark\\AppData\\Local\\Programs\\Python\\Python38-32\\lib\\site-packages\\betfairlightweight\\streaming\\betfairstream.py\", line 326, in _read_loop\n    if self.listener.on_data(update) is False:\n  File \"C:\\Users\\Mark\\AppData\\Local\\Programs\\Python\\Python38-32\\lib\\site-packages\\betfairlightweight\\streaming\\listener.py\", line 127, in on_data\n    self._on_change_message(data, unique_id)\n  File \"C:\\Users\\Mark\\AppData\\Local\\Programs\\Python\\Python38-32\\lib\\site-packages\\betfairlightweight\\streaming\\listener.py\", line 167, in _on_change_message\n    self.stream.on_update(data)\n  File \"C:\\Users\\Mark\\AppData\\Local\\Programs\\Python\\Python38-32\\lib\\site-packages\\betfairlightweight\\streaming\\stream.py\", line 59, in on_update\n    self._process(data[self._lookup], publish_time)\n  File \"C:\\Users\\Mark\\AppData\\Local\\Programs\\Python\\Python38-32\\lib\\site-packages\\betfairlightweight\\streaming\\stream.py\", line 152, in _process\n    market_book_cache.create_resource(\n  File \"C:\\Users\\Mark\\AppData\\Local\\Programs\\Python\\Python38-32\\lib\\site-packages\\betfairlightweight\\streaming\\cache.py\", line 218, in create_resource\n    data = self.serialise\n  File \"C:\\Users\\Mark\\AppData\\Local\\Programs\\Python\\Python38-32\\lib\\site-packages\\betfairlightweight\\streaming\\cache.py\", line 267, in serialise\n    \"runners\": [\n  File \"C:\\Users\\Mark\\AppData\\Local\\Programs\\Python\\Python38-32\\lib\\site-packages\\betfairlightweight\\streaming\\cache.py\", line 269, in &lt;listcomp&gt;\n    self.market_definition_runner_dict[\nKeyError: (27395886, 0)\nProcess finished with exit code 1\n```\n\nExample market attached.  \n<https:\/\/github.com\/liampauling\/betfair\/files\/4975453\/1.166899801.zip|1.166899801.zip>",
                "title": "#320 Streaming error: reserve runners",
                "footer": "<https:\/\/github.com\/liampauling\/betfair|liampauling\/betfair>",
                "id": 1,
                "title_link": "https:\/\/github.com\/liampauling\/betfair\/issues\/320",
                "author_link": "https:\/\/github.com\/liampauling",
                "author_icon": "https:\/\/avatars3.githubusercontent.com\/u\/12016537?v=4",
                "footer_icon": "https:\/\/github.githubassets.com\/favicon.ico",
                "ts": 1595676036,
                "color": "36a64f",
                "fields": [
                    {
                        "title": "Labels",
                        "value": "bug",
                        "short": true
                    }
                ],
                "mrkdwn_in": [
                    "text"
                ],
                "bot_id": "B01144Z0734",
                "app_unfurl_url": "https:\/\/github.com\/liampauling\/betfair\/issues\/320",
                "is_app_unfurl": true
            }
        ],
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "+7H",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Issue created "
                            },
                            {
                                "type": "link",
                                "url": "https:\/\/github.com\/liampauling\/betfair\/issues\/320"
                            }
                        ]
                    }
                ]
            }
        ],
        "reactions": [
            {
                "name": "+1",
                "users": [
                    "U012ZFYR19V"
                ],
                "count": 1
            }
        ]
    },
    {
        "subtype": "channel_join",
        "user": "U017NPYRVHR",
        "text": "<@U017NPYRVHR> has joined the channel",
        "type": "message",
        "ts": "1595677713.461200"
    }
]