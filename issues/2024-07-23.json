[
    {
        "user": "U06DURYFXK7",
        "type": "message",
        "ts": "1721726758.492749",
        "client_msg_id": "50748bc3-39f9-4cef-9699-e948a622d2d1",
        "text": "<@U4H19D1D2>, would you be willing to share an example of how to use transactions? I'm trying to write some code that enforces an order flow for one runner, only one workflow allowed for that runner at a time ie trigger-&gt;place open trade-&gt;open trade matched-&gt;place close trade-&gt;close trade matched-&gt;waiting (and handle cancelling etc) but if this can help...",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "e397ac707759",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-01-15\/6473811233506_e397ac707759c168298e_72.png",
            "first_name": "Jared",
            "real_name": "Jared King",
            "display_name": "Jared King",
            "team": "T4G9NBD2M",
            "name": "jaristyking",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1721026619.244079",
        "parent_user_id": "U04NWADNCFR",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "QRTn5",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "user",
                                "user_id": "U4H19D1D2"
                            },
                            {
                                "type": "text",
                                "text": ", would you be willing to share an example of how to use transactions? I'm trying to write some code that enforces an order flow for one runner, only one workflow allowed for that runner at a time ie trigger->place open trade->open trade matched->place close trade->close trade matched->waiting (and handle cancelling etc) but if this can help..."
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U4H19D1D2",
        "type": "message",
        "ts": "1721727509.639289",
        "client_msg_id": "ee4290c2-a9f8-4f0d-86f2-fcb7d7194ddc",
        "text": "Sounds like you just want to use a trade \/ multiple orders and limit using `max_live_trade_count` on the strategy",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "137c5a3ef323",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-03-15\/6819395173841_137c5a3ef323f1944a1a_72.png",
            "first_name": "liam",
            "real_name": "liam",
            "display_name": "liam",
            "team": "T4G9NBD2M",
            "name": "liam",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1721026619.244079",
        "parent_user_id": "U04NWADNCFR",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "fQnq3",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Sounds like you just want to use a trade \/ multiple orders and limit using "
                            },
                            {
                                "type": "text",
                                "text": "max_live_trade_count",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " on the strategy"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U06DURYFXK7",
        "type": "message",
        "ts": "1721728186.088229",
        "client_msg_id": "1aaca584-0397-4ff1-a226-37dfb45b9788",
        "text": "Relying on `max_live_trade_count` seemed a bit like I wasn't writing good code. Also, I'm fairly challenged in the mental department.",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "e397ac707759",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-01-15\/6473811233506_e397ac707759c168298e_72.png",
            "first_name": "Jared",
            "real_name": "Jared King",
            "display_name": "Jared King",
            "team": "T4G9NBD2M",
            "name": "jaristyking",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1721026619.244079",
        "parent_user_id": "U04NWADNCFR",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "8zHRg",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Relying on "
                            },
                            {
                                "type": "text",
                                "text": "max_live_trade_count",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " seemed a bit like I wasn't writing good code. Also, I'm fairly challenged in the mental department."
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U4H19D1D2",
        "type": "message",
        "ts": "1721728296.234239",
        "client_msg_id": "f64677ee-44bf-47ee-b52d-18d74966b826",
        "text": "Check it yourself instead\n\n```runner_context = self.get_runner_context(market_id, selection_id, handicap)\nif runner_context.live_trade_count == 0:\n    do shit```",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "137c5a3ef323",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-03-15\/6819395173841_137c5a3ef323f1944a1a_72.png",
            "first_name": "liam",
            "real_name": "liam",
            "display_name": "liam",
            "team": "T4G9NBD2M",
            "name": "liam",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1721026619.244079",
        "parent_user_id": "U04NWADNCFR",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "k5bJ4",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Check it yourself instead\n\n"
                            }
                        ]
                    },
                    {
                        "type": "rich_text_preformatted",
                        "elements": [
                            {
                                "type": "text",
                                "text": "runner_context = self.get_runner_context(market_id, selection_id, handicap)\nif runner_context.live_trade_count == 0:\n    do shit"
                            }
                        ],
                        "border": 0
                    }
                ]
            }
        ]
    },
    {
        "user": "U4H19D1D2",
        "type": "message",
        "ts": "1721728329.774659",
        "client_msg_id": "9d33e808-0bea-439a-84bb-05e9a26f132c",
        "text": "<https:\/\/github.com\/betcode-org\/flumine\/blob\/master\/flumine\/strategy\/runnercontext.py>",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "137c5a3ef323",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-03-15\/6819395173841_137c5a3ef323f1944a1a_72.png",
            "first_name": "liam",
            "real_name": "liam",
            "display_name": "liam",
            "team": "T4G9NBD2M",
            "name": "liam",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1721026619.244079",
        "parent_user_id": "U04NWADNCFR",
        "attachments": [
            {
                "id": 1,
                "footer_icon": "https:\/\/slack.github.com\/static\/img\/favicon-neutral.png",
                "color": "24292f",
                "bot_id": "B021ZJYSBMW",
                "app_unfurl_url": "https:\/\/github.com\/betcode-org\/flumine\/blob\/master\/flumine\/strategy\/runnercontext.py",
                "is_app_unfurl": true,
                "app_id": "A01BP7R4KNY",
                "fallback": "<https:\/\/github.com\/betcode-org\/flumine\/blob\/master\/flumine\/strategy\/runnercontext.py | runnercontext.py>",
                "text": "```\nimport logging\nimport datetime\nfrom typing import Optional\n\nlogger = logging.getLogger(__name__)\n\n\nclass RunnerContext:\n    \"\"\"Runner context at strategy level\"\"\"\n\n    def __init__(self, selection_id: int):\n        self.selection_id = selection_id\n        self.invested = False\n        self.datetime_last_placed = None\n        self.datetime_last_reset = None\n        self.trades = []\n        self.live_trades = []\n\n    def place(self, trade_id) -> None:\n        self.invested = True\n        self.datetime_last_placed = datetime.datetime.utcnow()\n        if trade_id not in self.trades:\n            self.trades.append(trade_id)\n        if trade_id not in self.live_trades:\n            self.live_trades.append(trade_id)\n\n    def reset(self, trade_id) -> None:\n        self.datetime_last_reset = datetime.datetime.utcnow()\n        try:\n            self.live_trades.remove(trade_id)\n        except ValueError:\n            logger.warning(\n                \"Trade '%s' not present in RunnerContext live_trades on reset\"\n                % trade_id\n            )\n\n    @property\n    def executable_orders(self) -> bool:\n        if self.live_trades:\n            return True\n        else:\n            return False\n\n    @property\n    def trade_count(self) -> int:\n        return len(self.trades)\n\n    @property\n    def live_trade_count(self) -> int:\n        return len(self.live_trades)\n\n    @property\n    def placed_elapsed_seconds(self) -> Optional[float]:\n        if self.datetime_last_placed:\n            return (\n                datetime.datetime.utcnow() - self.datetime_last_placed\n            ).total_seconds()\n\n    @property\n    def reset_elapsed_seconds(self) -> Optional[float]:\n        if self.datetime_last_reset:\n            return (\n                datetime.datetime.utcnow() - self.datetime_last_reset\n            ).total_seconds()\n\n```",
                "title": "<https:\/\/github.com\/betcode-org\/flumine\/blob\/master\/flumine\/strategy\/runnercontext.py | runnercontext.py>",
                "footer": "<https:\/\/github.com\/betcode-org\/flumine|betcode-org\/flumine>",
                "mrkdwn_in": [
                    "text"
                ]
            }
        ],
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "SY8d1",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "link",
                                "url": "https:\/\/github.com\/betcode-org\/flumine\/blob\/master\/flumine\/strategy\/runnercontext.py"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U06DURYFXK7",
        "type": "message",
        "ts": "1721728359.457379",
        "client_msg_id": "5cf92851-0571-4003-80dd-c35c68974c95",
        "text": "rgr that. fixed your code:\n```runner_context = self.get_runner_context(market_id, selection_id, handicap)\nif runner_context.live_trade_count == 0:\n    lose money```",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "e397ac707759",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-01-15\/6473811233506_e397ac707759c168298e_72.png",
            "first_name": "Jared",
            "real_name": "Jared King",
            "display_name": "Jared King",
            "team": "T4G9NBD2M",
            "name": "jaristyking",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1721026619.244079",
        "parent_user_id": "U04NWADNCFR",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "B94sq",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "rgr that. fixed your code:\n"
                            }
                        ]
                    },
                    {
                        "type": "rich_text_preformatted",
                        "elements": [
                            {
                                "type": "text",
                                "text": "runner_context = self.get_runner_context(market_id, selection_id, handicap)\nif runner_context.live_trade_count == 0:\n    lose money"
                            }
                        ],
                        "border": 0
                    }
                ]
            }
        ]
    },
    {
        "user": "U4H19D1D2",
        "type": "message",
        "ts": "1721728405.687629",
        "client_msg_id": "bafb80be-7cb4-41fe-8773-6ada8848d667",
        "text": "perfect",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "137c5a3ef323",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-03-15\/6819395173841_137c5a3ef323f1944a1a_72.png",
            "first_name": "liam",
            "real_name": "liam",
            "display_name": "liam",
            "team": "T4G9NBD2M",
            "name": "liam",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1721026619.244079",
        "parent_user_id": "U04NWADNCFR",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "FjF5N",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "perfect"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U4H19D1D2",
        "type": "message",
        "ts": "1721728430.393469",
        "client_msg_id": "5de307d3-2f03-481b-b8a5-f688b7ad5f55",
        "text": "the transaction class is for controlling how your orders are executed to betfair",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "137c5a3ef323",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-03-15\/6819395173841_137c5a3ef323f1944a1a_72.png",
            "first_name": "liam",
            "real_name": "liam",
            "display_name": "liam",
            "team": "T4G9NBD2M",
            "name": "liam",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1721026619.244079",
        "parent_user_id": "U04NWADNCFR",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "JRrE3",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "the transaction class is for controlling how your orders are executed to betfair"
                            }
                        ]
                    }
                ]
            }
        ],
        "reactions": [
            {
                "name": "+1",
                "users": [
                    "U06DURYFXK7"
                ],
                "count": 1
            }
        ]
    }
]