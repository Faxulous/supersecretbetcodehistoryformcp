[
    {
        "user": "U04980ZT6UX",
        "type": "message",
        "ts": "1669482755.162789",
        "client_msg_id": "f1ab695b-20fe-47c3-a9fe-d6da1fe05071",
        "text": "Hi gents,\nQuestions related to *BaseStrategy:*\nQ1 : It receives  `market_filter` and `market_data_filter` as arguments. Does it automatically update the markets based on these filters? Eg.: If on day 24 Nov the Market M doesn't pass through the filters, but on day 25 Nov it does, will the strategy automatically include this market on Nov 25 without me restarting the code? If not, is there an alternative to restarting the code every X hours? As it would stop the strategy during the restart time, which is risky for trading and would make me loose data for data recording.\n\nQ2: I am trying to find a way to filter markets for which I want to store data using the *MarketRecorder* strategy in the examples.\nI want to fetch football matches, but if I filter by:\n```market_filter=betfairlightweight.filters.streaming_market_filter(\n    event_type_ids=[\"1\"],\n    market_types=[\"MATCH_ODDS\"],\n    betting_types=[\"ODDS\"],\n),```\n I get:\n`{\"asctime\": \"2022-11-26 16:40:19,795\", \"levelname\": \"ERROR\", \"message\": \"[FlumineStream: 2001]: SUBSCRIPTION_LIMIT_EXCEEDED: trying to subscribe to 505 markets whereas max allowed number was: 200\"}`\n\nI could obviously get a reduced number of  market_ids myself by doing:\n```filter = betfairlightweight.filters.market_filter(event_type_ids=[1], market_start_time={'from': datetime_from, 'to': datetime_to})\nself.trading.betting.list_events(filter=filter)```\nBut then I would have static ids and certainly would have to restart the program to fetch the new markets, which is a problem as described above.\n\nWhat would be the recommended way to reduce the subset of markets while avoiding having static market_ids ?",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "gb1b2f82a1a4",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/b1b2f82a1a49a547cbc7487b48805187.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0017-72.png",
            "first_name": "AI",
            "real_name": "AI Trader",
            "display_name": "AI Trader",
            "team": "T4G9NBD2M",
            "name": "menocineto",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "Cg1f",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Hi gents,\nQuestions related to "
                            },
                            {
                                "type": "text",
                                "text": "BaseStrategy:",
                                "style": {
                                    "bold": true
                                }
                            },
                            {
                                "type": "text",
                                "text": "\nQ1 : It receives  "
                            },
                            {
                                "type": "text",
                                "text": "market_filter",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " and "
                            },
                            {
                                "type": "text",
                                "text": "market_data_filter",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " as arguments. Does it automatically update the markets based on these filters? Eg.: If on day 24 Nov the Market M doesn't pass through the filters, but on day 25 Nov it does, will the strategy automatically include this market on Nov 25 without me restarting the code? If not, is there an alternative to restarting the code every X hours? As it would stop the strategy during the restart time, which is risky for trading and would make me loose data for data recording.\n\nQ2: I am trying to find a way to filter markets for which I want to store data using the "
                            },
                            {
                                "type": "text",
                                "text": "MarketRecorder",
                                "style": {
                                    "bold": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " strategy in the examples.\nI want to fetch football matches, but if I filter by:\n"
                            }
                        ]
                    },
                    {
                        "type": "rich_text_preformatted",
                        "elements": [
                            {
                                "type": "text",
                                "text": "market_filter=betfairlightweight.filters.streaming_market_filter(\n    event_type_ids=[\"1\"],\n    market_types=[\"MATCH_ODDS\"],\n    betting_types=[\"ODDS\"],\n),"
                            }
                        ],
                        "border": 0
                    },
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": " I get:\n"
                            },
                            {
                                "type": "text",
                                "text": "{\"asctime\": \"2022-11-26 16:40:19,795\", \"levelname\": \"ERROR\", \"message\": \"[FlumineStream: 2001]: SUBSCRIPTION_LIMIT_EXCEEDED: trying to subscribe to 505 markets whereas max allowed number was: 200\"}",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": "\n\nI could obviously get a reduced number of  market_ids myself by doing:\n"
                            }
                        ]
                    },
                    {
                        "type": "rich_text_preformatted",
                        "elements": [
                            {
                                "type": "text",
                                "text": "filter = betfairlightweight.filters.market_filter(event_type_ids=[1], market_start_time={'from': datetime_from, 'to': datetime_to})\nself.trading.betting.list_events(filter=filter)"
                            }
                        ],
                        "border": 0
                    },
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "But then I would have static ids and certainly would have to restart the program to fetch the new markets, which is a problem as described above.\n\nWhat would be the recommended way to reduce the subset of markets while avoiding having static market_ids ?"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U4H19D1D2",
        "type": "message",
        "ts": "1669482913.230989",
        "client_msg_id": "5E4C1E9A-50F5-488D-B647-D3A1F82E1E7B",
        "text": "Yes\nThat won’t work when streaming, email bdp and get your limit bumped ",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "137c5a3ef323",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-03-15\/6819395173841_137c5a3ef323f1944a1a_72.png",
            "first_name": "liam",
            "real_name": "liam",
            "display_name": "liam",
            "team": "T4G9NBD2M",
            "name": "liam",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1669482913.230989",
        "reply_count": 6,
        "reply_users_count": 2,
        "latest_reply": "1669566214.799989",
        "reply_users": [
            "U04980ZT6UX",
            "U4H19D1D2"
        ],
        "replies": [
            {
                "user": "U04980ZT6UX",
                "ts": "1669483172.977889"
            },
            {
                "user": "U4H19D1D2",
                "ts": "1669483544.134219"
            },
            {
                "user": "U04980ZT6UX",
                "ts": "1669486114.395439"
            },
            {
                "user": "U4H19D1D2",
                "ts": "1669535543.745149"
            },
            {
                "user": "U04980ZT6UX",
                "ts": "1669562996.867219"
            },
            {
                "user": "U4H19D1D2",
                "ts": "1669566214.799989"
            }
        ],
        "is_locked": false,
        "subscribed": true,
        "last_read": "1669566214.799989",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "S6R",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Yes\n"
                            },
                            {
                                "type": "text",
                                "text": "That"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "won’t"
                            },
                            {
                                "type": "text",
                                "text": " work when streaming, email bdp and get your limit bumped "
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U04980ZT6UX",
        "type": "message",
        "ts": "1669483172.977889",
        "client_msg_id": "21af9116-44c9-4c9e-b7ab-bc72242ba1d6",
        "text": "Yes for the question where the markets gets updated automatically?\n\nIs there a way to add additional filters to the streaming (for data its fine to get all the 500+ markets, but for trading I would like to limit by time to match for instance)",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "gb1b2f82a1a4",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/b1b2f82a1a49a547cbc7487b48805187.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0017-72.png",
            "first_name": "AI",
            "real_name": "AI Trader",
            "display_name": "AI Trader",
            "team": "T4G9NBD2M",
            "name": "menocineto",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1669482913.230989",
        "parent_user_id": "U4H19D1D2",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "1ZBVt",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Yes for the question where the markets gets updated automatically?\n\nIs there a way to add additional filters to the streaming (for data its fine to get all the 500+ markets, but for trading I would like to limit by time to match for instance)"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U4H19D1D2",
        "type": "message",
        "ts": "1669483544.134219",
        "client_msg_id": "B15E38AF-2F20-4BE1-AF54-A3DC9981EB66",
        "text": "Yes\n\nIt’s not additive but in flumine you can supply a list of filters ",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "137c5a3ef323",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-03-15\/6819395173841_137c5a3ef323f1944a1a_72.png",
            "first_name": "liam",
            "real_name": "liam",
            "display_name": "liam",
            "team": "T4G9NBD2M",
            "name": "liam",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1669482913.230989",
        "parent_user_id": "U4H19D1D2",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "sADy",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Yes\n\n"
                            },
                            {
                                "type": "text",
                                "text": "It’s"
                            },
                            {
                                "type": "text",
                                "text": " not additive but in flumine you can supply a list of filters "
                            }
                        ]
                    }
                ]
            }
        ],
        "reactions": [
            {
                "name": "raised_hands",
                "users": [
                    "U04980ZT6UX"
                ],
                "count": 1
            }
        ]
    },
    {
        "user": "U04980ZT6UX",
        "type": "message",
        "ts": "1669486114.395439",
        "client_msg_id": "a980e4f8-35cc-408f-ab47-d2cbcfebdc9e",
        "text": "<@U4H19D1D2>\nI tried to add a `betfairlightweight.filters.market_filter` filter so that I could also filter by market_start_time, but I am getting almost 10_000 markets, whereas I should be getting less than 300. Any ideas why?\nI used the below filter as a *market_filter* for the BaseStrategy, which returns the below error:\n```filter = betfairlightweight.filters.market_filter(event_type_ids=[\"1\"], market_start_time={'from': '2022-11-26T23:31:33Z', 'to': '2022-11-28T17:31:33Z'})```\n`{\"asctime\": \"2022-11-26 17:52:58,912\", \"levelname\": \"ERROR\", \"message\": \"[FlumineStream: 2001]: SUBSCRIPTION_LIMIT_EXCEEDED: trying to subscribe to 9866 markets whereas max allowed number was: 200\"}`\n\nIt says there are 9866 markets passing this filter, but if I manually check it through:\n```all_event_ids = [event.event.id for event in self.trading.betting.list_events(filter=filter)]```\nI get only 232 event ids (and there should be a single market_id per event ids as I am only fetching MATCH_ODDS., which is way smaller than the number of market_ids the BaseStrategy complains about (9866)\n\nBelow is the code Ive used for the BaseStrategy:\n```framework = Flumine(client=client)\nstrategy = S3MarketRecorder(\n    name=\"WIN\",\n    market_filter=filter,\n    stream_class=DataStream,\n    context={\n        \"local_dir\": \".\/bet_data_temp\",\n        \"force_update\": False,\n        \"remove_file\": True,\n        \"remove_gz_file\": True,\n        \"bucket\" : bucket,\n    },\n)```\n",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "gb1b2f82a1a4",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/b1b2f82a1a49a547cbc7487b48805187.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0017-72.png",
            "first_name": "AI",
            "real_name": "AI Trader",
            "display_name": "AI Trader",
            "team": "T4G9NBD2M",
            "name": "menocineto",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1669482913.230989",
        "parent_user_id": "U4H19D1D2",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "4bZT",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "user",
                                "user_id": "U4H19D1D2"
                            },
                            {
                                "type": "text",
                                "text": "\nI tried to add a "
                            },
                            {
                                "type": "text",
                                "text": "betfairlightweight.filters.market_filter",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " filter so that I could also filter by market_start_time, but I am getting almost 10_000 markets, whereas I should be getting less than 300. Any ideas why?\nI used the below filter as a "
                            },
                            {
                                "type": "text",
                                "text": "market_filter",
                                "style": {
                                    "bold": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " for the BaseStrategy, which returns the below error:\n"
                            }
                        ]
                    },
                    {
                        "type": "rich_text_preformatted",
                        "elements": [
                            {
                                "type": "text",
                                "text": "filter = betfairlightweight.filters.market_filter(event_type_ids=[\"1\"], market_start_time={'from': '2022-11-26T23:31:33Z', 'to': '2022-11-28T17:31:33Z'})"
                            }
                        ],
                        "border": 0
                    },
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "{\"asctime\": \"2022-11-26 17:52:58,912\", \"levelname\": \"ERROR\", \"message\": \"[FlumineStream: 2001]: SUBSCRIPTION_LIMIT_EXCEEDED: trying to subscribe to 9866 markets whereas max allowed number was: 200\"}",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": "\n\nIt says there are 9866 markets passing this filter, but if I manually check it through:\n"
                            }
                        ]
                    },
                    {
                        "type": "rich_text_preformatted",
                        "elements": [
                            {
                                "type": "text",
                                "text": "all_event_ids = [event.event.id for event in self.trading.betting.list_events(filter=filter)]"
                            }
                        ],
                        "border": 0
                    },
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "\nI get only 232 event ids (and there should be a single market_id per event ids as I am only fetching MATCH_ODDS., which is way smaller than the number of market_ids the BaseStrategy complains about (9866)\n\nBelow is the code Ive used for the BaseStrategy:\n"
                            }
                        ]
                    },
                    {
                        "type": "rich_text_preformatted",
                        "elements": [
                            {
                                "type": "text",
                                "text": "framework = Flumine(client=client)\nstrategy = S3MarketRecorder(\n    name=\"WIN\",\n    market_filter=filter,\n    stream_class=DataStream,\n    context={\n        \"local_dir\": \".\/bet_data_temp\",\n        \"force_update\": False,\n        \"remove_file\": True,\n        \"remove_gz_file\": True,\n        \"bucket\" : bucket,\n    },\n)"
                            }
                        ],
                        "border": 0
                    },
                    {
                        "type": "rich_text_section",
                        "elements": []
                    }
                ]
            }
        ]
    },
    {
        "user": "U4H19D1D2",
        "type": "message",
        "ts": "1669535543.745149",
        "client_msg_id": "F1913B96-4FD9-40F8-B622-17DC50200374",
        "text": "Market filters don’t work with streaming ",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "137c5a3ef323",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-03-15\/6819395173841_137c5a3ef323f1944a1a_72.png",
            "first_name": "liam",
            "real_name": "liam",
            "display_name": "liam",
            "team": "T4G9NBD2M",
            "name": "liam",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1669482913.230989",
        "parent_user_id": "U4H19D1D2",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "KV\/Z",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Market "
                            },
                            {
                                "type": "text",
                                "text": "filters"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "don’t"
                            },
                            {
                                "type": "text",
                                "text": " work with streaming "
                            }
                        ]
                    }
                ]
            }
        ]
    }
]