[
    {
        "user": "UPMUFSGCR",
        "type": "message",
        "ts": "1684827336.983819",
        "client_msg_id": "d55bf84d-6475-4046-99f9-f0d0f9c2718c",
        "text": "Suppose I am running 10,000 backtests.\nI want to store the results.\nI currently store the results as gzipped JSON, one per market. But then I end up with 10,000 files.\nI've tried writing to sqlite instead, but that uses a lot of disk space.\nI'm thinking of trying to write all results to a single zipped test file. But I've read that most libraries such as gzip will give poor performance if write to it incrementally. What else should I try?",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "31c0bb5a442c",
            "image_72": "https:\/\/avatars.slack-edge.com\/2019-10-28\/812386967189_31c0bb5a442c5b8d2c61_72.png",
            "first_name": "Jon",
            "real_name": "Jon Jon Jon Jon Jon Jon Jon Jon",
            "display_name": "Jonjonjon",
            "team": "T4G9NBD2M",
            "name": "fcmisc",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1684827336.983819",
        "reply_count": 3,
        "reply_users_count": 2,
        "latest_reply": "1684830667.870849",
        "reply_users": [
            "UBS7QANF3",
            "UPMUFSGCR"
        ],
        "replies": [
            {
                "user": "UBS7QANF3",
                "ts": "1684829430.986689"
            },
            {
                "user": "UPMUFSGCR",
                "ts": "1684829838.501629"
            },
            {
                "user": "UPMUFSGCR",
                "ts": "1684830667.870849"
            }
        ],
        "is_locked": false,
        "subscribed": false,
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "WXqr",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Suppose I am running 10,000 backtests.\nI want to store the results.\nI currently store the results as gzipped JSON, one per market. But then I end up with 10,000 files.\nI've tried writing to sqlite instead, but that uses a lot of disk space.\nI'm thinking of trying to write all results to a single zipped test file. But I've read that most libraries such as gzip will give poor performance if write to it incrementally. What else should I try?"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U4H19D1D2",
        "type": "message",
        "ts": "1684827382.631399",
        "client_msg_id": "c1efd3f4-4435-484b-98cd-e4c83036c174",
        "text": "I just put it all in a single file per processor and then combine at the end (json)",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "137c5a3ef323",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-03-15\/6819395173841_137c5a3ef323f1944a1a_72.png",
            "first_name": "liam",
            "real_name": "liam",
            "display_name": "liam",
            "team": "T4G9NBD2M",
            "name": "liam",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "qPZEL",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "I just put it all in a single file per processor and then combine at the end (json)"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U4H19D1D2",
        "type": "message",
        "ts": "1684827413.689209",
        "client_msg_id": "3f0e9bc2-be69-4a9d-acac-f549f9525b0b",
        "text": "Why are you compressing?",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "137c5a3ef323",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-03-15\/6819395173841_137c5a3ef323f1944a1a_72.png",
            "first_name": "liam",
            "real_name": "liam",
            "display_name": "liam",
            "team": "T4G9NBD2M",
            "name": "liam",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "iVL",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Why are you compressing?"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "UPMUFSGCR",
        "type": "message",
        "ts": "1684827537.882999",
        "client_msg_id": "ff550c7b-06cf-43fc-ab6d-ad62e911d891",
        "text": "To save disk space, become large. The full run will produce an sqlite dB of 24gb if I don't compress. And I want to perform quite a few runs.",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "31c0bb5a442c",
            "image_72": "https:\/\/avatars.slack-edge.com\/2019-10-28\/812386967189_31c0bb5a442c5b8d2c61_72.png",
            "first_name": "Jon",
            "real_name": "Jon Jon Jon Jon Jon Jon Jon Jon",
            "display_name": "Jonjonjon",
            "team": "T4G9NBD2M",
            "name": "fcmisc",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "eD0",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "To save disk space, become large. The full run will produce an sqlite dB of 24gb if I don't compress. And I want to perform quite a few runs."
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U4H19D1D2",
        "type": "message",
        "ts": "1684827583.184049",
        "client_msg_id": "aa82289d-e7b9-4a76-89a2-3043db0740ea",
        "text": "Wow what are you storing? Its rare I go over 1gb at a similar number of markets",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "137c5a3ef323",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-03-15\/6819395173841_137c5a3ef323f1944a1a_72.png",
            "first_name": "liam",
            "real_name": "liam",
            "display_name": "liam",
            "team": "T4G9NBD2M",
            "name": "liam",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "Rp0=u",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Wow what are you storing? Its rare I go over 1gb at a similar number of markets"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "UPMUFSGCR",
        "type": "message",
        "ts": "1684827662.311399",
        "client_msg_id": "c66a0a39-9608-4a0c-8fe5-903d488c2183",
        "text": "The main thing taking up the space is the full market book at a few different intervals.",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "31c0bb5a442c",
            "image_72": "https:\/\/avatars.slack-edge.com\/2019-10-28\/812386967189_31c0bb5a442c5b8d2c61_72.png",
            "first_name": "Jon",
            "real_name": "Jon Jon Jon Jon Jon Jon Jon Jon",
            "display_name": "Jonjonjon",
            "team": "T4G9NBD2M",
            "name": "fcmisc",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "dt+7T",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "The main thing taking up the space is the full market book at a few different intervals."
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U01DCR5PXDY",
        "type": "message",
        "ts": "1684829337.780689",
        "edited": {
            "user": "U01DCR5PXDY",
            "ts": "1684829975.000000"
        },
        "client_msg_id": "6ebae608-3569-43aa-b28e-07c9710ff54c",
        "text": "Edit: nvm, think I misunderstood your use case.",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "903bc20cd9db",
            "image_72": "https:\/\/avatars.slack-edge.com\/2020-10-26\/1448127317798_903bc20cd9dba9a758e0_72.png",
            "first_name": "thambie1",
            "real_name": "thambie1",
            "display_name": "thambie1",
            "team": "T4G9NBD2M",
            "name": "thambie1",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "BCyu",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Edit: nvm, think I misunderstood your use case."
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U4H19D1D2",
        "type": "message",
        "ts": "1684829366.091729",
        "client_msg_id": "5e81bf6a-acd8-42ab-b60b-ae975e6a1628",
        "text": "Can you strip it down \/ do you really need the full book? I still don't understand the need to compress whilst writing, just do it after?",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "137c5a3ef323",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-03-15\/6819395173841_137c5a3ef323f1944a1a_72.png",
            "first_name": "liam",
            "real_name": "liam",
            "display_name": "liam",
            "team": "T4G9NBD2M",
            "name": "liam",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "Qg1",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Can you strip it down \/ do you really need the full book? I still don't understand the need to compress whilst writing, just do it after?"
                            }
                        ]
                    }
                ]
            }
        ],
        "reactions": [
            {
                "name": "heavy_plus_sign",
                "users": [
                    "U9JHLMZB4",
                    "UPMUFSGCR"
                ],
                "count": 2
            }
        ]
    },
    {
        "user": "UBS7QANF3",
        "type": "message",
        "ts": "1684829430.986689",
        "client_msg_id": "3C98D3CA-5C7C-43DC-A614-209F763D0368",
        "text": "I don’t think the overhead of incremental writing is that large? You’re just writing an additional header no?",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "gaaf844a4a90",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/eaaf844a4a905431d83430e563b077aa.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0011-72.png",
            "first_name": "",
            "real_name": "Maurice Berk",
            "display_name": "Mo",
            "team": "T4G9NBD2M",
            "name": "maurice",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1684827336.983819",
        "parent_user_id": "UPMUFSGCR",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "s+BC",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "I "
                            },
                            {
                                "type": "text",
                                "text": "don’t"
                            },
                            {
                                "type": "text",
                                "text": " think the overhead of incremental writing is that large? "
                            },
                            {
                                "type": "text",
                                "text": "You’re"
                            },
                            {
                                "type": "text",
                                "text": " just writing an additional header no?"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "UPMUFSGCR",
        "type": "message",
        "ts": "1684829838.501629",
        "client_msg_id": "3944ca01-c260-4d7f-a4ac-ef0e93df754b",
        "text": "From prior work, if each process opens the file (with lock), writes a little to it, then closes it... The overall compression will be poor due to the way most compression algorithms work. Some are better than others for streaming writes.",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "31c0bb5a442c",
            "image_72": "https:\/\/avatars.slack-edge.com\/2019-10-28\/812386967189_31c0bb5a442c5b8d2c61_72.png",
            "first_name": "Jon",
            "real_name": "Jon Jon Jon Jon Jon Jon Jon Jon",
            "display_name": "Jonjonjon",
            "team": "T4G9NBD2M",
            "name": "fcmisc",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1684827336.983819",
        "parent_user_id": "UPMUFSGCR",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "F2vB9",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "From prior work, if each process opens the file (with lock), writes a little to it, then closes it... The overall compression will be poor due to the way most compression algorithms work. Some are better than others for streaming writes."
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "UPMUFSGCR",
        "type": "message",
        "ts": "1684830667.870849",
        "client_msg_id": "6b0ea3eb-e43c-4c62-8e20-86e783c5c092",
        "text": "<https:\/\/stackoverflow.com\/questions\/18097107\/python-gzip-appending-to-file-on-the-fly|https:\/\/stackoverflow.com\/questions\/18097107\/python-gzip-appending-to-file-on-the-fly>",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "31c0bb5a442c",
            "image_72": "https:\/\/avatars.slack-edge.com\/2019-10-28\/812386967189_31c0bb5a442c5b8d2c61_72.png",
            "first_name": "Jon",
            "real_name": "Jon Jon Jon Jon Jon Jon Jon Jon",
            "display_name": "Jonjonjon",
            "team": "T4G9NBD2M",
            "name": "fcmisc",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1684827336.983819",
        "parent_user_id": "UPMUFSGCR",
        "attachments": [
            {
                "from_url": "https:\/\/stackoverflow.com\/questions\/18097107\/python-gzip-appending-to-file-on-the-fly",
                "service_icon": "https:\/\/cdn.sstatic.net\/Sites\/stackoverflow\/Img\/apple-touch-icon.png?v=c78bd457575a",
                "thumb_url": "https:\/\/cdn.sstatic.net\/Sites\/stackoverflow\/Img\/apple-touch-icon@2.png?v=73d79a89bded",
                "thumb_width": 316,
                "thumb_height": 316,
                "id": 1,
                "original_url": "https:\/\/stackoverflow.com\/questions\/18097107\/python-gzip-appending-to-file-on-the-fly",
                "fallback": "Stack Overflow: Python Gzip - Appending to file on the fly",
                "text": "Is it possible to append to a gzipped text file on the fly using Python ?\n\nBasically I am doing this:-\n\nimport gzip\ncontent = \"Lots of content here\"\nf = gzip.open('file.txt.gz', 'a', 9)\nf.write(con...",
                "title": "Python Gzip - Appending to file on the fly",
                "title_link": "https:\/\/stackoverflow.com\/questions\/18097107\/python-gzip-appending-to-file-on-the-fly",
                "service_name": "Stack Overflow"
            }
        ],
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "Mvh",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "link",
                                "url": "https:\/\/stackoverflow.com\/questions\/18097107\/python-gzip-appending-to-file-on-the-fly",
                                "text": "https:\/\/stackoverflow.com\/questions\/18097107\/python-gzip-appending-to-file-on-the-fly"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "UPMUFSGCR",
        "type": "message",
        "ts": "1684830710.028809",
        "client_msg_id": "f7707356-30f2-4835-b3cc-61c73cd82437",
        "text": "Yes, I think I might have to. Most of the time I don't use it anyway:thinking_face:",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "31c0bb5a442c",
            "image_72": "https:\/\/avatars.slack-edge.com\/2019-10-28\/812386967189_31c0bb5a442c5b8d2c61_72.png",
            "first_name": "Jon",
            "real_name": "Jon Jon Jon Jon Jon Jon Jon Jon",
            "display_name": "Jonjonjon",
            "team": "T4G9NBD2M",
            "name": "fcmisc",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "T+ma",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Yes, I think I might have to. Most of the time I don't use it anyway"
                            },
                            {
                                "type": "emoji",
                                "name": "thinking_face",
                                "unicode": "1f914"
                            }
                        ]
                    }
                ]
            }
        ]
    }
]