[
    {
        "user": "U04980ZT6UX",
        "type": "message",
        "ts": "1671157063.358089",
        "edited": {
            "user": "U04980ZT6UX",
            "ts": "1671157085.000000"
        },
        "client_msg_id": "84fa8a07-cb99-452f-b278-4d48715f295e",
        "text": "<@U4H19D1D2> There was a typo, yes. What I meant is that I want to cancel all pending\/open orders before I *stop* trading a market.\n\nIn that case, should I do the following?\n\n```def check_market_book(self, market, market_book):\n    exit_market : boolean = check_exit_market()\n\n    if not exit_market:\n        if market_book.status == \"OPEN\":\n            return True\n    else:\n        for runner in market_book.runners:\n            open_orders = market.blotter.strategy_selection_orders(self, runner.selection_id, runner.handicap, order_status=[OrderStatus.EXECUTABLE, OrderStatus.PENDING])\n            for order in open_orders:\n                market.cancel_order(order)\n        self.remove_market(market.market_id)```",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "gb1b2f82a1a4",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/b1b2f82a1a49a547cbc7487b48805187.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0017-72.png",
            "first_name": "AI",
            "real_name": "AI Trader",
            "display_name": "AI Trader",
            "team": "T4G9NBD2M",
            "name": "menocineto",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1670796518.093619",
        "parent_user_id": "U04980ZT6UX",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "POEo",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "user",
                                "user_id": "U4H19D1D2"
                            },
                            {
                                "type": "text",
                                "text": " There was a typo, yes. What I meant is that I want to cancel all pending\/open orders before I "
                            },
                            {
                                "type": "text",
                                "text": "stop",
                                "style": {
                                    "bold": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " trading a market.\n\nIn that case, should I do the following?\n\n"
                            }
                        ]
                    },
                    {
                        "type": "rich_text_preformatted",
                        "elements": [
                            {
                                "type": "text",
                                "text": "def check_market_book(self, market, market_book):\n    exit_market : boolean = check_exit_market()\n\n    if not exit_market:\n        if market_book.status == \"OPEN\":\n            return True\n    else:\n        for runner in market_book.runners:\n            open_orders = market.blotter.strategy_selection_orders(self, runner.selection_id, runner.handicap, order_status=[OrderStatus.EXECUTABLE, OrderStatus.PENDING])\n            for order in open_orders:\n                market.cancel_order(order)\n        self.remove_market(market.market_id)"
                            }
                        ],
                        "border": 0
                    }
                ]
            }
        ]
    },
    {
        "user": "U04980ZT6UX",
        "type": "message",
        "ts": "1671157807.534279",
        "client_msg_id": "a1ac755f-f256-4c01-bd41-5fe67fa3b4c2",
        "text": "In my backtester, even after calling `self.remove_market(market.market_id)` I can see that I am still processing updates for that market. Am I missing something?",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "gb1b2f82a1a4",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/b1b2f82a1a49a547cbc7487b48805187.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0017-72.png",
            "first_name": "AI",
            "real_name": "AI Trader",
            "display_name": "AI Trader",
            "team": "T4G9NBD2M",
            "name": "menocineto",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1670796518.093619",
        "parent_user_id": "U04980ZT6UX",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "iLD",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "In my backtester, even after calling "
                            },
                            {
                                "type": "text",
                                "text": "self.remove_market(market.market_id)",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " I can see that I am still processing updates for that market. Am I missing something?"
                            }
                        ]
                    }
                ]
            }
        ]
    }
]