[
    {
        "user": "U0155J92A7Q",
        "type": "message",
        "ts": "1669191519.188569",
        "client_msg_id": "9acd8bad-0a41-4607-99c5-9efb215c42b1",
        "text": "Hi guys, while Simulating, how can I access `market.blotter.get_exposures(self, lookup=selection_lookup)`  when a market is cleared?\n\nI'm looking at the <https:\/\/github.com\/betcode-org\/flumine\/blob\/master\/examples\/controls\/backtestloggingcontrol.py|backtestloggingcontrol example>, but want to save the exposure (profit_if_win and profit_if_lose) on top of the profit",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "gde8c5d51af5",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/de8c5d51af54a5ac7b501f416ddb262c.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0016-72.png",
            "first_name": "",
            "real_name": "Jorge",
            "display_name": "Jorge",
            "team": "T4G9NBD2M",
            "name": "jgarciam95",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "attachments": [
            {
                "id": 1,
                "footer_icon": "https:\/\/slack.github.com\/static\/img\/favicon-neutral.png",
                "color": "24292f",
                "bot_id": "B021ZJYSBMW",
                "app_unfurl_url": "https:\/\/github.com\/betcode-org\/flumine\/blob\/master\/examples\/controls\/backtestloggingcontrol.py",
                "is_app_unfurl": true,
                "app_id": "A01BP7R4KNY",
                "fallback": "<https:\/\/github.com\/betcode-org\/flumine\/blob\/master\/examples\/controls\/backtestloggingcontrol.py | backtestloggingcontrol.py>",
                "text": "```\nimport csv\nimport logging\nfrom flumine.controls.loggingcontrols import LoggingControl\nfrom flumine.order.ordertype import OrderTypes\n\nlogger = logging.getLogger(__name__)\n\nFIELDNAMES = [\n    \"bet_id\",\n    \"strategy_name\",\n    \"market_id\",\n    \"selection_id\",\n    \"trade_id\",\n    \"date_time_placed\",\n    \"price\",\n    \"price_matched\",\n    \"size\",\n    \"size_matched\",\n    \"profit\",\n    \"side\",\n    \"elapsed_seconds_executable\",\n    \"order_status\",\n    \"market_note\",\n    \"trade_notes\",\n    \"order_notes\",\n]\n\n\nclass BacktestLoggingControl(LoggingControl):\n    NAME = \"BACKTEST_LOGGING_CONTROL\"\n\n    def __init__(self, *args, **kwargs):\n        super(BacktestLoggingControl, self).__init__(*args, **kwargs)\n        self._setup()\n\n    def _setup(self):\n        with open(\"orders.txt\", \"w\") as m:\n            csv_writer = csv.DictWriter(m, delimiter=\",\", fieldnames=FIELDNAMES)\n            csv_writer.writeheader()\n\n    def _process_cleared_orders_meta(self, event):\n        orders = event.event\n        with open(\"orders.txt\", \"a\") as m:\n            for order in orders:\n                if order.order_type.ORDER_TYPE == OrderTypes.LIMIT:\n                    size = order.order_type.size\n                else:\n                    size = order.order_type.liability\n                if order.order_type.ORDER_TYPE == OrderTypes.MARKET_ON_CLOSE:\n                    price = None\n                else:\n                    price = order.order_type.price\n                try:\n                    order_data = {\n                        \"bet_id\": order.bet_id,\n                        \"strategy_name\": order.trade.strategy,\n                        \"market_id\": order.market_id,\n                        \"selection_id\": order.selection_id,\n                        \"trade_id\": order.trade.id,\n                        \"date_time_placed\": order.responses.date_time_placed,\n                        \"price\": price,\n                        \"price_matched\": order.average_price_matched,\n                        \"size\": size,\n                        \"size_matched\": order.size_matched,\n                        \"profit\": order.profit,\n                        \"side\": order.side,\n                        \"elapsed_seconds_executable\": order.elapsed_seconds_executable,\n                        \"order_status\": order.status.value,\n                        \"market_note\": order.trade.market_notes,\n                        \"trade_notes\": order.trade.notes_str,\n                        \"order_notes\": order.notes_str,\n                    }\n                    csv_writer = csv.DictWriter(m, delimiter=\",\", fieldnames=FIELDNAMES)\n                    csv_writer.writerow(order_data)\n                except Exception as e:\n                    logger.error(\n                        \"_process_cleared_orders_meta: %s\" % e,\n                        extra={\"order\": order, \"error\": e},\n                    )\n\n        <http:\/\/logger.info|logger.info>(\"Orders updated\", extra={\"order_count\": len(orders)})\n\n    def _process_cleared_markets(self, event):\n        cleared_markets = event.event\n        for cleared_market in cleared_markets.orders:\n            <http:\/\/logger.info|logger.info>(\n                \"Cleared market\",\n                extra={\n                    \"market_id\": cleared_market.market_id,\n                    \"bet_count\": cleared_market.bet_count,\n                    \"profit\": cleared_market.profit,\n                    \"commission\": cleared_market.commission,\n                },\n            )\n\n```",
                "title": "<https:\/\/github.com\/betcode-org\/flumine\/blob\/master\/examples\/controls\/backtestloggingcontrol.py | backtestloggingcontrol.py>",
                "footer": "<https:\/\/github.com\/betcode-org\/flumine|betcode-org\/flumine>",
                "mrkdwn_in": [
                    "text"
                ]
            }
        ],
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "G5E",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Hi guys, while Simulating, how can I access "
                            },
                            {
                                "type": "text",
                                "text": "market.blotter.get_exposures(self, lookup=selection_lookup)",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": "  when a market is cleared?\n\nI'm looking at the "
                            },
                            {
                                "type": "link",
                                "url": "https:\/\/github.com\/betcode-org\/flumine\/blob\/master\/examples\/controls\/backtestloggingcontrol.py",
                                "text": "backtestloggingcontrol example"
                            },
                            {
                                "type": "text",
                                "text": ", but want to save the exposure (profit_if_win and profit_if_lose) on top of the profit"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U4H19D1D2",
        "type": "message",
        "ts": "1669233235.120119",
        "client_msg_id": "0CFC3F92-791A-4031-8B5C-2A79F652C8F4",
        "text": "BetAngel <https:\/\/forum.betangel.com\/viewtopic.php?t=26591|v1.60.0> posting because it has an API! :clap:\n\nPython wrapper anyone? ",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "137c5a3ef323",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-03-15\/6819395173841_137c5a3ef323f1944a1a_72.png",
            "first_name": "liam",
            "real_name": "liam",
            "display_name": "liam",
            "team": "T4G9NBD2M",
            "name": "liam",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1669233235.120119",
        "reply_count": 1,
        "reply_users_count": 1,
        "latest_reply": "1670165527.371519",
        "reply_users": [
            "UQL0QDEKA"
        ],
        "replies": [
            {
                "user": "UQL0QDEKA",
                "ts": "1670165527.371519"
            }
        ],
        "is_locked": false,
        "subscribed": true,
        "last_read": "1670165527.371519",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "EWTN",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "BetAngel "
                            },
                            {
                                "type": "link",
                                "url": "https:\/\/forum.betangel.com\/viewtopic.php?t=26591",
                                "text": "v1.60.0"
                            },
                            {
                                "type": "text",
                                "text": " posting because it has an API! "
                            },
                            {
                                "type": "emoji",
                                "name": "clap",
                                "unicode": "1f44f"
                            },
                            {
                                "type": "text",
                                "text": "\n\nPython wrapper anyone? "
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "text": "Hey Guys, I have a pretty basic question, so apologies in advance. When I use runner.ex.traded_volume and look at the `size` I see that the size is roughly half of what is displayed on the website. For example this graph shows $30 AUD but runner.ex.traded_volume gives me 16.78, i'm aussming that is GBP, do anyone know of an easy way to convert this?",
        "files": [
            {
                "id": "F04BVEGF7GF",
                "mode": "hidden_by_limit"
            }
        ],
        "upload": false,
        "user": "U02B32JBR0B",
        "display_as_bot": false,
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "wHfwq",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Hey Guys, I have a pretty basic question, so apologies in advance. When I use runner.ex.traded_volume and look at the "
                            },
                            {
                                "type": "text",
                                "text": "size",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " I see that the size is roughly half of what is displayed on the website. For example this graph shows $30 AUD but runner.ex.traded_volume gives me 16.78, i'm aussming that is GBP, do anyone know of an easy way to convert this?"
                            }
                        ]
                    }
                ]
            }
        ],
        "type": "message",
        "ts": "1669246745.308619",
        "client_msg_id": "5fa188fe-537f-4183-a0ee-aafadd464754",
        "thread_ts": "1669246745.308619",
        "reply_count": 2,
        "reply_users_count": 2,
        "latest_reply": "1669249095.751749",
        "reply_users": [
            "U03QLPZQBLM",
            "U02B32JBR0B"
        ],
        "replies": [
            {
                "user": "U03QLPZQBLM",
                "ts": "1669249056.153609"
            },
            {
                "user": "U02B32JBR0B",
                "ts": "1669249095.751749"
            }
        ],
        "is_locked": false,
        "subscribed": false
    },
    {
        "user": "U03QLPZQBLM",
        "type": "message",
        "ts": "1669249056.153609",
        "client_msg_id": "42dc8be9-f4f0-48d9-afdc-6b727b125b27",
        "text": "Hey Ivan :joy:\n\nUse the conversion rate in the bflw module. That's the only way to do it.",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "gee4caf4e81f",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/ee4caf4e81ff96058a7d4a3efdf1a260.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0016-72.png",
            "first_name": "Johnny",
            "real_name": "Johnny Boston",
            "display_name": "",
            "team": "T4G9NBD2M",
            "name": "mike.breen.bbb",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1669246745.308619",
        "parent_user_id": "U02B32JBR0B",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "m18c",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Hey Ivan "
                            },
                            {
                                "type": "emoji",
                                "name": "joy",
                                "unicode": "1f602"
                            },
                            {
                                "type": "text",
                                "text": "\n\nUse the conversion rate in the bflw module. That's the only way to do it."
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U02B32JBR0B",
        "type": "message",
        "ts": "1669249095.751749",
        "client_msg_id": "c29ec9f9-7585-44fd-a3c6-70d61570ef9f",
        "text": "awesome thanks",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "g0632106e050",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/0632106e05050875d3005a7872ab742a.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0005-72.png",
            "first_name": "Ivan",
            "real_name": "Ivan Zhou",
            "display_name": "Ivan Zhou",
            "team": "T4G9NBD2M",
            "name": "ivan.zhou",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1669246745.308619",
        "parent_user_id": "U02B32JBR0B",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "HNrXH",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "awesome thanks"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "text": "*UI ORDERBOOK SIZE DIFFERENT FROM STREAMING* \n\nHi guys,\nWould anyone be able to explain why I see different sizes in the UI for some levels of the book when compared to the orderbook received through the stream?\nHere's one example:\nFor these selections, I don't even see the first two levels of the UI (2.14 and 2.16) in the runner coming from the stream. I have tried to subscribe to all the three\n```\"EX_BEST_OFFERS\", \"EX_BEST_OFFERS_DISP\", \"EX_ALL_OFFERS\"```\nAnd all of them have different values from the ones I can see in the UI.\n\nAny help will be much appreciated. Thanks!",
        "files": [
            {
                "id": "F04D02V57EU",
                "mode": "hidden_by_limit"
            },
            {
                "id": "F04CCR8QESY",
                "mode": "hidden_by_limit"
            }
        ],
        "upload": false,
        "user": "U04980ZT6UX",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "dcfs6",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "UI ORDERBOOK SIZE DIFFERENT FROM STREAMING ",
                                "style": {
                                    "bold": true
                                }
                            },
                            {
                                "type": "text",
                                "text": "\n\nHi guys,\nWould anyone be able to explain why I see different sizes in the UI for some levels of the book when compared to the orderbook received through the stream?\nHere's one example:\nFor these selections, I don't even see the first two levels of the UI (2.14 and 2.16) in the runner coming from the stream. I have tried to subscribe to all the three\n"
                            }
                        ]
                    },
                    {
                        "type": "rich_text_preformatted",
                        "elements": [
                            {
                                "type": "text",
                                "text": "\"EX_BEST_OFFERS\", \"EX_BEST_OFFERS_DISP\", \"EX_ALL_OFFERS\""
                            }
                        ],
                        "border": 0
                    },
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "And all of them have different values from the ones I can see in the UI.\n\nAny help will be much appreciated. Thanks!"
                            }
                        ]
                    }
                ]
            }
        ],
        "type": "message",
        "ts": "1669255498.478519",
        "client_msg_id": "76dd2de4-0a4e-438c-951b-9fb41ecda8db",
        "thread_ts": "1669255498.478519",
        "reply_count": 7,
        "reply_users_count": 3,
        "latest_reply": "1669343593.811779",
        "reply_users": [
            "U4H19D1D2",
            "U04980ZT6UX",
            "UBS7QANF3"
        ],
        "replies": [
            {
                "user": "U4H19D1D2",
                "ts": "1669277893.805929"
            },
            {
                "user": "U04980ZT6UX",
                "ts": "1669291434.517599"
            },
            {
                "user": "U4H19D1D2",
                "ts": "1669291456.224589"
            },
            {
                "user": "U4H19D1D2",
                "ts": "1669291465.498659"
            },
            {
                "user": "U4H19D1D2",
                "ts": "1669291471.671929"
            },
            {
                "user": "UBS7QANF3",
                "ts": "1669315578.828679"
            },
            {
                "user": "U04980ZT6UX",
                "ts": "1669343593.811779"
            }
        ],
        "is_locked": false,
        "subscribed": true,
        "last_read": "1669343593.811779",
        "reactions": [
            {
                "name": "white_check_mark",
                "users": [
                    "U04980ZT6UX"
                ],
                "count": 1
            }
        ]
    },
    {
        "user": "U04980ZT6UX",
        "type": "message",
        "ts": "1669255996.759649",
        "client_msg_id": "d91bb3a8-2080-407b-aec9-d2e2573c8997",
        "text": "Btw, this worked! Thank you so much <@U4H19D1D2>, you're a life saver!",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "gb1b2f82a1a4",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/b1b2f82a1a49a547cbc7487b48805187.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0017-72.png",
            "first_name": "AI",
            "real_name": "AI Trader",
            "display_name": "AI Trader",
            "team": "T4G9NBD2M",
            "name": "menocineto",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1668998146.176879",
        "parent_user_id": "U04980ZT6UX",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "5Nv",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Btw, this worked! Thank you so much "
                            },
                            {
                                "type": "user",
                                "user_id": "U4H19D1D2"
                            },
                            {
                                "type": "text",
                                "text": ", you're a life saver!"
                            }
                        ]
                    }
                ]
            }
        ],
        "reactions": [
            {
                "name": "+1",
                "users": [
                    "U4H19D1D2"
                ],
                "count": 1
            }
        ]
    }
]