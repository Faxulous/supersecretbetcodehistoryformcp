[
    {
        "user": "U4H19D1D2",
        "type": "message",
        "ts": "1706601641.260919",
        "client_msg_id": "38e58716-e45c-4e92-8c69-76faac98b4fb",
        "text": "Not currently, why do you want to record it? Can you do it retrospectively and log something in the `order.notes`  instead?",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "137c5a3ef323",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-03-15\/6819395173841_137c5a3ef323f1944a1a_72.png",
            "first_name": "liam",
            "real_name": "liam",
            "display_name": "liam",
            "team": "T4G9NBD2M",
            "name": "liam",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1706542310.356259",
        "parent_user_id": "U03FS7KM2NL",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "7OtC8",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Not currently, why do you want to record it? Can you do it retrospectively and log something in the "
                            },
                            {
                                "type": "text",
                                "text": "order.notes",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": "  instead?"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U03FS7KM2NL",
        "type": "message",
        "ts": "1706602024.846469",
        "client_msg_id": "01AA3D19-012A-478D-BE87-E65DC5A8A357",
        "text": "Yeah I could do that, and mostly just for debugging to see what orders I have open, I’ve ended up with a duck taped monstrosity but it appears to work",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "g160a197a059",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/160a197a059d9b97aabdd95ca66dc341.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0026-72.png",
            "first_name": "Ralegh",
            "real_name": "Ralegh",
            "display_name": "",
            "team": "T4G9NBD2M",
            "name": "ralegh",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1706542310.356259",
        "parent_user_id": "U03FS7KM2NL",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "KC09G",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Yeah I could do that, and mostly just for debugging to see what orders I have open, "
                            },
                            {
                                "type": "text",
                                "text": "I’ve"
                            },
                            {
                                "type": "text",
                                "text": " ended up with a duck taped monstrosity but it appears to work"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U4H19D1D2",
        "type": "message",
        "ts": "1706602064.558229",
        "client_msg_id": "38496b17-4cf7-4bb7-979b-a769dea2215e",
        "text": "`process_orders` is for seeing things in real time if that is what you mean?",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "137c5a3ef323",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-03-15\/6819395173841_137c5a3ef323f1944a1a_72.png",
            "first_name": "liam",
            "real_name": "liam",
            "display_name": "liam",
            "team": "T4G9NBD2M",
            "name": "liam",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1706542310.356259",
        "parent_user_id": "U03FS7KM2NL",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "evk74",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "process_orders",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " is for seeing things in real time if that is what you mean?"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U03FS7KM2NL",
        "type": "message",
        "ts": "1706602110.367409",
        "client_msg_id": "3BEC16B3-4BF6-4F25-B75C-9C83AE75C2B6",
        "text": "Also quick q, can I share connections for market filters? I’ve got a total of 11 in the same script",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "g160a197a059",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/160a197a059d9b97aabdd95ca66dc341.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0026-72.png",
            "first_name": "Ralegh",
            "real_name": "Ralegh",
            "display_name": "",
            "team": "T4G9NBD2M",
            "name": "ralegh",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1706542310.356259",
        "parent_user_id": "U03FS7KM2NL",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "I\/2hp",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Also quick q, can I share connections for market filters? "
                            },
                            {
                                "type": "text",
                                "text": "I’ve"
                            },
                            {
                                "type": "text",
                                "text": " got a total of 11 in the same script"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U4H19D1D2",
        "type": "message",
        "ts": "1706602138.442819",
        "client_msg_id": "80663b68-1966-48ea-b5a9-51195ad831ba",
        "text": "if the filter is the same flumine will do this automatically",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "137c5a3ef323",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-03-15\/6819395173841_137c5a3ef323f1944a1a_72.png",
            "first_name": "liam",
            "real_name": "liam",
            "display_name": "liam",
            "team": "T4G9NBD2M",
            "name": "liam",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1706542310.356259",
        "parent_user_id": "U03FS7KM2NL",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "rbtV3",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "if the filter is the same flumine will do this automatically"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U03FS7KM2NL",
        "type": "message",
        "ts": "1706602152.877649",
        "client_msg_id": "01077789-9953-48EC-9A3F-11BEA3F8C4B2",
        "text": "They’re going to a csv then I see them in real time through stream lit (highly recommend btw)",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "g160a197a059",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/160a197a059d9b97aabdd95ca66dc341.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0026-72.png",
            "first_name": "Ralegh",
            "real_name": "Ralegh",
            "display_name": "",
            "team": "T4G9NBD2M",
            "name": "ralegh",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1706542310.356259",
        "parent_user_id": "U03FS7KM2NL",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "ZAX7w",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "They’re"
                            },
                            {
                                "type": "text",
                                "text": " going to a csv then I see them in real time through stream lit (highly recommend btw)"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U03FS7KM2NL",
        "type": "message",
        "ts": "1706602171.678439",
        "client_msg_id": "1A935D97-1027-4F57-9094-C31C3A77F27B",
        "text": "Hmm, alright I need to debug a bit then bc that’s not happening right now",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "g160a197a059",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/160a197a059d9b97aabdd95ca66dc341.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0026-72.png",
            "first_name": "Ralegh",
            "real_name": "Ralegh",
            "display_name": "",
            "team": "T4G9NBD2M",
            "name": "ralegh",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1706542310.356259",
        "parent_user_id": "U03FS7KM2NL",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "WUcUe",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Hmm, alright I need to debug a bit then bc "
                            },
                            {
                                "type": "text",
                                "text": "that’s"
                            },
                            {
                                "type": "text",
                                "text": " not happening right now"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U4H19D1D2",
        "type": "message",
        "ts": "1706602219.686759",
        "client_msg_id": "05009751-3b0b-4edb-97a0-7106b68031c4",
        "text": "logic <https:\/\/github.com\/betcode-org\/flumine\/blob\/101470b0d2d5c0aecaa68cc76a2057d8b064bb04\/flumine\/streams\/streams.py#L94|here>, what do your filters look like?",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "137c5a3ef323",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-03-15\/6819395173841_137c5a3ef323f1944a1a_72.png",
            "first_name": "liam",
            "real_name": "liam",
            "display_name": "liam",
            "team": "T4G9NBD2M",
            "name": "liam",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1706542310.356259",
        "parent_user_id": "U03FS7KM2NL",
        "attachments": [
            {
                "id": 1,
                "footer_icon": "https:\/\/slack.github.com\/static\/img\/favicon-neutral.png",
                "color": "24292f",
                "bot_id": "B021ZJYSBMW",
                "app_unfurl_url": "https:\/\/github.com\/betcode-org\/flumine\/blob\/101470b0d2d5c0aecaa68cc76a2057d8b064bb04\/flumine\/streams\/streams.py#L94",
                "is_app_unfurl": true,
                "app_id": "A01BP7R4KNY",
                "fallback": "<https:\/\/github.com\/betcode-org\/flumine\/blob\/101470b0d2d5c0aecaa68cc76a2057d8b064bb04\/flumine\/streams\/streams.py | streams.py>",
                "text": "```\n            for stream in self:  # check if market stream already exists\n```",
                "title": "<https:\/\/github.com\/betcode-org\/flumine\/blob\/101470b0d2d5c0aecaa68cc76a2057d8b064bb04\/flumine\/streams\/streams.py | streams.py>",
                "footer": "<https:\/\/github.com\/betcode-org\/flumine|betcode-org\/flumine>",
                "mrkdwn_in": [
                    "text"
                ]
            }
        ],
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "u50Nm",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "logic "
                            },
                            {
                                "type": "link",
                                "url": "https:\/\/github.com\/betcode-org\/flumine\/blob\/101470b0d2d5c0aecaa68cc76a2057d8b064bb04\/flumine\/streams\/streams.py#L94",
                                "text": "here"
                            },
                            {
                                "type": "text",
                                "text": ", what do your filters look like?"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U03FS7KM2NL",
        "type": "message",
        "ts": "1706602369.335369",
        "client_msg_id": "71D3273E-6913-4FDD-ACE1-5643A6A9A130",
        "text": "I’ve just got\nstreaming_market_filter([\nevent_type_ids =[…],\n‘market_types=[…],\n])",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "g160a197a059",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/160a197a059d9b97aabdd95ca66dc341.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0026-72.png",
            "first_name": "Ralegh",
            "real_name": "Ralegh",
            "display_name": "",
            "team": "T4G9NBD2M",
            "name": "ralegh",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1706542310.356259",
        "parent_user_id": "U03FS7KM2NL",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "3cztp",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "I’ve just got\nstreaming_market_filter([\nevent_type_ids =["
                            },
                            {
                                "type": "text",
                                "text": "…"
                            },
                            {
                                "type": "text",
                                "text": "],\n‘market_types=["
                            },
                            {
                                "type": "text",
                                "text": "…"
                            },
                            {
                                "type": "text",
                                "text": "],\n])"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U03FS7KM2NL",
        "type": "message",
        "ts": "1706602398.911989",
        "client_msg_id": "449DDC48-8361-49C2-B49D-840223D94B63",
        "text": "And for greyhounds split by venue bc they wouldn’t fit on one conn",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "g160a197a059",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/160a197a059d9b97aabdd95ca66dc341.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0026-72.png",
            "first_name": "Ralegh",
            "real_name": "Ralegh",
            "display_name": "",
            "team": "T4G9NBD2M",
            "name": "ralegh",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1706542310.356259",
        "parent_user_id": "U03FS7KM2NL",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "mqKLe",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "And for greyhounds split by venue bc they "
                            },
                            {
                                "type": "text",
                                "text": "wouldn’t"
                            },
                            {
                                "type": "text",
                                "text": " fit on one conn"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U4H19D1D2",
        "type": "message",
        "ts": "1706602420.046209",
        "client_msg_id": "604ef3bc-59dd-488b-a41a-385570fb7827",
        "text": "email bdp and get your limit bumped",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "137c5a3ef323",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-03-15\/6819395173841_137c5a3ef323f1944a1a_72.png",
            "first_name": "liam",
            "real_name": "liam",
            "display_name": "liam",
            "team": "T4G9NBD2M",
            "name": "liam",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1706542310.356259",
        "parent_user_id": "U03FS7KM2NL",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "s+ZNz",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "email bdp and get your limit bumped"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U03FS7KM2NL",
        "type": "message",
        "ts": "1706602446.924659",
        "client_msg_id": "4585E738-C5D2-40DC-876E-1F1E61911C07",
        "text": "Ah yeah that would also work, cheers",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "g160a197a059",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/160a197a059d9b97aabdd95ca66dc341.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0026-72.png",
            "first_name": "Ralegh",
            "real_name": "Ralegh",
            "display_name": "",
            "team": "T4G9NBD2M",
            "name": "ralegh",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1706542310.356259",
        "parent_user_id": "U03FS7KM2NL",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "ixCbz",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Ah yeah that would also work, cheers"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U03N4QBJ0TV",
        "type": "message",
        "ts": "1706624707.210429",
        "edited": {
            "user": "U03N4QBJ0TV",
            "ts": "1706624738.000000"
        },
        "client_msg_id": "fdeba49d-d475-48c3-8664-b141fccc501e",
        "text": "```QueryFailed: TYPE_MISMATCH: Unable to read parquet data. This is most likely caused by a mismatch between the parquet and metastore schema. You may need to manually clean the data at location '<s3:\/\/aws-athena-query-results-630653152022-eu-west-2\/tables\/3cfa2ebf-9d15-438d-8615-822f68e2af17>' before retrying. Athena will not delete data in your account.```\nYea they typically look like the above. I don't understand why the metastore schema is different. I generate the schema off of the parquet files using a crawler. If I save the files as csv's I get no problems at all. I crawl the csv's, get the table and then there is no issue.",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "g2c8538b47ad",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/2c8538b47ad4bed6facbb148134bb486.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0020-72.png",
            "first_name": "Trex44",
            "real_name": "Trex44",
            "display_name": "Trex44",
            "team": "T4G9NBD2M",
            "name": "c.s.mpharm",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1683971059.005489",
        "parent_user_id": "U03N4QBJ0TV",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "DnNTq",
                "elements": [
                    {
                        "type": "rich_text_preformatted",
                        "elements": [
                            {
                                "type": "text",
                                "text": "QueryFailed: TYPE_MISMATCH: Unable to read parquet data. This is most likely caused by a mismatch between the parquet and metastore schema. You may need to manually clean the data at location '"
                            },
                            {
                                "type": "link",
                                "url": "s3:\/\/aws-athena-query-results-630653152022-eu-west-2\/tables\/3cfa2ebf-9d15-438d-8615-822f68e2af17"
                            },
                            {
                                "type": "text",
                                "text": "' before retrying. Athena will not delete data in your account."
                            }
                        ],
                        "border": 0
                    },
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Yea they typically look like the above. I don't understand why the metastore schema is different. I generate the schema off of the parquet files using a crawler. If I save the files as csv's I get no problems at all. I crawl the csv's, get the table and then there is no issue."
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U04NWADNCFR",
        "type": "message",
        "ts": "1706632992.212849",
        "client_msg_id": "7ffeed77-fc6b-41c6-bd33-b72d1e4740b2",
        "text": "In the case above it looks like the type of a column has changed. The crawler, I think, doesn't scan every single file but just a sample so it assumes all files are like its samples. I've found this error sometimes disappears if you are not querying the column that is confusing Athena - is the query above selecting all columns or just a subset? does selecting a single column work? If you have a column that in some parquet files is a string and in others numeric then that might explain your error. that could happen where a null field was defined as string but is being treated as floating point somewhere, i.e. nan, in your code.",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "g3c4e33a28db",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/3c4e33a28dbfc1fe70799f8e243bf305.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0026-72.png",
            "first_name": "Derek",
            "real_name": "Derek C",
            "display_name": "Derek C",
            "team": "T4G9NBD2M",
            "name": "dataexmachinazzzzz",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1683971059.005489",
        "parent_user_id": "U03N4QBJ0TV",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "RA6HW",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "In the case above it looks like the type of a column has changed. The crawler, I think, doesn't scan every single file but just a sample so it assumes all files are like its samples. I've found this error sometimes disappears if you are not querying the column that is confusing Athena - is the query above selecting all columns or just a subset? does selecting a single column work? If you have a column that in some parquet files is a string and in others numeric then that might explain your error. that could happen where a null field was defined as string but is being treated as floating point somewhere, i.e. nan, in your code."
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U03N4QBJ0TV",
        "type": "message",
        "ts": "1706635796.894449",
        "edited": {
            "user": "U03N4QBJ0TV",
            "ts": "1706635854.000000"
        },
        "client_msg_id": "e27880df-31e4-4b1f-a99e-80fb70332f37",
        "text": "Hmm that might be the issue but I did specifically enforce data types on the columns of the pandas dataframe before converting to a parquet so I don't know why the column type would then differ from one parquet file to another.\n\nI think I have found a workaround for now, I saved about 100 of the files as csvs then loaded them up into a data flow in SageMaker and had sagemaker convert them to parquet files. I could then crawl and load these files in a notebook just fine. I am trying it with the whole data set now.  Strangely when I tried this trick with parquet files I got garbage, the data viewer function in the data flow just showed random symbols instead of headers and the data. Yet downloading the same parquet files and converting them to csv worked just fine and showed the data was in tact and readable.  Its all quite odd. The fix will be fine for now but it means I cant just save the days races as parquets and run a crawler on them which is what I really want to do.",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "g2c8538b47ad",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/2c8538b47ad4bed6facbb148134bb486.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0020-72.png",
            "first_name": "Trex44",
            "real_name": "Trex44",
            "display_name": "Trex44",
            "team": "T4G9NBD2M",
            "name": "c.s.mpharm",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1683971059.005489",
        "parent_user_id": "U03N4QBJ0TV",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "fvAVP",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Hmm that might be the issue but I did specifically enforce data types on the columns of the pandas dataframe before converting to a parquet so I don't know why the column type would then differ from one parquet file to another.\n\nI think I have found a workaround for now, I saved about 100 of the files as csvs then loaded them up into a data flow in SageMaker and had sagemaker convert them to parquet files. I could then crawl and load these files in a notebook just fine. I am trying it with the whole data set now.  Strangely when I tried this trick with parquet files I got garbage, the data viewer function in the data flow just showed random symbols instead of headers and the data. Yet downloading the same parquet files and converting them to csv worked just fine and showed the data was in tact and readable.  Its all quite odd. The fix will be fine for now but it means I cant just save the days races as parquets and run a crawler on them which is what I really want to do."
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U02K5EBKNBF",
        "type": "message",
        "ts": "1706644413.277909",
        "client_msg_id": "58a28b46-86f0-42ee-810d-37bbf722907e",
        "text": "Hey guys, I’ve just started looking at setting up the CricketStream. The _subscribe_to_cricket_matches_() function doesn’t seem to be taking in the usual _initial_clk_ and _clk_ parameters used in the _subscribe_to_markets_\/_subscribe_to_orders_ for reconnect. Why is that?\n<https:\/\/github.com\/betcode-org\/betfair\/blob\/master\/betfairlightweight\/streaming\/betfairstream.py#L191>",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "ge478bab10fc",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/e478bab10fca685df6987c00526939c9.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0004-72.png",
            "first_name": "casper",
            "real_name": "casper",
            "display_name": "casper",
            "team": "T4G9NBD2M",
            "name": "vladislav.vyuzhanin",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "attachments": [
            {
                "id": 1,
                "footer_icon": "https:\/\/slack.github.com\/static\/img\/favicon-neutral.png",
                "color": "24292f",
                "bot_id": "B021ZJYSBMW",
                "app_unfurl_url": "https:\/\/github.com\/betcode-org\/betfair\/blob\/master\/betfairlightweight\/streaming\/betfairstream.py#L191",
                "is_app_unfurl": true,
                "app_id": "A01BP7R4KNY",
                "fallback": "<https:\/\/github.com\/betcode-org\/betfair\/blob\/master\/betfairlightweight\/streaming\/betfairstream.py | betfairstream.py>",
                "text": "```\n    def subscribe_to_cricket_matches(self) -> int:\n```",
                "title": "<https:\/\/github.com\/betcode-org\/betfair\/blob\/master\/betfairlightweight\/streaming\/betfairstream.py | betfairstream.py>",
                "footer": "<https:\/\/github.com\/betcode-org\/betfair|betcode-org\/betfair>",
                "mrkdwn_in": [
                    "text"
                ]
            }
        ],
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "ZNY6c",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Hey guys, I’ve just started looking at setting up the CricketStream. The "
                            },
                            {
                                "type": "text",
                                "text": "subscribe_to_cricket_matches",
                                "style": {
                                    "italic": true
                                }
                            },
                            {
                                "type": "text",
                                "text": "() function doesn’t seem to be taking in the usual "
                            },
                            {
                                "type": "text",
                                "text": "initial_clk",
                                "style": {
                                    "italic": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " and "
                            },
                            {
                                "type": "text",
                                "text": "clk",
                                "style": {
                                    "italic": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " parameters used in the "
                            },
                            {
                                "type": "text",
                                "text": "subscribe_to_markets",
                                "style": {
                                    "italic": true
                                }
                            },
                            {
                                "type": "text",
                                "text": "\/"
                            },
                            {
                                "type": "text",
                                "text": "subscribe_to_orders",
                                "style": {
                                    "italic": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " for reconnect. Why is that?\n"
                            },
                            {
                                "type": "link",
                                "url": "https:\/\/github.com\/betcode-org\/betfair\/blob\/master\/betfairlightweight\/streaming\/betfairstream.py#L191"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U02K5EBKNBF",
        "type": "message",
        "ts": "1706644517.676919",
        "client_msg_id": "1d1c2426-df7d-4f76-84b7-c62fd7705d70",
        "text": "And also the RaceStream with _subscribe_to_races_() function is the same. Btw, the RaceStream - is that for the TPD feed?",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "ge478bab10fc",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/e478bab10fca685df6987c00526939c9.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0004-72.png",
            "first_name": "casper",
            "real_name": "casper",
            "display_name": "casper",
            "team": "T4G9NBD2M",
            "name": "vladislav.vyuzhanin",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "9SnFy",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "And also the RaceStream with "
                            },
                            {
                                "type": "text",
                                "text": "subscribe_to_races",
                                "style": {
                                    "italic": true
                                }
                            },
                            {
                                "type": "text",
                                "text": "() function is the same. Btw, the RaceStream - is that for the TPD feed?"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U4H19D1D2",
        "type": "message",
        "ts": "1706644586.852249",
        "client_msg_id": "FCFAD6A3-6759-4FC4-87D9-ADFFF60B86D0",
        "text": "Yes, from memory it’s because you can’t resubscribe to these streams",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "137c5a3ef323",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-03-15\/6819395173841_137c5a3ef323f1944a1a_72.png",
            "first_name": "liam",
            "real_name": "liam",
            "display_name": "liam",
            "team": "T4G9NBD2M",
            "name": "liam",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "q\/YsN",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Yes, from memory "
                            },
                            {
                                "type": "text",
                                "text": "it’s"
                            },
                            {
                                "type": "text",
                                "text": " because you "
                            },
                            {
                                "type": "text",
                                "text": "can’t"
                            },
                            {
                                "type": "text",
                                "text": " resubscribe to these streams"
                            }
                        ]
                    }
                ]
            }
        ],
        "reactions": [
            {
                "name": "+1",
                "users": [
                    "U02K5EBKNBF"
                ],
                "count": 1
            }
        ]
    },
    {
        "user": "U04NWADNCFR",
        "type": "message",
        "ts": "1706651613.873789",
        "client_msg_id": "6fa7603c-896f-4e2b-8f9f-1ca4e033794a",
        "text": "It's a long time since I wrote the code, but I specifically use this snippet to set the parquet schema deliberately and iirc this is to avoid the pandas\/parquet combination messing up my datatypes under certain circumstances such as when a string column is all nulls.\n\n```table = pa.Table.from_pandas(df, schema=parquet_schema,   )```\nUsing sagemaker, as you say, sounds like a more solid option anyway though.",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "g3c4e33a28db",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/3c4e33a28dbfc1fe70799f8e243bf305.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0026-72.png",
            "first_name": "Derek",
            "real_name": "Derek C",
            "display_name": "Derek C",
            "team": "T4G9NBD2M",
            "name": "dataexmachinazzzzz",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1683971059.005489",
        "parent_user_id": "U03N4QBJ0TV",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "KuCFl",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "It's a long time since I wrote the code, but I specifically use this snippet to set the parquet schema deliberately and iirc this is to avoid the pandas\/parquet combination messing up my datatypes under certain circumstances such as when a string column is all nulls.\n\n"
                            }
                        ]
                    },
                    {
                        "type": "rich_text_preformatted",
                        "elements": [
                            {
                                "type": "text",
                                "text": "table = pa.Table.from_pandas(df, schema=parquet_schema,   )"
                            }
                        ],
                        "border": 0
                    },
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Using sagemaker, as you say, sounds like a more solid option anyway though."
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U06G1373VB2",
        "type": "message",
        "ts": "1706687844.397739",
        "client_msg_id": "192f2ad5-e244-481b-9e68-0a12ad6b5303",
        "text": "thanks <@UBS7QANF3> , 6th was the case for me.",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "4a65420bf390",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-01-24\/6534965180305_4a65420bf390fffb1696_72.png",
            "first_name": "Aiyaj",
            "real_name": "Aiyaj Khalani",
            "display_name": "Aiyaj Khalani",
            "team": "T4G9NBD2M",
            "name": "aiyaj.khalani",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1706092998.419199",
        "parent_user_id": "U06G1373VB2",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "WQUcY",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "thanks "
                            },
                            {
                                "type": "user",
                                "user_id": "UBS7QANF3"
                            },
                            {
                                "type": "text",
                                "text": " , 6th was the case for me."
                            }
                        ]
                    }
                ]
            }
        ],
        "reactions": [
            {
                "name": "+1",
                "users": [
                    "UBS7QANF3"
                ],
                "count": 1
            }
        ]
    }
]