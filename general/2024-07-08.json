[
    {
        "user": "U07AK2APF2B",
        "type": "message",
        "ts": "1720461863.839309",
        "client_msg_id": "b9843a06-66c4-4bc5-bcbd-82587621e601",
        "text": "Hi folks,\n\nWhats the recommended approach for downloading historical files in parallel?\n```# download the files\nfor file in file_list:\n    print(file)\n    download = trading.historic.download_file(file_path=file)\n    print(download)```",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "6864635ccc37",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-07-03\/7370732744981_6864635ccc37944dc06a_72.png",
            "first_name": "Gabriel",
            "real_name": "Gabriel Mocan",
            "display_name": "Gabriel Mocan",
            "team": "T4G9NBD2M",
            "name": "gabemocan",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1720461863.839309",
        "reply_count": 13,
        "reply_users_count": 3,
        "latest_reply": "1720518662.216359",
        "reply_users": [
            "U01B8031PM1",
            "U07AK2APF2B",
            "UBS7QANF3"
        ],
        "replies": [
            {
                "user": "U01B8031PM1",
                "ts": "1720461969.293339"
            },
            {
                "user": "U07AK2APF2B",
                "ts": "1720462124.090669"
            },
            {
                "user": "U01B8031PM1",
                "ts": "1720462224.844059"
            },
            {
                "user": "U01B8031PM1",
                "ts": "1720462233.363979"
            },
            {
                "user": "U07AK2APF2B",
                "ts": "1720462279.372769"
            },
            {
                "user": "U01B8031PM1",
                "ts": "1720462330.157569"
            },
            {
                "user": "U01B8031PM1",
                "ts": "1720462349.090659"
            },
            {
                "user": "U07AK2APF2B",
                "ts": "1720462389.388899"
            },
            {
                "user": "U07AK2APF2B",
                "ts": "1720462457.580769"
            },
            {
                "user": "U01B8031PM1",
                "ts": "1720462863.426509"
            },
            {
                "user": "U07AK2APF2B",
                "ts": "1720466601.455259"
            },
            {
                "user": "UBS7QANF3",
                "ts": "1720511590.525729"
            },
            {
                "user": "U07AK2APF2B",
                "ts": "1720518662.216359"
            }
        ],
        "is_locked": false,
        "subscribed": false,
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "PDChV",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Hi folks,\n\nWhats the recommended approach for downloading historical files in parallel?\n"
                            }
                        ]
                    },
                    {
                        "type": "rich_text_preformatted",
                        "elements": [
                            {
                                "type": "text",
                                "text": "# download the files\nfor file in file_list:\n    print(file)\n    download = trading.historic.download_file(file_path=file)\n    print(download)"
                            }
                        ],
                        "border": 0
                    }
                ]
            }
        ]
    },
    {
        "user": "U01B8031PM1",
        "type": "message",
        "ts": "1720461969.293339",
        "client_msg_id": "b4cb9a11-7126-4265-a3ea-d104c622aebb",
        "text": "`concurrent.futures ThreadPoolExecutor` set max_workers to something reasonable or cloudflare will block IP",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "g6e482a0e41b",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/6e482a0e41b232f48d801454006dfa56.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0016-72.png",
            "first_name": "river_shah",
            "real_name": "river_shah",
            "display_name": "river_shah",
            "team": "T4G9NBD2M",
            "name": "ansar.sa",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1720461863.839309",
        "parent_user_id": "U07AK2APF2B",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "g3C21",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "concurrent.futures ThreadPoolExecutor",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " set max_workers to something reasonable or cloudflare will block IP"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U07AK2APF2B",
        "type": "message",
        "ts": "1720462124.090669",
        "client_msg_id": "5d13fb8a-cff4-40ad-b8a0-84f422c68533",
        "text": "`trading` instance will not be available to the executor, right? Meaning that I’ll need to instantiate a new `trading` instance for every file?",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "6864635ccc37",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-07-03\/7370732744981_6864635ccc37944dc06a_72.png",
            "first_name": "Gabriel",
            "real_name": "Gabriel Mocan",
            "display_name": "Gabriel Mocan",
            "team": "T4G9NBD2M",
            "name": "gabemocan",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1720461863.839309",
        "parent_user_id": "U07AK2APF2B",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "FguxF",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "trading",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " instance will not be available to the executor, right? Meaning that I’ll need to instantiate a new "
                            },
                            {
                                "type": "text",
                                "text": "trading",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " instance for every file?"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U01B8031PM1",
        "type": "message",
        "ts": "1720462224.844059",
        "client_msg_id": "9e97cd84-1fca-4364-9fa8-6ef893d36623",
        "text": "`ThreadPoolExecutor` shares process memory. You need not instantiate new client instance inside download_fn",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "g6e482a0e41b",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/6e482a0e41b232f48d801454006dfa56.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0016-72.png",
            "first_name": "river_shah",
            "real_name": "river_shah",
            "display_name": "river_shah",
            "team": "T4G9NBD2M",
            "name": "ansar.sa",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1720461863.839309",
        "parent_user_id": "U07AK2APF2B",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "7\/RQv",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "ThreadPoolExecutor",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " shares process memory. You need not instantiate new client instance inside download_fn"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U01B8031PM1",
        "type": "message",
        "ts": "1720462233.363979",
        "edited": {
            "user": "U01B8031PM1",
            "ts": "1720462242.000000"
        },
        "client_msg_id": "ccca254b-af79-408b-b329-da09dc785844",
        "text": "You can pass client in",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "g6e482a0e41b",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/6e482a0e41b232f48d801454006dfa56.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0016-72.png",
            "first_name": "river_shah",
            "real_name": "river_shah",
            "display_name": "river_shah",
            "team": "T4G9NBD2M",
            "name": "ansar.sa",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1720461863.839309",
        "parent_user_id": "U07AK2APF2B",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "J8fCl",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "You can pass client in"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U07AK2APF2B",
        "type": "message",
        "ts": "1720462279.372769",
        "client_msg_id": "008b8926-01cd-4025-8f03-1ccdf876a84a",
        "text": "Okay got it so I can pass the `trading` instance across multiple processes and use it concurrently.",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "6864635ccc37",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-07-03\/7370732744981_6864635ccc37944dc06a_72.png",
            "first_name": "Gabriel",
            "real_name": "Gabriel Mocan",
            "display_name": "Gabriel Mocan",
            "team": "T4G9NBD2M",
            "name": "gabemocan",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1720461863.839309",
        "parent_user_id": "U07AK2APF2B",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "pyDPC",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Okay got it so I can pass the "
                            },
                            {
                                "type": "text",
                                "text": "trading",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " instance across multiple processes and use it concurrently."
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U01B8031PM1",
        "type": "message",
        "ts": "1720462330.157569",
        "client_msg_id": "21276990-42b6-4ee5-96de-f4619d817abf",
        "text": "`ThreadPoolExecutor` is not multiple processes. It is a thread executor and uses a single process. You can parallel do IO heavy operations with it",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "g6e482a0e41b",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/6e482a0e41b232f48d801454006dfa56.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0016-72.png",
            "first_name": "river_shah",
            "real_name": "river_shah",
            "display_name": "river_shah",
            "team": "T4G9NBD2M",
            "name": "ansar.sa",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1720461863.839309",
        "parent_user_id": "U07AK2APF2B",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "ttRpk",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "ThreadPoolExecutor",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " is not multiple processes. It is a thread executor and uses a single process. You can parallel do IO heavy operations with it"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U01B8031PM1",
        "type": "message",
        "ts": "1720462349.090659",
        "client_msg_id": "e846df7f-9c95-4160-b21f-eb2857a9a2a8",
        "text": "`downloaded_files = exe.map(partial(get_betfair_files, client), iterable, max_workers=16`",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "g6e482a0e41b",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/6e482a0e41b232f48d801454006dfa56.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0016-72.png",
            "first_name": "river_shah",
            "real_name": "river_shah",
            "display_name": "river_shah",
            "team": "T4G9NBD2M",
            "name": "ansar.sa",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1720461863.839309",
        "parent_user_id": "U07AK2APF2B",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "O\/LKP",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "downloaded_files = exe.map(partial(get_betfair_files, client), iterable, max_workers=16",
                                "style": {
                                    "code": true
                                }
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U07AK2APF2B",
        "type": "message",
        "ts": "1720462389.388899",
        "client_msg_id": "2568c4d8-792a-4980-b655-ba98d7b93c63",
        "text": "Ops, sorry, I was thinking of `ProcessPoolExecutor`",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "6864635ccc37",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-07-03\/7370732744981_6864635ccc37944dc06a_72.png",
            "first_name": "Gabriel",
            "real_name": "Gabriel Mocan",
            "display_name": "Gabriel Mocan",
            "team": "T4G9NBD2M",
            "name": "gabemocan",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1720461863.839309",
        "parent_user_id": "U07AK2APF2B",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "+M3s4",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Ops, sorry, I was thinking of "
                            },
                            {
                                "type": "text",
                                "text": "ProcessPoolExecutor",
                                "style": {
                                    "code": true
                                }
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U07AK2APF2B",
        "type": "message",
        "ts": "1720462457.580769",
        "client_msg_id": "3899aa97-aee7-4920-ada0-f2a28b95b519",
        "text": "Thanks for the code snippet <@U01B8031PM1>",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "6864635ccc37",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-07-03\/7370732744981_6864635ccc37944dc06a_72.png",
            "first_name": "Gabriel",
            "real_name": "Gabriel Mocan",
            "display_name": "Gabriel Mocan",
            "team": "T4G9NBD2M",
            "name": "gabemocan",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1720461863.839309",
        "parent_user_id": "U07AK2APF2B",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "8Pr09",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Thanks for the code snippet "
                            },
                            {
                                "type": "user",
                                "user_id": "U01B8031PM1"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U01B8031PM1",
        "type": "message",
        "ts": "1720462863.426509",
        "client_msg_id": "89447ed8-8106-4a01-862f-e998bf80fc31",
        "text": "I use tenacity to help with inevitable download failures. Have LLM of choice help with filling in the rest of the code per your use case\n```from tenacity import retry, stop_after_attempt\n....\n@retry(stop=stop_after_attempt(3))\ndef download_file(self, client: APIClient, file):\n....\nclient.historic.download_file(\n        file_path=file,\n        store_directory=os.path.dirname(dest_path))```\n",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "g6e482a0e41b",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/6e482a0e41b232f48d801454006dfa56.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0016-72.png",
            "first_name": "river_shah",
            "real_name": "river_shah",
            "display_name": "river_shah",
            "team": "T4G9NBD2M",
            "name": "ansar.sa",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1720461863.839309",
        "parent_user_id": "U07AK2APF2B",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "t6YGB",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "I use tenacity to help with inevitable download failures. Have LLM of choice help with filling in the rest of the code per your use case\n"
                            }
                        ]
                    },
                    {
                        "type": "rich_text_preformatted",
                        "elements": [
                            {
                                "type": "text",
                                "text": "from tenacity import retry, stop_after_attempt\n....\n@retry(stop=stop_after_attempt(3))\ndef download_file(self, client: APIClient, file):\n....\nclient.historic.download_file(\n        file_path=file,\n        store_directory=os.path.dirname(dest_path))"
                            }
                        ],
                        "border": 0
                    },
                    {
                        "type": "rich_text_section",
                        "elements": []
                    }
                ]
            }
        ],
        "reactions": [
            {
                "name": "+1",
                "users": [
                    "U07AK2APF2B"
                ],
                "count": 1
            }
        ]
    },
    {
        "user": "U07AK2APF2B",
        "type": "message",
        "ts": "1720466601.455259",
        "client_msg_id": "03b5bf13-d003-458d-a6f7-9e97fd5395f1",
        "text": "<@U01B8031PM1> do you know if it’s possible to increase the client timeout? I’m reaching timeout when trying to fetch 1 year file list. It seems to be defaulting to 5s.",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "6864635ccc37",
            "image_72": "https:\/\/avatars.slack-edge.com\/2024-07-03\/7370732744981_6864635ccc37944dc06a_72.png",
            "first_name": "Gabriel",
            "real_name": "Gabriel Mocan",
            "display_name": "Gabriel Mocan",
            "team": "T4G9NBD2M",
            "name": "gabemocan",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1720461863.839309",
        "parent_user_id": "U07AK2APF2B",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "RojIi",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "user",
                                "user_id": "U01B8031PM1"
                            },
                            {
                                "type": "text",
                                "text": " do you know if it’s possible to increase the client timeout? I’m reaching timeout when trying to fetch 1 year file list. It seems to be defaulting to 5s."
                            }
                        ]
                    }
                ]
            }
        ]
    }
]