[
    {
        "user": "U03N4QBJ0TV",
        "type": "message",
        "ts": "1712567013.187739",
        "client_msg_id": "e104064f-a53c-4082-a53c-5994d9365c9c",
        "text": "Hey guys can anyone help me resolve the following error.  I run three flumine instances, one for data collection, one for horse racing and one for football. I don't understand how I have hit a connection limit this morning seeing as all I did was reboot the horse racing and football instances and add some new strategies to the football instance before the reboot. I thought each instance of FLumine was one connection? So I don't know how I am close to the Max connection limit of 10.\n```\n{\"asctime\": \"2024-04-08 08:57:25,093\", \"levelname\": \"ERROR\", \"message\": \"MarketStream 5008 run error\", \"exc_info\": \"Traceback (most recent call last):\\n  File \\\"\/home\/ubuntu\/.local\/lib\/python3.10\/site-packages\/flumine\/streams\/marketstream.py\\\", line 44, in run\\n    self._stream.start()\\n  File \\\"\/home\/ubuntu\/.local\/lib\/python3.10\/site-packages\/betfairlightweight\/streaming\/betfairstream.py\\\", line 67, in start\\n    self._read_loop()\\n  File \\\"\/home\/ubuntu\/.local\/lib\/python3.10\/site-packages\/betfairlightweight\/streaming\/betfairstream.py\\\", line 233, in _read_loop\\n    self._data(received_data)\\n  File \\\"\/home\/ubuntu\/.local\/lib\/python3.10\/site-packages\/betfairlightweight\/streaming\/betfairstream.py\\\", line 274, in _data\\n    raise ListenerError(self.listener.connection_id, received_data)\\nbetfairlightweight.exceptions.ListenerError: connection_id: 107-080424085725-430913, data: {\\\"op\\\":\\\"status\\\",\\\"id\\\":5009,\\\"statusCode\\\":\\\"FAILURE\\\",\\\"errorCode\\\":\\\"MAX_CONNECTION_LIMIT_EXCEEDED\\\",\\\"errorMessage\\\":\\\"You have exceeded your max connection limit which is: 10 connection(s).You currently have: 11 active connection(s).\\\",\\\"connectionClosed\\\":true,\\\"connectionId\\\":\\\"107-080424085725-430913\\\"}\"}```",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "g2c8538b47ad",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/2c8538b47ad4bed6facbb148134bb486.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0020-72.png",
            "first_name": "Trex44",
            "real_name": "Trex44",
            "display_name": "Trex44",
            "team": "T4G9NBD2M",
            "name": "c.s.mpharm",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1712567013.187739",
        "reply_count": 11,
        "reply_users_count": 4,
        "latest_reply": "1712652377.821889",
        "reply_users": [
            "UUCD6P13J",
            "U0136FHM84T",
            "U03N4QBJ0TV",
            "U02RN7YDRQ9"
        ],
        "replies": [
            {
                "user": "UUCD6P13J",
                "ts": "1712567596.291369"
            },
            {
                "user": "U0136FHM84T",
                "ts": "1712570733.257809"
            },
            {
                "user": "U03N4QBJ0TV",
                "ts": "1712573743.226339"
            },
            {
                "user": "U03N4QBJ0TV",
                "ts": "1712596938.425959"
            },
            {
                "user": "UUCD6P13J",
                "ts": "1712597667.471029"
            },
            {
                "user": "U03N4QBJ0TV",
                "ts": "1712599118.386959"
            },
            {
                "user": "U03N4QBJ0TV",
                "ts": "1712599881.424499"
            },
            {
                "user": "UUCD6P13J",
                "ts": "1712600145.351919"
            },
            {
                "user": "U03N4QBJ0TV",
                "ts": "1712600214.083329"
            },
            {
                "user": "U02RN7YDRQ9",
                "ts": "1712606169.698089"
            },
            {
                "user": "U03N4QBJ0TV",
                "ts": "1712652377.821889"
            }
        ],
        "is_locked": false,
        "subscribed": false,
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "74idr",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Hey guys can anyone help me resolve the following error.  I run three flumine instances, one for data collection, one for horse racing and one for football. I don't understand how I have hit a connection limit this morning seeing as all I did was reboot the horse racing and football instances and add some new strategies to the football instance before the reboot. I thought each instance of FLumine was one connection? So I don't know how I am close to the Max connection limit of 10.\n"
                            }
                        ]
                    },
                    {
                        "type": "rich_text_preformatted",
                        "elements": [
                            {
                                "type": "text",
                                "text": "\n{\"asctime\": \"2024-04-08 08:57:25,093\", \"levelname\": \"ERROR\", \"message\": \"MarketStream 5008 run error\", \"exc_info\": \"Traceback (most recent call last):\\n  File \\\"\/home\/ubuntu\/.local\/lib\/python3.10\/site-packages\/flumine\/streams\/marketstream.py\\\", line 44, in run\\n    self._stream.start()\\n  File \\\"\/home\/ubuntu\/.local\/lib\/python3.10\/site-packages\/betfairlightweight\/streaming\/betfairstream.py\\\", line 67, in start\\n    self._read_loop()\\n  File \\\"\/home\/ubuntu\/.local\/lib\/python3.10\/site-packages\/betfairlightweight\/streaming\/betfairstream.py\\\", line 233, in _read_loop\\n    self._data(received_data)\\n  File \\\"\/home\/ubuntu\/.local\/lib\/python3.10\/site-packages\/betfairlightweight\/streaming\/betfairstream.py\\\", line 274, in _data\\n    raise ListenerError(self.listener.connection_id, received_data)\\nbetfairlightweight.exceptions.ListenerError: connection_id: 107-080424085725-430913, data: {\\\"op\\\":\\\"status\\\",\\\"id\\\":5009,\\\"statusCode\\\":\\\"FAILURE\\\",\\\"errorCode\\\":\\\"MAX_CONNECTION_LIMIT_EXCEEDED\\\",\\\"errorMessage\\\":\\\"You have exceeded your max connection limit which is: 10 connection(s).You currently have: 11 active connection(s).\\\",\\\"connectionClosed\\\":true,\\\"connectionId\\\":\\\"107-080424085725-430913\\\"}\"}"
                            }
                        ],
                        "border": 0
                    }
                ]
            }
        ]
    },
    {
        "user": "UUCD6P13J",
        "type": "message",
        "ts": "1712567596.291369",
        "client_msg_id": "5DEF631D-F4D4-4661-B846-E388690F3735",
        "text": "Each instance is at least 2 connections depending on how you setup your filters, there can also be a bit of time for a connection to returned to the pool",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "g6898272ab81",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/6898272ab810e419c2c9ca9af1e53da8.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0012-72.png",
            "first_name": "Lee",
            "real_name": "Lee U",
            "display_name": "Lee",
            "team": "T4G9NBD2M",
            "name": "lunswor",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1712567013.187739",
        "parent_user_id": "U03N4QBJ0TV",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "xgvqs",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Each instance is at least 2 connections depending on how you setup your filters, there can also be a bit of time for a connection to returned to the pool"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U0136FHM84T",
        "type": "message",
        "ts": "1712570733.257809",
        "client_msg_id": "327F2CBA-0355-4CF6-BE94-FA41B665C8B8",
        "text": "There will also be a separate connection for each unique set of market filters",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "g3832061243d",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/3832061243d1dce8e10cc84b6962c089.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0021-72.png",
            "first_name": "",
            "real_name": "Dermot",
            "display_name": "",
            "team": "T4G9NBD2M",
            "name": "osullivan.d",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1712567013.187739",
        "parent_user_id": "U03N4QBJ0TV",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "VdFm+",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "There will also be a separate connection for each unique set of market filters"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U03N4QBJ0TV",
        "type": "message",
        "ts": "1712573743.226339",
        "client_msg_id": "4f55e790-c4be-4eb3-bf71-7c495d8b1ced",
        "text": "Ohh ok. It will be the market filters thing then. I will just run one set of market filters for all the football then. I can adapt the strats to deal with that.",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "g2c8538b47ad",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/2c8538b47ad4bed6facbb148134bb486.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0020-72.png",
            "first_name": "Trex44",
            "real_name": "Trex44",
            "display_name": "Trex44",
            "team": "T4G9NBD2M",
            "name": "c.s.mpharm",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1712567013.187739",
        "parent_user_id": "U03N4QBJ0TV",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "8wJpS",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Ohh ok. It will be the market filters thing then. I will just run one set of market filters for all the football then. I can adapt the strats to deal with that."
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U03N4QBJ0TV",
        "type": "message",
        "ts": "1712596938.425959",
        "client_msg_id": "13149462-6d15-4081-97b6-74a392d4b5c0",
        "text": "I am still going to have issues here. I collect data on 4 sports via one instance so thats 8 connections and then run strats on horses and football so that would be 12 connections total. I am not certain why it was letting me do this before today but now I am limited at 10.\n\n If I run the Football strats on the same instance, with the same filters, as the data collection is there a way to keep an instance of flumine running whilst shutting down some of the strategies running through it? I am thinking I will have to shut down the betting strats whilst keeping the data collection running.",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "g2c8538b47ad",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/2c8538b47ad4bed6facbb148134bb486.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0020-72.png",
            "first_name": "Trex44",
            "real_name": "Trex44",
            "display_name": "Trex44",
            "team": "T4G9NBD2M",
            "name": "c.s.mpharm",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1712567013.187739",
        "parent_user_id": "U03N4QBJ0TV",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "c\/2Jm",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "I am still going to have issues here. I collect data on 4 sports via one instance so thats 8 connections and then run strats on horses and football so that would be 12 connections total. I am not certain why it was letting me do this before today but now I am limited at 10.\n\n If I run the Football strats on the same instance, with the same filters, as the data collection is there a way to keep an instance of flumine running whilst shutting down some of the strategies running through it? I am thinking I will have to shut down the betting strats whilst keeping the data collection running."
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "UUCD6P13J",
        "type": "message",
        "ts": "1712597667.471029",
        "client_msg_id": "54cb39fc-545d-4a90-bd79-947c26f25f2f",
        "text": "Just to clarify. Flumine will use 1 connection for the order stream and 1 for each market filter. In the case of your instance that’s collecting data it sounds like it would be 5 connections.\nIf you are not betting on that instance you can disable to order stream on the `BetfairClient`.\nCan you combine some sports into the same filter?",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "g6898272ab81",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/6898272ab810e419c2c9ca9af1e53da8.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0012-72.png",
            "first_name": "Lee",
            "real_name": "Lee U",
            "display_name": "Lee",
            "team": "T4G9NBD2M",
            "name": "lunswor",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1712567013.187739",
        "parent_user_id": "U03N4QBJ0TV",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "UxeEY",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Just to clarify. Flumine will use 1 connection for the order stream and 1 for each market filter. In the case of your instance that’s collecting data it sounds like it would be 5 connections.\nIf you are not betting on that instance you can disable to order stream on the "
                            },
                            {
                                "type": "text",
                                "text": "BetfairClient",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": ".\nCan you combine some sports into the same filter?"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U03N4QBJ0TV",
        "type": "message",
        "ts": "1712599118.386959",
        "client_msg_id": "4e342591-0962-4f39-9f79-dc9d45ee9f7c",
        "text": "Hmm, that's really odd. I have absolutely no idea how I have reached 10 then. Have to dig about and see if I have left an old EC2 instance running by mistake or something.\n\nI could combine the filters for the market recorders perhaps. They are different filters for each sport at the moment because I wanted to record different countries for some sports and because I use the context on each class instance\/sport to direct the files to be saved in different S3 buckets.",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "g2c8538b47ad",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/2c8538b47ad4bed6facbb148134bb486.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0020-72.png",
            "first_name": "Trex44",
            "real_name": "Trex44",
            "display_name": "Trex44",
            "team": "T4G9NBD2M",
            "name": "c.s.mpharm",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1712567013.187739",
        "parent_user_id": "U03N4QBJ0TV",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "fWEIx",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Hmm, that's really odd. I have absolutely no idea how I have reached 10 then. Have to dig about and see if I have left an old EC2 instance running by mistake or something.\n\nI could combine the filters for the market recorders perhaps. They are different filters for each sport at the moment because I wanted to record different countries for some sports and because I use the context on each class instance\/sport to direct the files to be saved in different S3 buckets."
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U03N4QBJ0TV",
        "type": "message",
        "ts": "1712599881.424499",
        "client_msg_id": "6b9f2c70-5639-44d8-bdd1-68d19202df25",
        "text": "Will also look to disable the order stream on the market recorder instance. Not certain how to do this, but that should at least free up one connection.",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "g2c8538b47ad",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/2c8538b47ad4bed6facbb148134bb486.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0020-72.png",
            "first_name": "Trex44",
            "real_name": "Trex44",
            "display_name": "Trex44",
            "team": "T4G9NBD2M",
            "name": "c.s.mpharm",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1712567013.187739",
        "parent_user_id": "U03N4QBJ0TV",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "SIyUk",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Will also look to disable the order stream on the market recorder instance. Not certain how to do this, but that should at least free up one connection."
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "UUCD6P13J",
        "type": "message",
        "ts": "1712600145.351919",
        "client_msg_id": "c37a8e58-22be-4844-a39f-89845ff484db",
        "text": "```clients.BetfairClient(trading, order_stream=False)```",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "g6898272ab81",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/6898272ab810e419c2c9ca9af1e53da8.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0012-72.png",
            "first_name": "Lee",
            "real_name": "Lee U",
            "display_name": "Lee",
            "team": "T4G9NBD2M",
            "name": "lunswor",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1712567013.187739",
        "parent_user_id": "U03N4QBJ0TV",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "0LwfU",
                "elements": [
                    {
                        "type": "rich_text_preformatted",
                        "elements": [
                            {
                                "type": "text",
                                "text": "clients.BetfairClient(trading, order_stream=False)"
                            }
                        ],
                        "border": 0
                    }
                ]
            }
        ]
    },
    {
        "user": "U03N4QBJ0TV",
        "type": "message",
        "ts": "1712600214.083329",
        "client_msg_id": "c6caee48-f7d3-4cbc-9e8c-6604eaa8bfca",
        "text": "Ohh sweet, ok. Will do that then thanks.",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "g2c8538b47ad",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/2c8538b47ad4bed6facbb148134bb486.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0020-72.png",
            "first_name": "Trex44",
            "real_name": "Trex44",
            "display_name": "Trex44",
            "team": "T4G9NBD2M",
            "name": "c.s.mpharm",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1712567013.187739",
        "parent_user_id": "U03N4QBJ0TV",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "Eo2g3",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Ohh sweet, ok. Will do that then thanks."
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U02RN7YDRQ9",
        "type": "message",
        "ts": "1712606169.698089",
        "client_msg_id": "51c3ad34-779a-470e-b4a4-5408ca1bd9d0",
        "text": "Put the logs into INFO mode - you'll then see stuff like \"Starting OrderStream 1000\" in the default flumine setup.",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "ge46f1f8b708",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/e46f1f8b708a630e3191de7b2c42b1d1.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0023-72.png",
            "first_name": "edblock",
            "real_name": "edblock",
            "display_name": "foxwood",
            "team": "T4G9NBD2M",
            "name": "eanb",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1712567013.187739",
        "parent_user_id": "U03N4QBJ0TV",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "5JGeU",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Put the logs into INFO mode - you'll then see stuff like \"Starting OrderStream 1000\" in the default flumine setup."
                            }
                        ]
                    }
                ]
            }
        ]
    }
]