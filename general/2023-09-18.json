[
    {
        "user": "U9JHLMZB4",
        "type": "message",
        "ts": "1695040466.956199",
        "client_msg_id": "9726c6b1-bc94-4745-afeb-02c5902b28bd",
        "text": "The market recorder provides the changes to the market only in a raw format. To see the actual state of the market you would run this through Flumine which creates and maintains an internal record of the state of the market as it would be after each update and makes it available to your trading strategies.\n\nNo the sample for the live event doesn't save the data to a local file. But once you have the data and have decided in which data and in what format, writing it out to a file is the easy bit. One tip for doing that would be to ensure that you record the time that the data is received, so that you can match that with the market data later.\n\nIt's easier to run separate scripts to collect event and market data. especially as the market recorder is already written for you. But there will come a point at which you want to be able to collect both together in order to make trading decisions and place bets. So it's worth working out how to do that early. If you're looking at external sources of data, you'll want to look at how Flumine supports works and middleware. These can be very useful for polling external data sources and merging event data with market data (via the market.context attribute) and feeding it to your trading strategies. There's not an easy way to answer the \"how?\" part of this as it depends a lot on how your accessing event data and how you plan to use it in your trading strategies.",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "g951ddcb43e7",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/3951ddcb43e788a387d6daf330dad5ca.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0018-72.png",
            "first_name": "",
            "real_name": "Peter Coles",
            "display_name": "Peter",
            "team": "T4G9NBD2M",
            "name": "peter",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1694963577.851039",
        "parent_user_id": "U05KGFZUNAK",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "AVF",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "The market recorder provides the changes to the market only in a raw format. To see the actual state of the market you would run this through Flumine which creates and maintains an internal record of the state of the market as it would be after each update and makes it available to your trading strategies.\n\nNo the sample for the live event doesn't save the data to a local file. But once you have the data and have decided in which data and in what format, writing it out to a file is the easy bit. One tip for doing that would be to ensure that you record the time that the data is received, so that you can match that with the market data later.\n\nIt's easier to run separate scripts to collect event and market data. especially as the market recorder is already written for you. But there will come a point at which you want to be able to collect both together in order to make trading decisions and place bets. So it's worth working out how to do that early. If you're looking at external sources of data, you'll want to look at how Flumine supports works and middleware. These can be very useful for polling external data sources and merging event data with market data (via the market.context attribute) and feeding it to your trading strategies. There's not an easy way to answer the \"how?\" part of this as it depends a lot on how your accessing event data and how you plan to use it in your trading strategies."
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U9JHLMZB4",
        "type": "message",
        "ts": "1695040899.434909",
        "edited": {
            "user": "U9JHLMZB4",
            "ts": "1695041183.000000"
        },
        "client_msg_id": "d798a5a6-eb74-4584-aece-d3632a846690",
        "text": "Yes.\n\nBetfairlightweight supports the Betfair API's listCurrentOrders, which delivers all orders (with a 1000 per page limit) irrespective of how you placed them. So your website bets can be filtered based on the absence of customerStrategyRef.\n\nFlumine's `market.blotter.orders` will return all orders (including those placed on the website) for the specific market for which you're receiving an update. Note though that the orders delivered to a strategy's `process_orders` method, will be limited to orders for that specific strategy and so would not include your website orders.",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "g951ddcb43e7",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/3951ddcb43e788a387d6daf330dad5ca.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0018-72.png",
            "first_name": "",
            "real_name": "Peter Coles",
            "display_name": "Peter",
            "team": "T4G9NBD2M",
            "name": "peter",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1695005008.194789",
        "parent_user_id": "U0322P0CK0E",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "CzoI",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Yes.\n\nBetfairlightweight supports the Betfair API's listCurrentOrders, which delivers all orders (with a 1000 per page limit) irrespective of how you placed them. So your website bets can be filtered based on the absence of customerStrategyRef.\n\nFlumine's "
                            },
                            {
                                "type": "text",
                                "text": "market.blotter.orders",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " will return all orders (including those placed on the website) for the specific market for which you're receiving an update. Note though that the orders delivered to a strategy's "
                            },
                            {
                                "type": "text",
                                "text": "process_orders",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " method, will be limited to orders for that specific strategy and so would not include your website orders."
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U0322P0CK0E",
        "type": "message",
        "ts": "1695104796.656789",
        "client_msg_id": "3509daaf-b9ad-4619-8693-0e58db37543d",
        "text": "Perfect thank you",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "ab1918814707",
            "image_72": "https:\/\/avatars.slack-edge.com\/2022-07-31\/3867647231206_ab191881470773932048_72.jpg",
            "first_name": "Vincent",
            "real_name": "Vincent Lim",
            "display_name": "Guy Incognito",
            "team": "T4G9NBD2M",
            "name": "nelsonmathsspecialist",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1695005008.194789",
        "parent_user_id": "U0322P0CK0E",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "NS2",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Perfect thank you"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U0322P0CK0E",
        "type": "message",
        "ts": "1695104858.813929",
        "client_msg_id": "e6059511-6829-4825-a886-ecd132826fa7",
        "text": "Is there some way I can view the total traded volume of a market that has settled. I tried with betfairlightweight and I always get total volume equal to zero when asking for the market book",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "ab1918814707",
            "image_72": "https:\/\/avatars.slack-edge.com\/2022-07-31\/3867647231206_ab191881470773932048_72.jpg",
            "first_name": "Vincent",
            "real_name": "Vincent Lim",
            "display_name": "Guy Incognito",
            "team": "T4G9NBD2M",
            "name": "nelsonmathsspecialist",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1695104858.813929",
        "reply_count": 2,
        "reply_users_count": 2,
        "latest_reply": "1695117784.766039",
        "reply_users": [
            "UBS7QANF3",
            "U02RN7YDRQ9"
        ],
        "replies": [
            {
                "user": "UBS7QANF3",
                "ts": "1695105308.808429"
            },
            {
                "user": "U02RN7YDRQ9",
                "ts": "1695117784.766039"
            }
        ],
        "is_locked": false,
        "subscribed": false,
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "v17",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Is there some way I can view the total traded volume of a market that has settled. I tried with betfairlightweight and I always get total volume equal to zero when asking for the market book"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "UBS7QANF3",
        "type": "message",
        "ts": "1695105308.808429",
        "client_msg_id": "d74f366e-2ec6-4fb3-8d58-57cde1922937",
        "text": "<https:\/\/github.com\/mberk\/betfairutil\/blob\/18dcd187b5cab8fa4be25694fb64e8045bf3214e\/betfairutil\/__init__.py#L2178>\n\n&gt;  Working out the total volume traded on a market is surprisingly tricky given Betfair's shenanigans around the market\n&gt;     closure. Specifically, the last few updates in the price stream result in data getting zeroed out which means if you\n&gt;     were to just look at the last available market book it would look like the total volume traded was zero. In fact, it\n&gt;     appears there is no consistency as to how many price stream updates are involved in this zeroing of data and so it's\n&gt;     not as simple as having a rule such as \"look at the second to last market book available\".\n&gt; \n&gt;     If memory usage is not an issue then the most robust method would be to read the entire set of market books into\n&gt;     memory then iterate them in reverse order looking for the first market book that has a non-zero total volume traded.\n&gt;     However, in many use cases memory usage is a significant concern. For example, if you want to process tens of\n&gt;     thousands of markets and use parallel processing to speed this up then you end up needing to hold the entire set of\n&gt;     market books for multiple markets in memory simultaneously and, depending on the number of cores your machine has\n&gt;     and the number of parallel processes you use, it is easy to exhaust the total memory available.\n&gt; \n&gt;     The solution presented here is to use a deque\n&gt;     (<https:\/\/docs.python.org\/3\/library\/collections.html#collections.deque>). Think of this as a limited length list\n&gt;     where when a new item is appended to the list, another item is removed for the start of the list. This is used when\n&gt;     reading the prices file to leave us with the X last market books which can then be iterated in reverse order to find\n&gt;     the last one which has a non-zero volume traded. Based on my own analysis of prices files I have settled on a\n&gt;     default maximum length of the deque of 8 - i.e. at most this function will store 8 market books in memory at any one\n&gt;     time. This is a trade-off between giving correct results and drastically cutting down on memory usage versus reading\n&gt;     the entire set of market books into memory. If memory usage is not of concern to you then you can simply set the\n&gt;     deque_len argument to None and the function will read the entire set of market books into memory ensuring\n&gt;     correctness. If you observe any prices files where a deque of length 8 doesn't give correct results then please\n&gt;     create a GitHub issue here: <https:\/\/github.com\/mberk\/betfairutil\/issues> so I can investigate.",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "gaaf844a4a90",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/eaaf844a4a905431d83430e563b077aa.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0011-72.png",
            "first_name": "",
            "real_name": "Maurice Berk",
            "display_name": "Mo",
            "team": "T4G9NBD2M",
            "name": "maurice",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1695104858.813929",
        "parent_user_id": "U0322P0CK0E",
        "attachments": [
            {
                "id": 2,
                "footer_icon": "https:\/\/slack.github.com\/static\/img\/favicon-neutral.png",
                "color": "24292f",
                "bot_id": "B021ZJYSBMW",
                "app_unfurl_url": "https:\/\/github.com\/mberk\/betfairutil\/blob\/18dcd187b5cab8fa4be25694fb64e8045bf3214e\/betfairutil\/__init__.py#L2178",
                "is_app_unfurl": true,
                "app_id": "A01BP7R4KNY",
                "fallback": "<https:\/\/github.com\/mberk\/betfairutil\/blob\/18dcd187b5cab8fa4be25694fb64e8045bf3214e\/betfairutil\/__init__.py | __init__.py>",
                "title": "<https:\/\/github.com\/mberk\/betfairutil\/blob\/18dcd187b5cab8fa4be25694fb64e8045bf3214e\/betfairutil\/__init__.py | __init__.py>",
                "footer": "<https:\/\/github.com\/mberk\/betfairutil|mberk\/betfairutil>",
                "mrkdwn_in": [
                    "text"
                ]
            }
        ],
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "CJy",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "link",
                                "url": "https:\/\/github.com\/mberk\/betfairutil\/blob\/18dcd187b5cab8fa4be25694fb64e8045bf3214e\/betfairutil\/__init__.py#L2178"
                            },
                            {
                                "type": "text",
                                "text": "\n\n"
                            }
                        ]
                    },
                    {
                        "type": "rich_text_quote",
                        "elements": [
                            {
                                "type": "text",
                                "text": " Working out the total volume traded on a market is surprisingly tricky given Betfair's shenanigans around the market\n    closure. Specifically, the last few updates in the price stream result in data getting zeroed out which means if you\n    were to just look at the last available market book it would look like the total volume traded was zero. In fact, it\n    appears there is no consistency as to how many price stream updates are involved in this zeroing of data and so it's\n    not as simple as having a rule such as \"look at the second to last market book available\".\n\n    If memory usage is not an issue then the most robust method would be to read the entire set of market books into\n    memory then iterate them in reverse order looking for the first market book that has a non-zero total volume traded.\n    However, in many use cases memory usage is a significant concern. For example, if you want to process tens of\n    thousands of markets and use parallel processing to speed this up then you end up needing to hold the entire set of\n    market books for multiple markets in memory simultaneously and, depending on the number of cores your machine has\n    and the number of parallel processes you use, it is easy to exhaust the total memory available.\n\n    The solution presented here is to use a deque\n    ("
                            },
                            {
                                "type": "link",
                                "url": "https:\/\/docs.python.org\/3\/library\/collections.html#collections.deque"
                            },
                            {
                                "type": "text",
                                "text": "). Think of this as a limited length list\n    where when a new item is appended to the list, another item is removed for the start of the list. This is used when\n    reading the prices file to leave us with the X last market books which can then be iterated in reverse order to find\n    the last one which has a non-zero volume traded. Based on my own analysis of prices files I have settled on a\n    default maximum length of the deque of 8 - i.e. at most this function will store 8 market books in memory at any one\n    time. This is a trade-off between giving correct results and drastically cutting down on memory usage versus reading\n    the entire set of market books into memory. If memory usage is not of concern to you then you can simply set the\n    deque_len argument to None and the function will read the entire set of market books into memory ensuring\n    correctness. If you observe any prices files where a deque of length 8 doesn't give correct results then please\n    create a GitHub issue here: "
                            },
                            {
                                "type": "link",
                                "url": "https:\/\/github.com\/mberk\/betfairutil\/issues"
                            },
                            {
                                "type": "text",
                                "text": " so I can investigate."
                            }
                        ]
                    }
                ]
            }
        ]
    }
]