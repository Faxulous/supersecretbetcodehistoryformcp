[
    {
        "text": "OK. Attached are two examples. Example1 is a working script doing what I think you may have been trying to do and creates a list of market IDs from the racecards and feeds that to Flumine. Example2 is how I would personally do it, which embeds the filter condition into the Flumine strategy's check_market_book method.\n\nThey both use the same fairly random filter criteria looking for Flat races under a mile - you can insert your own condition.\n\nPoints to note are:\n• You may need to tweak how the Betfair credentials are passed to the trading object to reflect how you authenticate\n• In example two there's no need for an explicit login or call to list_market_catalogues as Flumine takes care of those.\n• The market filters have different parameters (because Betfair is inconsistent).\n• Where you find the information for your conditions may be a bit different too (ditto).\n• The market catalogue may not appear in example2 until several seconds after the market is added to the stream.\n• I've turned the order stream off in both example, but you will probably want it on (by removing the parameter when the client is initiated).",
        "files": [
            {
                "id": "F04L95F7H5G",
                "created": 1674560520,
                "timestamp": 1674560520,
                "name": "example1.py",
                "title": "example1.py",
                "mimetype": "text\/plain",
                "filetype": "python",
                "pretty_type": "Python",
                "user": "U9JHLMZB4",
                "user_team": "T4G9NBD2M",
                "editable": true,
                "size": 2171,
                "mode": "snippet",
                "is_external": false,
                "external_type": "",
                "is_public": true,
                "public_url_shared": false,
                "display_as_bot": false,
                "username": "",
                "url_private": "https:\/\/files.slack.com\/files-pri\/T4G9NBD2M-F04L95F7H5G\/example1.py?t=xoxe-152328387089-8357743338709-8373272928225-dfe8ebcd8ca3d2f633bcafeb95191840",
                "url_private_download": "https:\/\/files.slack.com\/files-pri\/T4G9NBD2M-F04L95F7H5G\/download\/example1.py?t=xoxe-152328387089-8357743338709-8373272928225-dfe8ebcd8ca3d2f633bcafeb95191840",
                "permalink": "https:\/\/betcode-org.slack.com\/files\/U9JHLMZB4\/F04L95F7H5G\/example1.py",
                "permalink_public": "https:\/\/slack-files.com\/T4G9NBD2M-F04L95F7H5G-a648df8f92",
                "edit_link": "https:\/\/betcode-org.slack.com\/files\/U9JHLMZB4\/F04L95F7H5G\/example1.py\/edit",
                "is_starred": false,
                "has_rich_preview": false,
                "file_access": "visible"
            },
            {
                "id": "F04L2HB7KAS",
                "created": 1674560540,
                "timestamp": 1674560540,
                "name": "example2.py",
                "title": "example2.py",
                "mimetype": "text\/plain",
                "filetype": "python",
                "pretty_type": "Python",
                "user": "U9JHLMZB4",
                "user_team": "T4G9NBD2M",
                "editable": true,
                "size": 2013,
                "mode": "snippet",
                "is_external": false,
                "external_type": "",
                "is_public": true,
                "public_url_shared": false,
                "display_as_bot": false,
                "username": "",
                "url_private": "https:\/\/files.slack.com\/files-pri\/T4G9NBD2M-F04L2HB7KAS\/example2.py?t=xoxe-152328387089-8357743338709-8373272928225-dfe8ebcd8ca3d2f633bcafeb95191840",
                "url_private_download": "https:\/\/files.slack.com\/files-pri\/T4G9NBD2M-F04L2HB7KAS\/download\/example2.py?t=xoxe-152328387089-8357743338709-8373272928225-dfe8ebcd8ca3d2f633bcafeb95191840",
                "permalink": "https:\/\/betcode-org.slack.com\/files\/U9JHLMZB4\/F04L2HB7KAS\/example2.py",
                "permalink_public": "https:\/\/slack-files.com\/T4G9NBD2M-F04L2HB7KAS-0dc2695a5f",
                "edit_link": "https:\/\/betcode-org.slack.com\/files\/U9JHLMZB4\/F04L2HB7KAS\/example2.py\/edit",
                "is_starred": false,
                "has_rich_preview": false,
                "file_access": "visible"
            }
        ],
        "upload": false,
        "user": "U9JHLMZB4",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "=V5is",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "OK. Attached are two examples. Example1 is a working script doing what I think you may have been trying to do and creates a list of market IDs from the racecards and feeds that to Flumine. Example2 is how I would personally do it, which embeds the filter condition into the Flumine strategy's check_market_book method.\n\nThey both use the same fairly random filter criteria looking for Flat races under a mile - you can insert your own condition.\n\nPoints to note are:\n"
                            }
                        ]
                    },
                    {
                        "type": "rich_text_list",
                        "elements": [
                            {
                                "type": "rich_text_section",
                                "elements": [
                                    {
                                        "type": "text",
                                        "text": "You may need to tweak how the Betfair credentials are passed to the trading object to reflect how you authenticate"
                                    }
                                ]
                            },
                            {
                                "type": "rich_text_section",
                                "elements": [
                                    {
                                        "type": "text",
                                        "text": "In example two there's no need for an explicit login or call to list_market_catalogues as Flumine takes care of those."
                                    }
                                ]
                            },
                            {
                                "type": "rich_text_section",
                                "elements": [
                                    {
                                        "type": "text",
                                        "text": "The market filters have different parameters (because Betfair is inconsistent)."
                                    }
                                ]
                            },
                            {
                                "type": "rich_text_section",
                                "elements": [
                                    {
                                        "type": "text",
                                        "text": "Where you find the information for your conditions may be a bit different too (ditto)."
                                    }
                                ]
                            },
                            {
                                "type": "rich_text_section",
                                "elements": [
                                    {
                                        "type": "text",
                                        "text": "The market catalogue may not appear in example2 until several seconds after the market is added to the stream."
                                    }
                                ]
                            },
                            {
                                "type": "rich_text_section",
                                "elements": [
                                    {
                                        "type": "text",
                                        "text": "I've turned the order stream off in both example, but you will probably want it on (by removing the parameter when the client is initiated)."
                                    }
                                ]
                            }
                        ],
                        "style": "bullet",
                        "indent": 0,
                        "border": 0
                    }
                ]
            }
        ],
        "type": "message",
        "ts": "1674560695.754059",
        "edited": {
            "user": "U9JHLMZB4",
            "ts": "1674562372.000000"
        },
        "client_msg_id": "ff5d761b-b5cd-473e-b6b8-6efe0d41d7e8",
        "thread_ts": "1674425131.348539",
        "parent_user_id": "U03N4QBJ0TV",
        "reactions": [
            {
                "name": "raised_hands",
                "users": [
                    "U03N4QBJ0TV"
                ],
                "count": 1
            }
        ]
    },
    {
        "user": "U025AFDS89H",
        "type": "message",
        "ts": "1674591636.550709",
        "client_msg_id": "01B74716-B1B6-40AD-A733-51F8F56157DB",
        "text": "Thanks Andrew",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "g7aa6fcd81d9",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/7aa6fcd81d9a81ea32dba8c2cbb235d5.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0000-72.png",
            "first_name": "James",
            "real_name": "James",
            "display_name": "",
            "team": "T4G9NBD2M",
            "name": "james.armstrong35",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1674541077.521369",
        "parent_user_id": "U025AFDS89H",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "SebdX",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Thanks Andrew"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U03CL4F39M4",
        "type": "message",
        "ts": "1674600099.435099",
        "edited": {
            "user": "U03CL4F39M4",
            "ts": "1674600403.000000"
        },
        "client_msg_id": "fc72a9fc-adc7-4b4d-920b-968864bbabf1",
        "text": "Hi all,\nApologies in advance for the basic questions: I was looking to confirm if the .total_matched attributes applied to the marketbook.runner and marketbook objects represent the cumulative sum of all back stakes taken on the runner and market respectively until that timepoint? Or does it cumulative sum of the lay liability and back stake taken, or something else all together?\nFurthermore, is the currency domiciled in pounds? Or does it depend on the country_code associated with the particular market?\n\nCheers for any help you may provide!",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "914e66aa98f5",
            "image_72": "https:\/\/avatars.slack-edge.com\/2022-04-25\/3458558719456_914e66aa98f5dcdbe576_72.png",
            "first_name": "Nicholas",
            "real_name": "Nicholas vizard",
            "display_name": "Nicholas vizard",
            "team": "T4G9NBD2M",
            "name": "nsavizard",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "osC",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Hi all,\nApologies in advance for the basic questions: I was looking to confirm if the .total_matched attributes applied to the marketbook.runner and marketbook objects represent the cumulative sum of all back stakes taken on the runner and market respectively until that timepoint? Or does it cumulative sum of the lay liability and back stake taken, or something else all together?\nFurthermore, is the currency domiciled in pounds? Or does it depend on the country_code associated with the particular market?\n\nCheers for any help you may provide!"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U0476CG183A",
        "type": "message",
        "ts": "1674608644.387089",
        "client_msg_id": "E12638B8-ABA6-42DC-AAEB-A1C79FD50E07",
        "text": "I may be wrong but I’m fairly certain that it’s a cumulative sum of back stakes matched and that the currency is GBP, even for non-UK markets. ",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "g9cca9b61659",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/9cca9b616592f1b8e24755f8591d2049.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0019-72.png",
            "first_name": "GrimReaper",
            "real_name": "GrimReaper",
            "display_name": "Herugrim",
            "team": "T4G9NBD2M",
            "name": "mitchell.motyka",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1674608644.387089",
        "reply_count": 3,
        "reply_users_count": 2,
        "latest_reply": "1674717964.543809",
        "reply_users": [
            "U012XF5CNPN",
            "U4H19D1D2"
        ],
        "replies": [
            {
                "user": "U012XF5CNPN",
                "ts": "1674686598.572989"
            },
            {
                "user": "U012XF5CNPN",
                "ts": "1674686761.449559"
            },
            {
                "user": "U4H19D1D2",
                "ts": "1674717964.543809"
            }
        ],
        "is_locked": false,
        "subscribed": true,
        "last_read": "1674717964.543809",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "S9o",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "I may be wrong but "
                            },
                            {
                                "type": "text",
                                "text": "I’m"
                            },
                            {
                                "type": "text",
                                "text": " fairly certain "
                            },
                            {
                                "type": "text",
                                "text": "that"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "it’s"
                            },
                            {
                                "type": "text",
                                "text": " a cumulative sum of back stakes matched and that the currency is GBP, even for non-UK markets. "
                            }
                        ]
                    }
                ]
            }
        ]
    }
]