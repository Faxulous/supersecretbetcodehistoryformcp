[
    {
        "text": "Hi Everyone, i was invited by paulliam. My name is Jeffrey and I want to backtest some betting strategies on betfair historic data, and while doing so i stumbled accross the betfairleightweight code. Using the Betfair historic Data Processor, I do get a nice and tidy dataset. However this is a manual excersise and since I will have to do this for 10k+ matches it is not feasible to do it manually. I did some research and it seems to me i need 2 steps in which i am stuck:\n\n1. get the json file into a nice and tidy format (csv), using `json.normalize` it does not achieve the desired result i get this (first image) while im looking for (second image, used by json converter) :\n2. Still this is not a nice data set, when i go to <https:\/\/www.betfairhistoricdata.co.uk\/>  I can put in my bz2 file and get a nice output (but this is all manual). \nI was wondering if it was possible to automate this process for a batch of bz2\/tar files, so that I can rapidly process &gt;1k matches (files). I cannot find it in the python code of the the betfairleightweight package though. Can somebody help me out please, or point me to the code which does the conversion from json to the nice tidy dataset i get from the betfair processor.\n\nMuch appreciated, cheers Jeff",
        "files": [
            {
                "id": "F045ASCK4RY",
                "mode": "hidden_by_limit"
            },
            {
                "id": "F045DAKG6KE",
                "mode": "hidden_by_limit"
            },
            {
                "id": "F044WAKC5HD",
                "mode": "hidden_by_limit"
            }
        ],
        "upload": false,
        "user": "U045PDZBWAD",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "rf7",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Hi Everyone, i was invited by paulliam. My name is Jeffrey and I want to backtest some betting strategies on betfair historic data, and while doing so i stumbled accross the betfairleightweight code. Using the Betfair historic Data Processor, I do get a nice and tidy dataset. However this is a manual excersise and since I will have to do this for 10k+ matches it is not feasible to do it manually. I did some research and it seems to me i need 2 steps in which i am stuck:\n\n"
                            }
                        ]
                    },
                    {
                        "type": "rich_text_list",
                        "elements": [
                            {
                                "type": "rich_text_section",
                                "elements": [
                                    {
                                        "type": "text",
                                        "text": "get the json file into a nice and tidy format (csv), using "
                                    },
                                    {
                                        "type": "text",
                                        "text": "json.normalize",
                                        "style": {
                                            "code": true
                                        }
                                    },
                                    {
                                        "type": "text",
                                        "text": " it does not achieve the desired result i get this (first image) while im looking for (second image, used by json converter) :"
                                    }
                                ]
                            },
                            {
                                "type": "rich_text_section",
                                "elements": [
                                    {
                                        "type": "text",
                                        "text": "Still this is not a nice data set, when i go to "
                                    },
                                    {
                                        "type": "link",
                                        "url": "https:\/\/www.betfairhistoricdata.co.uk\/"
                                    },
                                    {
                                        "type": "text",
                                        "text": "  I can put in my bz2 file and get a nice output (but this is all manual). "
                                    }
                                ]
                            }
                        ],
                        "style": "ordered",
                        "indent": 0,
                        "border": 0
                    },
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "\nI was wondering if it was possible to automate this process for a batch of bz2\/tar files, so that I can rapidly process >1k matches (files). I cannot find it in the python code of the the betfairleightweight package though. Can somebody help me out please, or point me to the code which does the conversion from json to the nice tidy dataset i get from the betfair processor.\n\nMuch appreciated, cheers Jeff"
                            }
                        ]
                    }
                ]
            }
        ],
        "type": "message",
        "ts": "1665004844.149549",
        "client_msg_id": "08def08c-a0d6-4684-b77d-92558e0a1858",
        "thread_ts": "1665004844.149549",
        "reply_count": 31,
        "reply_users_count": 3,
        "latest_reply": "1665491628.561309",
        "reply_users": [
            "U02KD79SJRZ",
            "U045PDZBWAD",
            "UBS7QANF3"
        ],
        "replies": [
            {
                "user": "U02KD79SJRZ",
                "ts": "1665006417.454679"
            },
            {
                "user": "U045PDZBWAD",
                "ts": "1665006530.125529"
            },
            {
                "user": "U045PDZBWAD",
                "ts": "1665006621.454499"
            },
            {
                "user": "UBS7QANF3",
                "ts": "1665033369.349219"
            },
            {
                "user": "U045PDZBWAD",
                "ts": "1665067742.945079"
            },
            {
                "user": "UBS7QANF3",
                "ts": "1665068042.869469"
            },
            {
                "user": "U045PDZBWAD",
                "ts": "1665068396.701319"
            },
            {
                "user": "UBS7QANF3",
                "ts": "1665068538.215869"
            },
            {
                "user": "UBS7QANF3",
                "ts": "1665068552.993289"
            },
            {
                "user": "U045PDZBWAD",
                "ts": "1665068709.484899"
            },
            {
                "user": "U045PDZBWAD",
                "ts": "1665068755.298759"
            },
            {
                "user": "U045PDZBWAD",
                "ts": "1665068806.487649"
            },
            {
                "user": "UBS7QANF3",
                "ts": "1665068827.344059"
            },
            {
                "user": "U045PDZBWAD",
                "ts": "1665068975.256209"
            },
            {
                "user": "U045PDZBWAD",
                "ts": "1665068990.799759"
            },
            {
                "user": "UBS7QANF3",
                "ts": "1665069036.947709"
            },
            {
                "user": "U045PDZBWAD",
                "ts": "1665069176.923219"
            },
            {
                "user": "UBS7QANF3",
                "ts": "1665069273.149529"
            },
            {
                "user": "U045PDZBWAD",
                "ts": "1665069479.451579"
            },
            {
                "user": "UBS7QANF3",
                "ts": "1665069581.703859"
            },
            {
                "user": "U045PDZBWAD",
                "ts": "1665069690.640139"
            },
            {
                "user": "UBS7QANF3",
                "ts": "1665069915.954019"
            },
            {
                "user": "U045PDZBWAD",
                "ts": "1665069955.084649"
            },
            {
                "user": "U045PDZBWAD",
                "ts": "1665091052.812689"
            },
            {
                "user": "U045PDZBWAD",
                "ts": "1665091131.688709"
            },
            {
                "user": "UBS7QANF3",
                "ts": "1665127971.890659"
            },
            {
                "user": "U045PDZBWAD",
                "ts": "1665149434.906919"
            },
            {
                "user": "UBS7QANF3",
                "ts": "1665157164.130459"
            },
            {
                "user": "U045PDZBWAD",
                "ts": "1665183196.029419"
            },
            {
                "user": "UBS7QANF3",
                "ts": "1665468863.827309"
            },
            {
                "user": "U045PDZBWAD",
                "ts": "1665491628.561309"
            }
        ],
        "is_locked": false,
        "subscribed": false
    },
    {
        "user": "U045PDZBWAD",
        "type": "message",
        "ts": "1665004939.031929",
        "client_msg_id": "e04a220f-e1df-4c69-9148-dbaebb825b9a",
        "text": "If you need any clarification please feel free to ask, I am happy to explain my problem.",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "5bcd6261fd73",
            "image_72": "https:\/\/avatars.slack-edge.com\/2022-10-05\/4193484472817_5bcd6261fd73d7714939_72.jpg",
            "first_name": "Jeffrey",
            "real_name": "Jeffrey Been",
            "display_name": "Jeffrey Been",
            "team": "T4G9NBD2M",
            "name": "jeffreybeen90",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "ikQ",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "If you need any clarification please feel free to ask, I am happy to explain my problem."
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U045PDZBWAD",
        "type": "message",
        "ts": "1665005028.256039",
        "client_msg_id": "001f803f-9d1c-4413-9cea-26e40c4ed2ed",
        "text": "This is the end result i am looking for:",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "5bcd6261fd73",
            "image_72": "https:\/\/avatars.slack-edge.com\/2022-10-05\/4193484472817_5bcd6261fd73d7714939_72.jpg",
            "first_name": "Jeffrey",
            "real_name": "Jeffrey Been",
            "display_name": "Jeffrey Been",
            "team": "T4G9NBD2M",
            "name": "jeffreybeen90",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "u+vrw",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "This is the end result i am looking for:"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "text": "",
        "files": [
            {
                "id": "F044WBJC7FH",
                "mode": "hidden_by_limit"
            }
        ],
        "upload": false,
        "user": "U045PDZBWAD",
        "display_as_bot": false,
        "type": "message",
        "ts": "1665005096.276679",
        "client_msg_id": "1113f5d5-c297-4155-904a-696f8a00d5c7"
    },
    {
        "user": "U02KD79SJRZ",
        "type": "message",
        "ts": "1665006417.454679",
        "client_msg_id": "F0247D80-744A-4A92-9025-1650C43957FF",
        "text": "As far as betfair historical data is concerned I wouldn’t go back more than a couple of years.  If you’re strategies are looking at the amount of money being matched then old data behaves differently.",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "g60d0b1467f5",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/60d0b1467f5a4281ad1e18edcda3c1f7.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0003-72.png",
            "first_name": "Mr",
            "real_name": "Mr West",
            "display_name": "",
            "team": "T4G9NBD2M",
            "name": "emmawest3317",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1665004844.149549",
        "parent_user_id": "U045PDZBWAD",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "sbXfe",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "As far as betfair historical data is concerned I "
                            },
                            {
                                "type": "text",
                                "text": "wouldn’t"
                            },
                            {
                                "type": "text",
                                "text": " go back more than a couple of years.  If "
                            },
                            {
                                "type": "text",
                                "text": "you’re"
                            },
                            {
                                "type": "text",
                                "text": " strategies are looking at the amount of money being matched then old data behaves differently."
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U045PDZBWAD",
        "type": "message",
        "ts": "1665006530.125529",
        "client_msg_id": "22830bac-fe7d-4001-af0b-13cd0022d6b6",
        "text": "Still say i only backtest previos 3 yrs so 2019-2022, its still a lot of files. I wanna test it on many competions, so say 3k matches.",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "5bcd6261fd73",
            "image_72": "https:\/\/avatars.slack-edge.com\/2022-10-05\/4193484472817_5bcd6261fd73d7714939_72.jpg",
            "first_name": "Jeffrey",
            "real_name": "Jeffrey Been",
            "display_name": "Jeffrey Been",
            "team": "T4G9NBD2M",
            "name": "jeffreybeen90",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1665004844.149549",
        "parent_user_id": "U045PDZBWAD",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "3YP",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Still say i only backtest previos 3 yrs so 2019-2022, its still a lot of files. I wanna test it on many competions, so say 3k matches."
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U045PDZBWAD",
        "type": "message",
        "ts": "1665006621.454499",
        "client_msg_id": "f406d4a9-7a2b-48fd-a90c-6d3dc52f3591",
        "text": "Ideally i would like to write a query like this: select &lt;winner&gt;, from &lt;match&gt; in &lt;competition&gt; Where Match odds x BETWEEN y something like that",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "5bcd6261fd73",
            "image_72": "https:\/\/avatars.slack-edge.com\/2022-10-05\/4193484472817_5bcd6261fd73d7714939_72.jpg",
            "first_name": "Jeffrey",
            "real_name": "Jeffrey Been",
            "display_name": "Jeffrey Been",
            "team": "T4G9NBD2M",
            "name": "jeffreybeen90",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1665004844.149549",
        "parent_user_id": "U045PDZBWAD",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "3mE",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Ideally i would like to write a query like this: select <winner>, from <match> in <competition> Where Match odds x BETWEEN y something like that"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "UBS7QANF3",
        "type": "message",
        "ts": "1665033369.349219",
        "edited": {
            "user": "UBS7QANF3",
            "ts": "1665033769.000000"
        },
        "client_msg_id": "92736C4C-8A2E-4900-A90F-C9CF3C39693B",
        "text": "The prices_file_to_csv_file in the betfairutil package does exactly what you want",
        "team": "T4G9NBD2M",
        "user_team": "T4G9NBD2M",
        "source_team": "T4G9NBD2M",
        "user_profile": {
            "avatar_hash": "gaaf844a4a90",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/eaaf844a4a905431d83430e563b077aa.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0011-72.png",
            "first_name": "",
            "real_name": "Maurice Berk",
            "display_name": "Mo",
            "team": "T4G9NBD2M",
            "name": "maurice",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1665004844.149549",
        "parent_user_id": "U045PDZBWAD",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "jRi6V",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "The prices_file_to_csv_file in the betfairutil package does exactly what you want"
                            }
                        ]
                    }
                ]
            }
        ],
        "reactions": [
            {
                "name": "+1",
                "users": [
                    "U045PDZBWAD"
                ],
                "count": 1
            }
        ]
    }
]